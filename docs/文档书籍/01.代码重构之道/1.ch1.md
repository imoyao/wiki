---
title: ç¬¬ 1 ç«  é‡æ„ï¼Œç¬¬ä¸€ä¸ªç¤ºä¾‹
date: 2021-01-20 21:02:49
permalink: /pages/48660e/
categories:
  - ğŸ“–å¥½ä¹¦
  - ä»£ç é‡æ„ä¹‹é“
tags:
  - ä»£ç é‡æ„
  - é‡æ„
---
# ç¬¬ 1 ç«  é‡æ„ï¼Œç¬¬ä¸€ä¸ªç¤ºä¾‹

æˆ‘è¯¥ä»ä½•è¯´èµ·å‘¢ï¼ŸæŒ‰ç…§ä¼ ç»Ÿåšæ³•ï¼Œä¸€å¼€å§‹ä»‹ç»æŸæ ·ä¸œè¥¿æ—¶åº”è¯¥å…ˆå¤§è‡´è®²è®²å®ƒçš„å†å²ã€ä¸»è¦åŸç†ç­‰ã€‚å¯æ˜¯æ¯å½“æœ‰äººåœ¨ä¼šåœºä¸Šä»‹ç»è¿™äº›ä¸œè¥¿ï¼Œæ€»æ˜¯è¯±å‘æˆ‘çš„çŒç¡è™«ã€‚æˆ‘çš„æ€ç»ªå¼€å§‹æ¸¸è¡ï¼Œæˆ‘çš„çœ¼ç¥å¼€å§‹è¿·ç¦»ï¼Œç›´åˆ°ä¸»è®²äººç§€å‡ºç¤ºä¾‹ï¼Œæˆ‘æ‰èƒ½å¤Ÿæèµ·ç²¾ç¥ã€‚

ç¤ºä¾‹ä¹‹æ‰€ä»¥å¯ä»¥æ‹¯æ•‘æˆ‘äºå¤ªè™šä¹‹ä¸­ï¼Œå› ä¸ºå®ƒè®©æˆ‘çœ‹è§äº‹æƒ…åœ¨çœŸæ­£è¿›è¡Œã€‚è°ˆåŸç†ï¼Œå¾ˆå®¹æ˜“æµäºæ³›æ³›ï¼Œåˆå¾ˆéš¾è¯´æ˜å¦‚ä½•å®é™…åº”ç”¨ã€‚ç»™å‡ºä¸€ä¸ªç¤ºä¾‹ï¼Œå°±å¯ä»¥å¸®åŠ©æˆ‘æŠŠäº‹æƒ…è®¤è¯†æ¸…æ¥šã€‚

å› æ­¤ï¼Œæˆ‘å†³å®šä»ä¸€ä¸ªç¤ºä¾‹è¯´èµ·ã€‚åœ¨æ­¤è¿‡ç¨‹ä¸­æˆ‘ä¼šè°ˆåˆ°å¾ˆå¤šé‡æ„çš„å·¥ä½œæ–¹å¼ï¼Œå¹¶ä¸”è®©ä½ å¯¹é‡æ„è¿‡ç¨‹æœ‰ä¸€ç‚¹ç‚¹æ„Ÿè§‰ã€‚ç„¶ååœ¨ä¸‹ä¸€ç« ä¸­æˆ‘æ‰èƒ½å‘ä½ å±•å¼€é€šå¸¸çš„åŸç†ä»‹ç»ã€‚

ä½†æ˜¯ï¼Œé¢å¯¹è¿™ä¸ªä»‹ç»æ€§ç¤ºä¾‹ï¼Œæˆ‘é‡åˆ°äº†ä¸€ä¸ªå¤§é—®é¢˜ã€‚å¦‚æœæˆ‘é€‰æ‹©ä¸€ä¸ªå¤§å‹ç¨‹åºï¼Œé‚£ä¹ˆå¯¹ç¨‹åºè‡ªèº«çš„æè¿°å’Œå¯¹æ•´ä¸ªé‡æ„è¿‡ç¨‹çš„æè¿°å°±å¤ªå¤æ‚äº†ï¼Œä»»ä½•è¯»è€…éƒ½ä¸å¿å’è¯»ï¼ˆæˆ‘è¯•äº†ä¸€ä¸‹ï¼Œå“ªæ€•ç¨å¾®å¤æ‚ä¸€ç‚¹çš„ä¾‹å­éƒ½ä¼šè¶…è¿‡ 100 é¡µï¼‰ã€‚å¦‚æœæˆ‘é€‰æ‹©ä¸€ä¸ªå®¹æ˜“ç†è§£çš„å°ç¨‹åºï¼Œåˆææ€•çœ‹ä¸å‡ºé‡æ„çš„ä»·å€¼ã€‚

å’Œä»»ä½•ç«‹å¿—è¦ä»‹ç»â€œåº”ç”¨äºçœŸå®ä¸–ç•Œçš„ç¨‹åºä¸­çš„æœ‰ç”¨æŠ€æœ¯â€çš„äººä¸€æ ·ï¼Œæˆ‘é™·å…¥äº†ä¸€ä¸ªååˆ†å…¸å‹çš„ä¸¤éš¾å›°å¢ƒã€‚æˆ‘åªèƒ½å¸¦ä½ çœ‹çœ‹å¦‚ä½•åœ¨ä¸€ä¸ªæˆ‘é€‰æ‹©çš„å°ç¨‹åºä¸­è¿›è¡Œé‡æ„ï¼Œç„¶è€Œå¦ç™½è¯´ï¼Œé‚£ä¸ªç¨‹åºçš„è§„æ¨¡æ ¹æœ¬ä¸å€¼å¾—æˆ‘ä»¬è¿™ä¹ˆåšã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ç»™ä½ çœ‹çš„ä»£ç æ˜¯å¤§ç³»ç»Ÿçš„ä¸€éƒ¨åˆ†ï¼Œé‡æ„æŠ€æœ¯å¾ˆå¿«å°±å˜å¾—é‡è¦èµ·æ¥ã€‚æ‰€ä»¥è¯·ä½ ä¸€è¾¹è§‚èµè¿™ä¸ªå°ä¾‹å­ï¼Œä¸€è¾¹æƒ³è±¡å®ƒèº«å¤„äºä¸€ä¸ªå¤§å¾—å¤šçš„ç³»ç»Ÿã€‚

## 1.1 èµ·ç‚¹

åœ¨æœ¬ä¹¦ç¬¬ 1 ç‰ˆä¸­ï¼Œæˆ‘ä½¿ç”¨çš„ç¤ºä¾‹ç¨‹åºæ˜¯ä¸ºå½±ç‰‡å‡ºç§Ÿåº—çš„é¡¾å®¢æ‰“å°ä¸€å¼ è¯¦å•ã€‚æ”¾åˆ°ä»Šå¤©ï¼Œå¾ˆå¤šäººå¯èƒ½è¦é—®äº†ï¼šâ€œå½±ç‰‡å‡ºç§Ÿåº—æ˜¯ä»€ä¹ˆï¼Ÿâ€ä¸ºäº†é¿å…è¿‡å¤šå›ç­”è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ç¿»æ–°äº†ä¸€ä¸‹ç¤ºä¾‹ï¼Œå°†å…¶åŒ…è£…æˆä¸€ä¸ªä»æœ‰å¤å…¸éŸµå‘³åˆå°šæœªæ¶ˆäº¡çš„ç°ä»£ç¤ºä¾‹ã€‚

è®¾æƒ³æœ‰ä¸€ä¸ªæˆå‰§æ¼”å‡ºå›¢ï¼Œæ¼”å‘˜ä»¬ç»å¸¸è¦å»å„ç§åœºåˆè¡¨æ¼”æˆå‰§ã€‚é€šå¸¸å®¢æˆ·ï¼ˆcustomerï¼‰ä¼šæŒ‡å®šå‡ å‡ºå‰§ç›®ï¼Œè€Œå‰§å›¢åˆ™æ ¹æ®è§‚ä¼—ï¼ˆaudienceï¼‰äººæ•°åŠå‰§ç›®ç±»å‹æ¥å‘å®¢æˆ·æ”¶è´¹ã€‚è¯¥å›¢ç›®å‰å‡ºæ¼”ä¸¤ç§æˆå‰§ï¼šæ‚²å‰§ï¼ˆtragedyï¼‰å’Œå–œå‰§ï¼ˆcomedyï¼‰ã€‚ç»™å®¢æˆ·å‘å‡ºè´¦å•æ—¶ï¼Œå‰§å›¢è¿˜ä¼šæ ¹æ®åˆ°åœºè§‚ä¼—çš„æ•°é‡ç»™å‡ºâ€œè§‚ä¼—é‡ç§¯åˆ†â€ï¼ˆvolume creditï¼‰ä¼˜æƒ ï¼Œä¸‹æ¬¡å®¢æˆ·å†è¯·å‰§å›¢è¡¨æ¼”æ—¶å¯ä»¥ä½¿ç”¨ç§¯åˆ†è·å¾—æŠ˜æ‰£â€”â€”ä½ å¯ä»¥æŠŠå®ƒçœ‹ä½œä¸€ç§æå‡å®¢æˆ·å¿ è¯šåº¦çš„æ–¹å¼ã€‚

è¯¥å‰§å›¢å°†å‰§ç›®çš„æ•°æ®å­˜å‚¨åœ¨ä¸€ä¸ªç®€å•çš„ JSON æ–‡ä»¶ä¸­ã€‚

#### plays.json

```json
{
  "hamlet": { "name": "Hamlet", "type": "tragedy" },
  "as-like": { "name": "As You Like It", "type": "comedy" },
  "othello": { "name": "Othello", "type": "tragedy" }
}
```

ä»–ä»¬å¼€å‡ºçš„è´¦å•ä¹Ÿå­˜å‚¨åœ¨ä¸€ä¸ª JSON æ–‡ä»¶é‡Œã€‚

#### invoices.json

```json
[
  {
    "customer": "BigCo",
    "performances": [
      {
        "playID": "hamlet",
        "audience": 55
      },
      {
        "playID": "as-like",
        "audience": 35
      },
      {
        "playID": "othello",
        "audience": 40
      }
    ]
  }
]
```

ä¸‹é¢è¿™ä¸ªç®€å•çš„å‡½æ•°ç”¨äºæ‰“å°è´¦å•è¯¦æƒ…ã€‚

```js
function statement (invoice, plays) {
  let totalAmount = 0;
  let volumeCredits = 0;
  let result = `Statement for ${invoice.customer}\n`;
  const format = new Intl.NumberFormat("en-US",
                        { style: "currency", currency: "USD",
                          minimumFractionDigits: 2 }).format;
  for (let perf of invoice.performances) {
    const play = plays[perf.playID];
    let thisAmount = 0;

    switch (play.type) {
    case "tragedy":
      thisAmount = 40000;
      if (perf.audience &gt; 30) {
        thisAmount += 1000 * (perf.audience - 30);
      }
      break;
    case "comedy":
      thisAmount = 30000;
      if (perf.audience &gt; 20) {
        thisAmount += 10000 + 500 * (perf.audience - 20);
      }
      thisAmount += 300 * perf.audience;
      break;
    default:
        throw new Error(`unknown type: ${play.type}`);
    }

    // add volume credits
    volumeCredits += Math.max(perf.audience - 30, 0);
    // add extra credit for every ten comedy attendees
    if ("comedy" === play.type) volumeCredits += Math.floor(perf.audience / 5);

    // print line for this order
    result += ` ${play.name}: ${format(thisAmount/100)} (${perf.audience} seats)\n`;
    totalAmount += thisAmount;
  }
  result += `Amount owed is ${format(totalAmount/100)}\n`;
  result += `You earned ${volumeCredits} credits\n`;
  return result;
}
```

ç”¨ä¸Šé¢çš„æ•°æ®æ–‡ä»¶ï¼ˆinvoices.json å’Œ plays.jsonï¼‰ä½œä¸ºæµ‹è¯•è¾“å…¥ï¼Œè¿è¡Œè¿™æ®µä»£ç ï¼Œä¼šå¾—åˆ°å¦‚ä¸‹è¾“å‡ºï¼š

```plain
Statement for BigCo
  Hamlet: $650.00 (55 seats)
  As You Like It: $580.00 (35 seats)
  Othello: $500.00 (40 seats)
Amount owed is $1,730.00
You earned 47 credits
```

## 1.2 å¯¹æ­¤èµ·å§‹ç¨‹åºçš„è¯„ä»·

ä½ è§‰å¾—è¿™ä¸ªç¨‹åºè®¾è®¡å¾—æ€ä¹ˆæ ·ï¼Ÿæˆ‘çš„ç¬¬ä¸€æ„Ÿè§‰æ˜¯ï¼Œä»£ç ç»„ç»‡ä¸ç”šæ¸…æ™°ï¼Œä½†è¿™è¿˜åœ¨å¯å¿å—çš„é™åº¦å†…ã€‚è¿™æ ·å°çš„ç¨‹åºï¼Œä¸åšä»»ä½•æ·±å…¥çš„è®¾è®¡ï¼Œä¹Ÿä¸ä¼šå¤ªéš¾ç†è§£ã€‚ä½†æˆ‘å‰é¢è®²è¿‡ï¼Œè¿™æ˜¯å› ä¸ºè¦ä¿è¯ä¾‹å­è¶³å¤Ÿå°çš„ç¼˜æ•…ã€‚å¦‚æœè¿™æ®µä»£ç èº«å¤„äºä¸€ä¸ªæ›´å¤§è§„æ¨¡â€”â€”ä¹Ÿè®¸æ˜¯å‡ ç™¾è¡Œâ€”â€”çš„ç¨‹åºä¸­ï¼ŒæŠŠæ‰€æœ‰ä»£ç æ”¾åˆ°ä¸€ä¸ªå‡½æ•°é‡Œå°±å¾ˆéš¾ç†è§£äº†ã€‚

å°½ç®¡å¦‚æ­¤ï¼Œè¿™ä¸ªç¨‹åºè¿˜æ˜¯èƒ½æ­£å¸¸å·¥ä½œã€‚é‚£ä¹ˆæ˜¯ä¸æ˜¯è¯´ï¼Œå¯¹å…¶ç»“æ„â€œä¸ç”šæ¸…æ™°â€çš„è¯„ä»·åªæ˜¯ç¾å­¦æ„ä¹‰ä¸Šçš„åˆ¤æ–­ï¼Œåªæ˜¯å¯¹æ‰€è°“ä¸‘é™‹ä»£ç çš„åæ„Ÿå‘¢ï¼Ÿæ¯•ç«Ÿç¼–è¯‘å™¨ä¹Ÿä¸ä¼šåœ¨ä¹ä»£ç å¥½ä¸å¥½çœ‹ã€‚ä½†æ˜¯ï¼Œå½“æˆ‘ä»¬éœ€è¦ä¿®æ”¹ç³»ç»Ÿæ—¶ï¼Œå°±æ¶‰åŠäº†äººï¼Œè€Œäººåœ¨ä¹è¿™äº›ã€‚å·®åŠ²çš„ç³»ç»Ÿæ˜¯å¾ˆéš¾ä¿®æ”¹çš„ï¼Œå› ä¸ºå¾ˆéš¾æ‰¾åˆ°ä¿®æ”¹ç‚¹ï¼Œéš¾ä»¥äº†è§£åšå‡ºçš„ä¿®æ”¹ä¸ç°æœ‰ä»£ç å¦‚ä½•åä½œå®ç°æˆ‘æƒ³è¦çš„è¡Œä¸ºã€‚å¦‚æœå¾ˆéš¾æ‰¾åˆ°ä¿®æ”¹ç‚¹ï¼Œæˆ‘å°±å¾ˆæœ‰å¯èƒ½çŠ¯é”™ï¼Œä»è€Œå¼•å…¥ bugã€‚

å› æ­¤ï¼Œå¦‚æœæˆ‘éœ€è¦ä¿®æ”¹ä¸€ä¸ªæœ‰å‡ ç™¾è¡Œä»£ç çš„ç¨‹åºï¼Œæˆ‘ä¼šæœŸæœ›å®ƒæœ‰è‰¯å¥½çš„ç»“æ„ï¼Œå¹¶ä¸”å·²ç»è¢«åˆ†è§£æˆä¸€ç³»åˆ—å‡½æ•°å’Œå…¶ä»–ç¨‹åºè¦ç´ ï¼Œè¿™èƒ½å¸®æˆ‘æ›´æ˜“äºæ¸…æ¥šåœ°äº†è§£è¿™æ®µä»£ç åœ¨åšä»€ä¹ˆã€‚å¦‚æœç¨‹åºæ‚ä¹±æ— ç« ï¼Œå…ˆä¸ºå®ƒæ•´ç†å‡ºç»“æ„æ¥ï¼Œå†åšéœ€è¦çš„ä¿®æ”¹ï¼Œé€šå¸¸æ¥è¯´æ›´åŠ ç®€å•ã€‚

::: tip
å¦‚æœä½ è¦ç»™ç¨‹åºæ·»åŠ ä¸€ä¸ªç‰¹æ€§ï¼Œä½†å‘ç°ä»£ç å› ç¼ºä¹è‰¯å¥½çš„ç»“æ„è€Œä¸æ˜“äºè¿›è¡Œæ›´æ”¹ï¼Œé‚£å°±å…ˆé‡æ„é‚£ä¸ªç¨‹åºï¼Œä½¿å…¶æ¯”è¾ƒå®¹æ˜“æ·»åŠ è¯¥ç‰¹æ€§ï¼Œç„¶åå†æ·»åŠ è¯¥ç‰¹æ€§ã€‚
:::

åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œæˆ‘ä»¬çš„ç”¨æˆ·å¸Œæœ›å¯¹ç³»ç»Ÿåšå‡ ä¸ªä¿®æ”¹ã€‚é¦–å…ˆï¼Œä»–ä»¬å¸Œæœ›ä»¥ HTML æ ¼å¼è¾“å‡ºè¯¦å•ã€‚ç°åœ¨è¯·ä½ æƒ³ä¸€æƒ³ï¼Œè¿™ä¸ªå˜åŒ–ä¼šå¸¦æ¥ä»€ä¹ˆå½±å“ã€‚å¯¹äºæ¯å¤„è¿½åŠ å­—ç¬¦ä¸²åˆ° result å˜é‡çš„åœ°æ–¹æˆ‘éƒ½å¾—ä¸ºå®ƒä»¬æ·»åŠ åˆ†æ”¯é€»è¾‘ã€‚è¿™ä¼šä¸ºå‡½æ•°å¼•å…¥æ›´å¤šå¤æ‚åº¦ã€‚é‡åˆ°è¿™ç§éœ€æ±‚æ—¶ï¼Œå¾ˆå¤šäººä¼šé€‰æ‹©ç›´æ¥å¤åˆ¶æ•´ä¸ªæ–¹æ³•ï¼Œåœ¨å…¶ä¸­ä¿®æ”¹è¾“å‡º HTML çš„éƒ¨åˆ†ã€‚å¤åˆ¶ä¸€éä»£ç ä¼¼ä¹ä¸ç®—å¤ªéš¾ï¼Œä½†å´ç»™æœªæ¥ç•™ä¸‹å„ç§éšæ‚£ï¼šä¸€æ—¦è®¡è´¹é€»è¾‘å‘ç”Ÿå˜åŒ–ï¼Œæˆ‘å°±å¾—åŒæ—¶ä¿®æ”¹ä¸¤ä¸ªåœ°æ–¹ï¼Œä»¥ä¿è¯å®ƒä»¬é€»è¾‘ç›¸åŒã€‚å¦‚æœä½ ç¼–å†™çš„æ˜¯ä¸€ä¸ªæ°¸ä¸éœ€è¦ä¿®æ”¹çš„ç¨‹åºï¼Œè¿™æ ·å‰ªå‰ªè´´è´´å°±è¿˜å¥½ã€‚ä½†å¦‚æœç¨‹åºè¦ä¿å­˜å¾ˆé•¿æ—¶é—´ï¼Œé‚£ä¹ˆé‡å¤çš„é€»è¾‘å°±ä¼šé€ æˆæ½œåœ¨çš„å¨èƒã€‚

ç°åœ¨ï¼Œç¬¬äºŒä¸ªå˜åŒ–æ¥äº†ï¼šæ¼”å‘˜ä»¬å°è¯•åœ¨è¡¨æ¼”ç±»å‹ä¸Šåšæ›´å¤šçªç ´ï¼Œæ— è®ºæ˜¯å†å²å‰§ã€ç”°å›­å‰§ã€ç”°å›­å–œå‰§ã€ç”°å›­å²å‰§ã€å†å²æ‚²å‰§è¿˜æ˜¯å†å²ç”°å›­æ‚²å–œå‰§ï¼Œæ— è®ºä¸€æˆä¸å˜çš„æ­£ç»Ÿæˆï¼Œè¿˜æ˜¯åƒå˜ä¸‡å¹»çš„æ–°æ´¾æˆï¼Œä»–ä»¬éƒ½å¸Œæœ›æœ‰æ‰€å°è¯•ï¼Œåªæ˜¯è¿˜æ²¡æœ‰å†³å®šè¯•å“ªç§ä»¥åŠä½•æ—¶è¯•æ¼”ã€‚è¿™å¯¹æˆå‰§åœºæ¬¡çš„è®¡è´¹æ–¹å¼ã€ç§¯åˆ†çš„è®¡ç®—æ–¹å¼éƒ½æœ‰å½±å“ã€‚ä½œä¸ºä¸€ä¸ªç»éªŒä¸°å¯Œçš„å¼€å‘è€…ï¼Œæˆ‘å¯ä»¥è‚¯å®šï¼šä¸è®ºæœ€ç»ˆæå‡ºä»€ä¹ˆæ–¹æ¡ˆï¼Œä»–ä»¬ä¸€å®šä¼šåœ¨ 6 ä¸ªæœˆä¹‹å†…å†æ¬¡ä¿®æ”¹å®ƒã€‚æ¯•ç«Ÿï¼Œéœ€æ±‚é€šå¸¸ä¸æ¥åˆ™å·²ï¼Œä¸€æ¥ä¾¿ä¼šæ¥è¸µè€Œè‡³ã€‚

ä¸ºäº†åº”å¯¹åˆ†ç±»è§„åˆ™å’Œè®¡è´¹è§„åˆ™çš„å˜åŒ–ï¼Œç¨‹åºå¿…é¡»å¯¹ statement å‡½æ•°åšå‡ºä¿®æ”¹ã€‚ä½†å¦‚æœæˆ‘æŠŠ statement å†…çš„ä»£ç å¤åˆ¶åˆ°ç”¨ä»¥æ‰“å° HTML è¯¦å•çš„å‡½æ•°ä¸­ï¼Œå°±å¿…é¡»ç¡®ä¿å°†æ¥çš„ä»»ä½•ä¿®æ”¹åœ¨è¿™ä¸¤ä¸ªåœ°æ–¹ä¿æŒä¸€è‡´ã€‚éšç€å„ç§è§„åˆ™å˜å¾—è¶Šæ¥è¶Šå¤æ‚ï¼Œé€‚å½“çš„ä¿®æ”¹ç‚¹å°†è¶Šæ¥è¶Šéš¾æ‰¾ï¼Œä¸çŠ¯é”™çš„æœºä¼šä¹Ÿè¶Šæ¥è¶Šå°‘ã€‚

æˆ‘å†å¼ºè°ƒä¸€æ¬¡ï¼Œæ˜¯éœ€æ±‚çš„å˜åŒ–ä½¿é‡æ„å˜å¾—å¿…è¦ã€‚å¦‚æœä¸€æ®µä»£ç èƒ½æ­£å¸¸å·¥ä½œï¼Œå¹¶ä¸”ä¸ä¼šå†è¢«ä¿®æ”¹ï¼Œé‚£ä¹ˆå®Œå…¨å¯ä»¥ä¸å»é‡æ„å®ƒã€‚èƒ½æ”¹è¿›ä¹‹å½“ç„¶å¾ˆå¥½ï¼Œä½†è‹¥æ²¡äººéœ€è¦å»ç†è§£å®ƒï¼Œå®ƒå°±ä¸ä¼šçœŸæ­£å¦¨ç¢ä»€ä¹ˆã€‚å¦‚æœç¡®å®æœ‰äººéœ€è¦ç†è§£å®ƒçš„å·¥ä½œåŸç†ï¼Œå¹¶ä¸”è§‰å¾—ç†è§£èµ·æ¥å¾ˆè´¹åŠ²ï¼Œé‚£ä½ å°±éœ€è¦æ”¹è¿›ä¸€ä¸‹ä»£ç äº†ã€‚

## 1.3 é‡æ„çš„ç¬¬ä¸€æ­¥

æ¯å½“æˆ‘è¦è¿›è¡Œé‡æ„çš„æ—¶å€™ï¼Œç¬¬ä¸€ä¸ªæ­¥éª¤æ°¸è¿œç›¸åŒï¼šæˆ‘å¾—ç¡®ä¿å³å°†ä¿®æ”¹çš„ä»£ç æ‹¥æœ‰ä¸€ç»„å¯é çš„æµ‹è¯•ã€‚è¿™äº›æµ‹è¯•å¿…ä¸å¯å°‘ï¼Œå› ä¸ºå°½ç®¡éµå¾ªé‡æ„æ‰‹æ³•å¯ä»¥ä½¿æˆ‘é¿å…ç»å¤§å¤šæ•°å¼•å…¥ bug çš„æƒ…å½¢ï¼Œä½†æˆ‘æ¯•ç«Ÿæ˜¯äººï¼Œæ¯•ç«Ÿæœ‰å¯èƒ½çŠ¯é”™ã€‚ç¨‹åºè¶Šå¤§ï¼Œæˆ‘çš„ä¿®æ”¹ä¸å°å¿ƒç ´åå…¶ä»–ä»£ç çš„å¯èƒ½æ€§å°±è¶Šå¤§â€”â€”åœ¨æ•°å­—æ—¶ä»£ï¼Œè½¯ä»¶çš„åå­—å°±æ˜¯è„†å¼±ã€‚

statement å‡½æ•°çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæˆ‘åšçš„å°±æ˜¯åˆ›å»ºå‡ å¼ æ–°çš„è´¦å•ï¼ˆinvoiceï¼‰ï¼Œå‡è®¾æ¯å¼ è´¦å•æ”¶å–äº†å‡ å‡ºæˆå‰§çš„è´¹ç”¨ï¼Œç„¶åä½¿ç”¨è¿™å‡ å¼ è´¦å•ä½œä¸ºè¾“å…¥è°ƒç”¨ statement å‡½æ•°ï¼Œç”Ÿæˆå¯¹åº”çš„å¯¹è´¦å•ï¼ˆstatementï¼‰å­—ç¬¦ä¸²ã€‚æˆ‘ä¼šæ‹¿ç”Ÿæˆçš„å­—ç¬¦ä¸²ä¸æˆ‘å·²ç»æ‰‹å·¥æ£€æŸ¥è¿‡çš„å­—ç¬¦ä¸²åšæ¯”å¯¹ã€‚æˆ‘ä¼šå€ŸåŠ©ä¸€ä¸ªæµ‹è¯•æ¡†æ¶æ¥é…ç½®å¥½è¿™äº›æµ‹è¯•ï¼Œåªè¦åœ¨å¼€å‘ç¯å¢ƒä¸­è¾“å…¥ä¸€è¡Œå‘½ä»¤å°±å¯ä»¥æŠŠå®ƒä»¬è¿è¡Œèµ·æ¥ã€‚è¿è¡Œè¿™äº›æµ‹è¯•åªéœ€å‡ ç§’é’Ÿï¼Œæ‰€ä»¥ä½ ä¼šçœ‹åˆ°æˆ‘ç»å¸¸è¿è¡Œå®ƒä»¬ã€‚

æµ‹è¯•è¿‡ç¨‹ä¸­å¾ˆé‡è¦çš„ä¸€éƒ¨åˆ†ï¼Œå°±æ˜¯æµ‹è¯•ç¨‹åºå¯¹äºç»“æœçš„æŠ¥å‘Šæ–¹å¼ã€‚å®ƒä»¬è¦ä¹ˆå˜ç»¿ï¼Œè¡¨ç¤ºæ‰€æœ‰æ–°å­—ç¬¦ä¸²éƒ½å’Œå‚è€ƒå­—ç¬¦ä¸²ä¸€æ ·ï¼Œè¦ä¹ˆå°±å˜çº¢ï¼Œç„¶ååˆ—å‡ºå¤±è´¥æ¸…å•ï¼Œæ˜¾ç¤ºé—®é¢˜å­—ç¬¦ä¸²çš„å‡ºç°è¡Œå·ã€‚è¿™äº›æµ‹è¯•éƒ½èƒ½å¤Ÿè‡ªæˆ‘æ£€éªŒã€‚ä½¿æµ‹è¯•èƒ½è‡ªæˆ‘æ£€éªŒè‡³å…³é‡è¦ï¼Œå¦åˆ™å°±å¾—è€—è´¹å¤§æŠŠæ—¶é—´æ¥å›æ¯”å¯¹ï¼Œè¿™ä¼šé™ä½å¼€å‘é€Ÿåº¦ã€‚ç°ä»£çš„æµ‹è¯•æ¡†æ¶éƒ½æä¾›äº†ä¸°å¯Œçš„è®¾æ–½ï¼Œæ”¯æŒç¼–å†™å’Œè¿è¡Œèƒ½å¤Ÿè‡ªæˆ‘æ£€éªŒçš„æµ‹è¯•ã€‚

::: tip
é‡æ„å‰ï¼Œå…ˆæ£€æŸ¥è‡ªå·±æ˜¯å¦æœ‰ä¸€å¥—å¯é çš„æµ‹è¯•é›†ã€‚è¿™äº›æµ‹è¯•å¿…é¡»æœ‰è‡ªæˆ‘æ£€éªŒèƒ½åŠ›ã€‚
:::

è¿›è¡Œé‡æ„æ—¶ï¼Œæˆ‘éœ€è¦ä¾èµ–æµ‹è¯•ã€‚æˆ‘å°†æµ‹è¯•è§†ä¸º bug æ£€æµ‹å™¨ï¼Œå®ƒä»¬èƒ½ä¿æŠ¤æˆ‘ä¸è¢«è‡ªå·±çŠ¯çš„é”™è¯¯æ‰€å›°æ‰°ã€‚æŠŠæˆ‘æƒ³è¦è¾¾æˆçš„ç›®æ ‡å†™ä¸¤éâ€”â€”ä»£ç é‡Œå†™ä¸€éï¼Œæµ‹è¯•é‡Œå†å†™ä¸€éâ€”â€”æˆ‘å°±å¾—çŠ¯ä¸¤éåŒæ ·çš„é”™è¯¯æ‰èƒ½éª—è¿‡æ£€æµ‹å™¨ã€‚è¿™é™ä½äº†æˆ‘çŠ¯é”™çš„æ¦‚ç‡ï¼Œå› ä¸ºæˆ‘å¯¹å·¥ä½œè¿›è¡Œäº†äºŒæ¬¡ç¡®è®¤ã€‚å°½ç®¡ç¼–å†™æµ‹è¯•éœ€è¦èŠ±è´¹æ—¶é—´ï¼Œä½†å´ä¸ºæˆ‘èŠ‚çœä¸‹å¯è§‚çš„è°ƒè¯•æ—¶é—´ã€‚æ„ç­‘æµ‹è¯•ä½“ç³»å¯¹é‡æ„æ¥è¯´å®åœ¨å¤ªé‡è¦äº†ï¼Œå› æ­¤æˆ‘å°†ç”¨ç¬¬ 4 ç« ä¸€æ•´ç« çš„ç¬”å¢¨æ¥è¯¦ç»†è®¨è®ºå®ƒã€‚

## 1.4 åˆ†è§£ statement å‡½æ•°

æ¯å½“çœ‹åˆ°è¿™æ ·é•¿é•¿çš„å‡½æ•°ï¼Œæˆ‘ä¾¿ä¸‹æ„è¯†åœ°æƒ³ä»æ•´ä¸ªå‡½æ•°ä¸­åˆ†ç¦»å‡ºä¸åŒçš„å…³æ³¨ç‚¹ã€‚ç¬¬ä¸€ä¸ªå¼•èµ·æˆ‘æ³¨æ„çš„å°±æ˜¯ä¸­é—´é‚£æ®µ switch è¯­å¥ã€‚

```js
function statement (invoice, plays) {
  let totalAmount = 0;
  let volumeCredits = 0;
  let result = `Statement for ${invoice.customer}\n`;
  const format = new Intl.NumberFormat("en-US",
                        { style: "currency", currency: "USD",
                          minimumFractionDigits: 2 }).format;
  for (let perf of invoice.performances) {
    const play = plays[perf.playID];
    let thisAmount = 0;

    switch (play.type) {
    case "tragedy":
      thisAmount = 40000;
      if (perf.audience &gt; 30) {
        thisAmount += 1000 * (perf.audience - 30);
      }
      break;
    case "comedy":
      thisAmount = 30000;
      if (perf.audience &gt; 20) {
        thisAmount += 10000 + 500 * (perf.audience - 20);
      }
      thisAmount += 300 * perf.audience;
      break;
    default:
        throw new Error(`unknown type: ${play.type}`);
    }

    // add volume credits
    volumeCredits += Math.max(perf.audience - 30, 0);
    // add extra credit for every ten comedy attendees
    if ("comedy" === play.type) volumeCredits += Math.floor(perf.audience / 5);

    // print line for this order
    result += ` ${play.name}: ${format(thisAmount/100)} (${perf.audience} seats)\n`;
    totalAmount += thisAmount;
  }
  result += `Amount owed is ${format(totalAmount/100)}\n`;
  result += `You earned ${volumeCredits} credits\n`;
  return result;
}
```

çœ‹ç€è¿™å—ä»£ç ï¼Œæˆ‘å°±çŸ¥é“å®ƒåœ¨è®¡ç®—ä¸€åœºæˆå‰§æ¼”å‡ºçš„è´¹ç”¨ã€‚è¿™æ˜¯æˆ‘çš„ç›´è§‰ã€‚ä¸è¿‡æ­£å¦‚ Ward Cunningham æ‰€è¯´ï¼Œè¿™ç§ç†è§£åªæ˜¯æˆ‘è„‘æµ·ä¸­è½¬ç¬å³é€çš„çµå…‰ã€‚æˆ‘éœ€è¦æ¢³ç†è¿™äº›çµæ„Ÿï¼Œå°†å®ƒä»¬ä»è„‘æµ·ä¸­æ¬å›åˆ°ä»£ç é‡Œå»ï¼Œä»¥å…å¿˜è®°ã€‚è¿™æ ·å½“æˆ‘å›å¤´çœ‹æ—¶ï¼Œä»£ç å°±èƒ½å‘Šè¯‰æˆ‘å®ƒåœ¨å¹²ä»€ä¹ˆï¼Œæˆ‘ä¸éœ€è¦é‡æ–°æ€è€ƒä¸€éã€‚

è¦å°†æˆ‘çš„ç†è§£è½¬åŒ–åˆ°ä»£ç é‡Œï¼Œå¾—å…ˆå°†è¿™å—ä»£ç æŠ½å–æˆä¸€ä¸ªç‹¬ç«‹çš„å‡½æ•°ï¼ŒæŒ‰å®ƒæ‰€å¹²çš„äº‹æƒ…ç»™å®ƒå‘½åï¼Œæ¯”å¦‚å« amountFor(performance)ã€‚æ¯æ¬¡æƒ³å°†ä¸€å—ä»£ç æŠ½å–æˆä¸€ä¸ªå‡½æ•°æ—¶ï¼Œæˆ‘éƒ½ä¼šéµå¾ªä¸€ä¸ªæ ‡å‡†æµç¨‹ï¼Œæœ€å¤§ç¨‹åº¦å‡å°‘çŠ¯é”™çš„å¯èƒ½ã€‚æˆ‘æŠŠè¿™ä¸ªæµç¨‹è®°å½•äº†ä¸‹æ¥ï¼Œå¹¶å°†å®ƒå‘½åä¸ºæç‚¼å‡½æ•°ï¼ˆ106ï¼‰ï¼Œä»¥ä¾¿æ—¥åå¯ä»¥æ–¹ä¾¿åœ°å¼•ç”¨ã€‚

é¦–å…ˆï¼Œæˆ‘éœ€è¦æ£€æŸ¥ä¸€ä¸‹ï¼Œå¦‚æœæˆ‘å°†è¿™å—ä»£ç æç‚¼åˆ°è‡ªå·±çš„ä¸€ä¸ªå‡½æ•°é‡Œï¼Œæœ‰å“ªäº›å˜é‡ä¼šç¦»å¼€åŸæœ¬çš„ä½œç”¨åŸŸã€‚åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œæ˜¯ perfã€play å’Œ thisAmount è¿™ 3 ä¸ªå˜é‡ã€‚å‰ä¸¤ä¸ªå˜é‡ä¼šè¢«æç‚¼åçš„å‡½æ•°ä½¿ç”¨ï¼Œä½†ä¸ä¼šè¢«ä¿®æ”¹ï¼Œé‚£ä¹ˆæˆ‘å°±å¯ä»¥å°†å®ƒä»¬ä»¥å‚æ•°æ–¹å¼ä¼ é€’è¿›æ¥ã€‚æˆ‘æ›´å…³å¿ƒé‚£äº›ä¼šè¢«ä¿®æ”¹çš„å˜é‡ã€‚è¿™é‡Œåªæœ‰å”¯ä¸€ä¸€ä¸ªâ€”â€”thisAmountï¼Œå› æ­¤å¯ä»¥å°†å®ƒä»å‡½æ•°ä¸­ç›´æ¥è¿”å›ã€‚æˆ‘è¿˜å¯ä»¥å°†å…¶åˆå§‹åŒ–æ”¾åˆ°æç‚¼åçš„å‡½æ•°é‡Œã€‚ä¿®æ”¹åçš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚

#### function statement

```js
function amountFor(perf, play) {
  let thisAmount = 0;
  switch (play.type) {
  case "tragedy":
    thisAmount = 40000;
    if (perf.audience &gt; 30) {
      thisAmount += 1000 * (perf.audience - 30);
    }
    break;
  case "comedy":
    thisAmount = 30000;
    if (perf.audience &gt; 20) {
      thisAmount += 10000 + 500 * (perf.audience - 20);
    }
    thisAmount += 300 * perf.audience;
    break;
  default:
      throw new Error(`unknown type: ${play.type}`);
  }
  return thisAmount;
}
```

å½“æˆ‘åœ¨ä»£ç å—ä¸Šæ–¹ä½¿ç”¨äº†æ–œä½“ï¼ˆä¸­æ–‡å¯¹åº”ä¸ºæ¥·ä½“ï¼‰æ ‡è®°çš„é¢˜å¤´â€œ function xxx â€æ—¶ï¼Œè¡¨æ˜è¯¥ä»£ç å—ä½äºé¢˜å¤´æ‰€åœ¨å‡½æ•°ã€æ–‡ä»¶æˆ–ç±»çš„ä½œç”¨åŸŸå†…ã€‚é€šå¸¸è¯¥ä½œç”¨åŸŸå†…è¿˜æœ‰å…¶ä»–çš„ä»£ç ï¼Œä½†ç”±äºä¸æ˜¯è®¨è®ºé‡ç‚¹ï¼Œå› æ­¤æŠŠå®ƒä»¬éšå»ä¸å±•ç¤ºã€‚

ç°åœ¨åŸ statement å‡½æ•°å¯ä»¥ç›´æ¥è°ƒç”¨è¿™ä¸ªæ–°å‡½æ•°æ¥åˆå§‹åŒ– thisAmountã€‚

#### é¡¶å±‚ä½œç”¨åŸŸ

```js
function statement (invoice, plays) {
  let totalAmount = 0;
  let volumeCredits = 0;
  let result = `Statement for ${invoice.customer}\n`;
  const format = new Intl.NumberFormat("en-US",
                        { style: "currency", currency: "USD",
                          minimumFractionDigits: 2 }).format;
  for (let perf of invoice.performances) {
    const play = plays[perf.playID];
    let thisAmount = amountFor(perf, play);

    // add volume credits
    volumeCredits += Math.max(perf.audience - 30, 0);
    // add extra credit for every ten comedy attendees
    if ("comedy" === play.type) volumeCredits += Math.floor(perf.audience / 5);

    // print line for this order
    result += ` ${play.name}: ${format(thisAmount/100)} (${perf.audience} seats)\n`;
    totalAmount += thisAmount;
  }
  result += `Amount owed is ${format(totalAmount/100)}\n`;
  result += `You earned ${volumeCredits} credits\n`;
  return result;
```

åšå®Œè¿™ä¸ªæ”¹åŠ¨åï¼Œæˆ‘ä¼šé©¬ä¸Šç¼–è¯‘å¹¶æ‰§è¡Œä¸€éæµ‹è¯•ï¼Œçœ‹çœ‹æœ‰æ— ç ´åäº†å…¶ä»–ä¸œè¥¿ã€‚æ— è®ºæ¯æ¬¡é‡æ„å¤šä¹ˆç®€å•ï¼Œå…»æˆé‡æ„åå³è¿è¡Œæµ‹è¯•çš„ä¹ æƒ¯éå¸¸é‡è¦ã€‚çŠ¯é”™è¯¯æ˜¯å¾ˆå®¹æ˜“çš„â€”â€”è‡³å°‘æˆ‘çŸ¥é“æˆ‘æ˜¯å¾ˆå®¹æ˜“çŠ¯é”™çš„ã€‚åšå®Œä¸€æ¬¡ä¿®æ”¹å°±è¿è¡Œæµ‹è¯•ï¼Œè¿™æ ·åœ¨æˆ‘çœŸçš„çŠ¯äº†é”™æ—¶ï¼Œåªéœ€è¦è€ƒè™‘ä¸€ä¸ªå¾ˆå°çš„æ”¹åŠ¨èŒƒå›´ï¼Œè¿™ä½¿å¾—æŸ¥é”™ä¸ä¿®å¤é—®é¢˜æ˜“å¦‚åæŒã€‚è¿™å°±æ˜¯é‡æ„è¿‡ç¨‹çš„ç²¾é«“æ‰€åœ¨ï¼šå°æ­¥ä¿®æ”¹ï¼Œæ¯æ¬¡ä¿®æ”¹åå°±è¿è¡Œæµ‹è¯•ã€‚å¦‚æœæˆ‘æ”¹åŠ¨äº†å¤ªå¤šä¸œè¥¿ï¼ŒçŠ¯é”™æ—¶å°±å¯èƒ½é™·å…¥éº»çƒ¦çš„è°ƒè¯•ï¼Œå¹¶ä¸ºæ­¤è€—è´¹å¤§æŠŠæ—¶é—´ã€‚å°æ­¥ä¿®æ”¹ï¼Œä»¥åŠå®ƒå¸¦æ¥çš„é¢‘ç¹åé¦ˆï¼Œæ­£æ˜¯é˜²æ­¢æ··ä¹±çš„å…³é”®ã€‚

::: tip
è¿™é‡Œæˆ‘ä½¿ç”¨çš„â€œç¼–è¯‘â€ä¸€è¯ï¼ŒæŒ‡çš„æ˜¯å°† JavaScript å˜ä¸ºå¯æ‰§è¡Œä»£ç ä¹‹å‰çš„æ‰€æœ‰æ­¥éª¤ã€‚è™½ç„¶ JavaScript å¯ä»¥ç›´æ¥æ‰§è¡Œï¼Œæœ‰æ—¶å¯èƒ½ä¸éœ€ä»»ä½•æ­¥éª¤ï¼Œä½†æœ‰æ—¶å¯èƒ½éœ€è¦å°†ä»£ç ç§»åŠ¨åˆ°ä¸€ä¸ªè¾“å‡ºç›®å½•ï¼Œæˆ–ä½¿ç”¨ Babel è¿™æ ·çš„ä»£ç å¤„ç†å™¨ç­‰ã€‚
:::

å› ä¸ºæ˜¯ JavaScriptï¼Œæˆ‘å¯ä»¥ç›´æ¥å°† amountFor æç‚¼æˆä¸º statement çš„ä¸€ä¸ªå†…åµŒå‡½æ•°ã€‚è¿™ä¸ªç‰¹æ€§ååˆ†æœ‰ç”¨ï¼Œå› ä¸ºæˆ‘å°±ä¸éœ€è¦å†æŠŠå¤–éƒ¨ä½œç”¨åŸŸä¸­çš„æ•°æ®ä¼ ç»™æ–°æç‚¼çš„å‡½æ•°ã€‚è¿™ä¸ªç¤ºä¾‹ä¸­å¯èƒ½åŒºåˆ«ä¸å¤§ï¼Œä½†ä¹Ÿæ˜¯å°‘äº†ä¸€ä»¶è¦æ“å¿ƒçš„äº‹ã€‚

::: tip
é‡æ„æŠ€æœ¯å°±æ˜¯ä»¥å¾®å°çš„æ­¥ä¼ä¿®æ”¹ç¨‹åºã€‚å¦‚æœä½ çŠ¯ä¸‹é”™è¯¯ï¼Œå¾ˆå®¹æ˜“ä¾¿å¯å‘ç°å®ƒã€‚
:::

åšå®Œä¸Šé¢çš„ä¿®æ”¹ï¼Œæµ‹è¯•æ˜¯é€šè¿‡çš„ï¼Œå› æ­¤ä¸‹ä¸€æ­¥æˆ‘è¦æŠŠä»£ç æäº¤åˆ°æœ¬åœ°çš„ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿã€‚æˆ‘ä¼šä½¿ç”¨è¯¸å¦‚ git æˆ– mercurial è¿™æ ·çš„ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œå› ä¸ºå®ƒä»¬å¯ä»¥æ”¯æŒæœ¬åœ°æäº¤ã€‚æ¯æ¬¡æˆåŠŸçš„é‡æ„åæˆ‘éƒ½ä¼šæäº¤ä»£ç ï¼Œå¦‚æœå¾…ä¼šä¸å°å¿ƒæç ¸äº†ï¼Œæˆ‘ä¾¿èƒ½è½»æ¾å›æ»šåˆ°ä¸Šä¸€ä¸ªå¯å·¥ä½œçš„çŠ¶æ€ã€‚æŠŠä»£ç æ¨é€ï¼ˆpushï¼‰åˆ°è¿œç«¯ä»“åº“å‰ï¼Œæˆ‘ä¼šæŠŠé›¶ç¢çš„ä¿®æ”¹å‹ç¼©æˆä¸€ä¸ªæ›´æœ‰æ„ä¹‰çš„æäº¤ï¼ˆcommitï¼‰ã€‚

æç‚¼å‡½æ•°ï¼ˆ106ï¼‰æ˜¯ä¸€ä¸ªå¸¸è§çš„å¯è‡ªåŠ¨å®Œæˆçš„é‡æ„ã€‚å¦‚æœæˆ‘æ˜¯ç”¨ Java ç¼–ç¨‹ï¼Œæˆ‘ä¼šæœ¬èƒ½åœ°ä½¿ç”¨ IDE çš„å¿«æ·é”®æ¥å®Œæˆè¿™é¡¹é‡æ„ã€‚åœ¨æˆ‘æ’°å†™æœ¬ä¹¦æ—¶ï¼ŒJavaScript å·¥å…·å¯¹æ­¤é‡æ„çš„æ”¯æŒä»ä¸æ˜¯å¾ˆå¥å£®ï¼Œå› æ­¤æˆ‘å¿…é¡»æ‰‹åŠ¨é‡æ„ã€‚è¿™ä¸æ˜¯å¾ˆéš¾ï¼Œå½“ç„¶æˆ‘è¿˜æ˜¯éœ€è¦å°å¿ƒå¤„ç†é‚£äº›å±€éƒ¨ä½œç”¨åŸŸçš„å˜é‡ã€‚

å®Œæˆæç‚¼å‡½æ•°ï¼ˆ106ï¼‰æ‰‹æ³•åï¼Œæˆ‘ä¼šçœ‹çœ‹æç‚¼å‡ºæ¥çš„å‡½æ•°ï¼Œçœ‹æ˜¯å¦èƒ½è¿›ä¸€æ­¥æå‡å…¶è¡¨è¾¾èƒ½åŠ›ã€‚ä¸€èˆ¬æˆ‘åšçš„ç¬¬ä¸€ä»¶äº‹å°±æ˜¯ç»™ä¸€äº›å˜é‡æ”¹åï¼Œä½¿å®ƒä»¬æ›´ç®€æ´ï¼Œæ¯”å¦‚å°† thisAmount é‡å‘½åä¸º resultã€‚

#### function statement

```js
function amountFor(perf, play) {
  let result = 0;
  switch (play.type) {
  case "tragedy":
    result = 40000;
    if (perf.audience &gt; 30) {
      result += 1000 * (perf.audience - 30);
    }
    break;
  case "comedy":
    result = 30000;
    if (perf.audience &gt; 20) {
      result += 10000 + 500 * (perf.audience - 20);
    }
    result += 300 * perf.audience;
    break;
  default:
      throw new Error(`unknown type: ${play.type}`);
  }
  return result;
}
```

è¿™æ˜¯æˆ‘ä¸ªäººçš„ç¼–ç é£æ ¼ï¼šæ°¸è¿œå°†å‡½æ•°çš„è¿”å›å€¼å‘½åä¸ºâ€œresultâ€ï¼Œè¿™æ ·æˆ‘ä¸€çœ¼å°±èƒ½çŸ¥é“å®ƒçš„ä½œç”¨ã€‚ç„¶åæˆ‘å†æ¬¡ç¼–è¯‘ã€æµ‹è¯•ã€æäº¤ä»£ç ã€‚æ¥ç€ï¼Œæˆ‘å‰å¾€ä¸‹ä¸€ä¸ªç›®æ ‡â€”â€”å‡½æ•°å‚æ•°ã€‚

#### function statement

```js
function amountFor(aPerformance, play) {
  let result = 0;
  switch (play.type) {
  case "tragedy":
    result = 40000;
    if (aPerformance.audience &gt; 30) {
      result += 1000 * (aPerformance.audience - 30);
    }
    break;
  case "comedy":
    result = 30000;
    if (aPerformance.audience &gt; 20) {
      result += 10000 + 500 * (aPerformance.audience - 20);
    }
    result += 300 * aPerformance.audience;
    break;
  default:
      throw new Error(`unknown type: ${play.type}`);
  }
  return result;
}
```

è¿™æ˜¯æˆ‘çš„å¦ä¸€ä¸ªç¼–ç é£æ ¼ã€‚ä½¿ç”¨ä¸€é—¨åŠ¨æ€ç±»å‹è¯­è¨€ï¼ˆå¦‚ JavaScriptï¼‰æ—¶ï¼Œè·Ÿè¸ªå˜é‡çš„ç±»å‹å¾ˆæœ‰æ„ä¹‰ã€‚å› æ­¤ï¼Œæˆ‘ä¸ºå‚æ•°å–åæ—¶éƒ½é»˜è®¤å¸¦ä¸Šå…¶ç±»å‹åã€‚ä¸€èˆ¬æˆ‘ä¼šä½¿ç”¨ä¸å®šå† è¯ä¿®é¥°å®ƒï¼Œé™¤éå‘½åä¸­å¦æœ‰è§£é‡Šå…¶è§’è‰²çš„ç›¸å…³ä¿¡æ¯ã€‚è¿™ä¸ªä¹ æƒ¯æ˜¯ä» Kent Beck é‚£é‡Œå­¦çš„[Beck SBPP]ï¼Œåˆ°ç°åœ¨æˆ‘è¿˜ä¸€ç›´è§‰å¾—å¾ˆæœ‰ç”¨ã€‚

::: tip
å‚»ç“œéƒ½èƒ½å†™å‡ºè®¡ç®—æœºå¯ä»¥ç†è§£çš„ä»£ç ã€‚å”¯æœ‰èƒ½å†™å‡ºäººç±»å®¹æ˜“ç†è§£çš„ä»£ç çš„ï¼Œæ‰æ˜¯ä¼˜ç§€çš„ç¨‹åºå‘˜ã€‚
:::

è¿™æ¬¡æ”¹åæ˜¯å¦å€¼å¾—æˆ‘å¤§è´¹å‘¨ç« å‘¢ï¼Ÿå½“ç„¶å€¼å¾—ã€‚å¥½ä»£ç åº”èƒ½æ¸…æ¥šåœ°è¡¨æ˜å®ƒåœ¨åšä»€ä¹ˆï¼Œè€Œå˜é‡å‘½åæ˜¯ä»£ç æ¸…æ™°çš„å…³é”®ã€‚åªè¦æ”¹åèƒ½å¤Ÿæå‡ä»£ç çš„å¯è¯»æ€§ï¼Œé‚£å°±åº”è¯¥æ¯«ä¸çŠ¹è±«å»åšã€‚æœ‰å¥½çš„æŸ¥æ‰¾æ›¿æ¢å·¥å…·åœ¨æ‰‹ï¼Œæ”¹åé€šå¸¸å¹¶ä¸å›°éš¾ï¼›æ­¤å¤–ï¼Œä½ çš„æµ‹è¯•ä»¥åŠè¯­è¨€æœ¬èº«çš„é™æ€ç±»å‹æ”¯æŒï¼Œéƒ½å¯ä»¥å¸®ä½ æªå‡ºæ¼æ”¹çš„åœ°æ–¹ã€‚å¦‚ä»Šæœ‰äº†è‡ªåŠ¨åŒ–çš„é‡æ„å·¥å…·ï¼Œå³ä¾¿è¦ç»™ä¸€ä¸ªè¢«å¤§é‡è°ƒç”¨çš„å‡½æ•°æ”¹åï¼Œé€šå¸¸ä¹Ÿä¸åœ¨è¯ä¸‹ã€‚

æœ¬æ¥ä¸‹ä¸€ä¸ªè¦æ”¹åçš„å˜é‡æ˜¯ playï¼Œä½†æˆ‘å¯¹è¿™ä¸ªå‚æ•°å¦æœ‰å®‰æ’ã€‚

### ç§»é™¤ play å˜é‡

è§‚å¯Ÿ amountFor å‡½æ•°æ—¶ï¼Œæˆ‘ä¼šçœ‹çœ‹å®ƒçš„å‚æ•°éƒ½ä»å“ªé‡Œæ¥ã€‚aPerformance æ˜¯ä»å¾ªç¯å˜é‡ä¸­æ¥ï¼Œæ‰€ä»¥è‡ªç„¶æ¯æ¬¡å¾ªç¯éƒ½ä¼šæ”¹å˜ï¼Œä½† play å˜é‡æ˜¯ç”± performance å˜é‡è®¡ç®—å¾—åˆ°çš„ï¼Œå› æ­¤æ ¹æœ¬æ²¡å¿…è¦å°†å®ƒä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œæˆ‘å¯ä»¥åœ¨ amountFor å‡½æ•°ä¸­é‡æ–°è®¡ç®—å¾—åˆ°å®ƒã€‚å½“æˆ‘åˆ†è§£ä¸€ä¸ªé•¿å‡½æ•°æ—¶ï¼Œæˆ‘å–œæ¬¢å°† play è¿™æ ·çš„å˜é‡ç§»é™¤æ‰ï¼Œå› ä¸ºå®ƒä»¬åˆ›å»ºäº†å¾ˆå¤šå…·æœ‰å±€éƒ¨ä½œç”¨åŸŸçš„ä¸´æ—¶å˜é‡ï¼Œè¿™ä¼šä½¿æç‚¼å‡½æ•°æ›´åŠ å¤æ‚ã€‚è¿™é‡Œæˆ‘è¦ä½¿ç”¨çš„é‡æ„æ‰‹æ³•æ˜¯ä»¥æŸ¥è¯¢å–ä»£ä¸´æ—¶å˜é‡ï¼ˆ178ï¼‰ã€‚

æˆ‘å…ˆä»èµ‹å€¼è¡¨è¾¾å¼çš„å³è¾¹éƒ¨åˆ†æç‚¼å‡ºä¸€ä¸ªå‡½æ•°æ¥ã€‚

#### function statement

```js
function playFor(aPerformance) {
  return plays[aPerformance.playID];
}
```

#### é¡¶å±‚ä½œç”¨åŸŸ

```js
function statement (invoice, plays) {
  let totalAmount = 0;
  let volumeCredits = 0;
  let result = `Statement for ${invoice.customer}\n`;
  const format = new Intl.NumberFormat("en-US",
                        { style: "currency", currency: "USD",
                          minimumFractionDigits: 2 }).format;
  for (let perf of invoice.performances) {
    const play = playFor(perf);
    let thisAmount = amountFor(perf, play);

    // add volume credits
    volumeCredits += Math.max(perf.audience - 30, 0);
    // add extra credit for every ten comedy attendees
    if ("comedy" === play.type) volumeCredits += Math.floor(perf.audience / 5);

    // print line for this order
    result += ` ${play.name}: ${format(thisAmount/100)} (${perf.audience} seats)\n`;
    totalAmount += thisAmount;
  }
  result += `Amount owed is ${format(totalAmount/100)}\n`;
  result += `You earned ${volumeCredits} credits\n`;
  return result;
```

ç¼–è¯‘ã€æµ‹è¯•ã€æäº¤ï¼Œç„¶åä½¿ç”¨å†…è”å˜é‡ï¼ˆ123ï¼‰æ‰‹æ³•å†…è” play å˜é‡ã€‚

#### é¡¶å±‚ä½œç”¨åŸŸ

```js
function statement (invoice, plays) {
  let totalAmount = 0;
  let volumeCredits = 0;
  let result = `Statement for ${invoice.customer}\n`;
  const format = new Intl.NumberFormat("en-US",
                        { style: "currency", currency: "USD",
                          minimumFractionDigits: 2 }).format;
  for (let perf of invoice.performances) {
    const play = playFor(perf);
    let thisAmount = amountFor(perf, playFor(perf));

    // add volume credits
    volumeCredits += Math.max(perf.audience - 30, 0);
    // add extra credit for every ten comedy attendees
    if ("comedy" === playFor(perf).type) volumeCredits += Math.floor(perf.audience / 5);

    // print line for this order
    result += ` ${playFor(perf).name}: ${format(thisAmount/100)} (${perf.audience} seats)\n`;
    totalAmount += thisAmount;
  }
  result += `Amount owed is ${format(totalAmount/100)}\n`;
  result += `You earned ${volumeCredits} credits\n`;
  return result;
```

ç¼–è¯‘ã€æµ‹è¯•ã€æäº¤ã€‚å®Œæˆå˜é‡å†…è”åï¼Œæˆ‘å¯ä»¥å¯¹ amountFor å‡½æ•°åº”ç”¨æ”¹å˜å‡½æ•°å£°æ˜ï¼ˆ124ï¼‰ï¼Œç§»é™¤ play å‚æ•°ã€‚æˆ‘ä¼šåˆ†ä¸¤æ­¥èµ°ã€‚é¦–å…ˆåœ¨ amountFor å‡½æ•°å†…éƒ¨ä½¿ç”¨æ–°æç‚¼çš„å‡½æ•°ã€‚

#### function statement

```js
function amountFor(aPerformance, play) {
  let result = 0;
  switch (playFor(aPerformance).type) {
  case "tragedy":
    result = 40000;
    if (aPerformance.audience &gt; 30) {
      result += 1000 * (aPerformance.audience - 30);
    }
    break;
  case "comedy":
    result = 30000;
    if (aPerformance.audience &gt; 20) {
      result += 10000 + 500 * (aPerformance.audience - 20);
    }
    result += 300 * aPerformance.audience;
    break;
  default:
      throw new Error(`unknown type: ${playFor(aPerformance).type}`);
  }
  return result;
}
```

ç¼–è¯‘ã€æµ‹è¯•ã€æäº¤ï¼Œæœ€åå°†å‚æ•°åˆ é™¤ã€‚

#### é¡¶å±‚ä½œç”¨åŸŸ

```js
function statement (invoice, plays) {
  let totalAmount = 0;
  let volumeCredits = 0;
  let result = `Statement for ${invoice.customer}\n`;
  const format = new Intl.NumberFormat("en-US",
                        { style: "currency", currency: "USD",
                          minimumFractionDigits: 2 }).format;
  for (let perf of invoice.performances) {
    let thisAmount = amountFor(perf , playFor(perf) );

    // add volume credits
    volumeCredits += Math.max(perf.audience - 30, 0);
    // add extra credit for every ten comedy attendees
    if ("comedy" === playFor(perf).type) volumeCredits += Math.floor(perf.audience / 5);

    // print line for this order
    result += ` ${playFor(perf).name}: ${format(thisAmount/100)} (${perf.audience} seats)\n`;
    totalAmount += thisAmount;
  }
  result += `Amount owed is ${format(totalAmount/100)}\n`;
  result += `You earned ${volumeCredits} credits\n`;
  return result;
```

#### function statement

```js
function amountFor(aPerformance , play ) {
  let result = 0;
  switch (playFor(aPerformance).type) {
  case "tragedy":
    result = 40000;
    if (aPerformance.audience &gt; 30) {
      result += 1000 * (aPerformance.audience - 30);
    }
    break;
  case "comedy":
    result = 30000;
    if (aPerformance.audience &gt; 20) {
      result += 10000 + 500 * (aPerformance.audience - 20);
    }
    result += 300 * aPerformance.audience;
    break;
  default:
      throw new Error(`unknown type: ${playFor(aPerformance).type}`);
  }
  return result;
}
```

ç„¶åå†ä¸€æ¬¡ç¼–è¯‘ã€æµ‹è¯•ã€æäº¤ã€‚

è¿™æ¬¡é‡æ„å¯èƒ½åœ¨ä¸€äº›ç¨‹åºå‘˜å¿ƒä¸­æ•²å“è­¦é’Ÿï¼šé‡æ„å‰ï¼ŒæŸ¥æ‰¾ play å˜é‡çš„ä»£ç åœ¨æ¯æ¬¡å¾ªç¯ä¸­åªæ‰§è¡Œäº† 1 æ¬¡ï¼Œè€Œé‡æ„åå´æ‰§è¡Œäº† 3 æ¬¡ã€‚æˆ‘ä¼šåœ¨åé¢æ¢è®¨é‡æ„ä¸æ€§èƒ½ä¹‹é—´çš„å…³ç³»ï¼Œä½†ç°åœ¨ï¼Œæˆ‘è®¤ä¸ºè¿™æ¬¡æ”¹åŠ¨è¿˜ä¸å¤ªå¯èƒ½å¯¹æ€§èƒ½æœ‰ä¸¥é‡å½±å“ï¼Œå³ä¾¿çœŸçš„æœ‰æ‰€å½±å“ï¼Œåç»­å†å¯¹ä¸€æ®µç»“æ„è‰¯å¥½çš„ä»£ç è¿›è¡Œæ€§èƒ½è°ƒä¼˜ï¼Œä¹Ÿå®¹æ˜“å¾—å¤šã€‚

ç§»é™¤å±€éƒ¨å˜é‡çš„å¥½å¤„å°±æ˜¯åšæç‚¼æ—¶ä¼šç®€å•å¾—å¤šï¼Œå› ä¸ºéœ€è¦æ“å¿ƒçš„å±€éƒ¨ä½œç”¨åŸŸå˜å°‘äº†ã€‚å®é™…ä¸Šï¼Œåœ¨åšä»»ä½•æç‚¼å‰ï¼Œæˆ‘ä¸€èˆ¬éƒ½ä¼šå…ˆç§»é™¤å±€éƒ¨å˜é‡ã€‚

å¤„ç†å®Œ amountFor çš„å‚æ•°åï¼Œæˆ‘å›è¿‡å¤´æ¥çœ‹ä¸€ä¸‹å®ƒçš„è°ƒç”¨ç‚¹ã€‚å®ƒè¢«èµ‹å€¼ç»™ä¸€ä¸ªä¸´æ—¶å˜é‡ï¼Œä¹‹åå°±ä¸å†è¢«ä¿®æ”¹ï¼Œå› æ­¤æˆ‘åˆé‡‡ç”¨å†…è”å˜é‡ï¼ˆ123ï¼‰æ‰‹æ³•å†…è”å®ƒã€‚

#### é¡¶å±‚ä½œç”¨åŸŸ

```js
function statement (invoice, plays) {
  let totalAmount = 0;
  let volumeCredits = 0;
  let result = `Statement for ${invoice.customer}\n`;
  const format = new Intl.NumberFormat("en-US",
                        { style: "currency", currency: "USD",
                          minimumFractionDigits: 2 }).format;
    for (let perf of invoice.performances) {

    // add volume credits
    volumeCredits += Math.max(perf.audience - 30, 0);
    // add extra credit for every ten comedy attendees
    if ("comedy" === playFor(perf).type) volumeCredits += Math.floor(perf.audience / 5);

    // print line for this order
    result += ` ${playFor(perf).name}: ${format(amountFor(perf)/100)} (${perf.audience} seats)\n`;
    totalAmount += amountFor(perf);
  }
  result += `Amount owed is ${format(totalAmount/100)}\n`;
  result += `You earned ${volumeCredits} credits\n`;
  return result;
```

æç‚¼è®¡ç®—è§‚ä¼—é‡ç§¯åˆ†çš„é€»è¾‘

ç°åœ¨ statement å‡½æ•°çš„å†…éƒ¨å®ç°æ˜¯è¿™æ ·çš„ã€‚

#### é¡¶å±‚ä½œç”¨åŸŸ

```js
function statement (invoice, plays) {
  let totalAmount = 0;
  let volumeCredits = 0;
  let result = `Statement for ${invoice.customer}\n`;
  const format = new Intl.NumberFormat("en-US",
                        { style: "currency", currency: "USD",
                          minimumFractionDigits: 2 }).format;
  for (let perf of invoice.performances) {

    // add volume credits
    volumeCredits += Math.max(perf.audience - 30, 0);
    // add extra credit for every ten comedy attendees
    if ("comedy" === playFor(perf).type) volumeCredits += Math.floor(perf.audience / 5);

    // print line for this order
    result += ` ${playFor(perf).name}: ${format(amountFor(perf)/100)} (${perf.audience} seats)\n`;
    totalAmount += amountFor(perf);
  }
  result += `Amount owed is ${format(totalAmount/100)}\n`;
  result += `You earned ${volumeCredits} credits\n`;
  return result;
```

è¿™ä¼šå„¿æˆ‘ä»¬å°±çœ‹åˆ°äº†ç§»é™¤ play å˜é‡çš„å¥½å¤„ï¼Œç§»é™¤äº†ä¸€ä¸ªå±€éƒ¨ä½œç”¨åŸŸçš„å˜é‡ï¼Œæç‚¼è§‚ä¼—é‡ç§¯åˆ†çš„è®¡ç®—é€»è¾‘åˆæ›´ç®€å•ä¸€äº›ã€‚

æˆ‘ä»éœ€è¦å¤„ç†å…¶ä»–ä¸¤ä¸ªå±€éƒ¨å˜é‡ã€‚perf åŒæ ·å¯ä»¥è½»æ˜“ä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œä½† volumeCredits å˜é‡åˆ™æœ‰äº›æ£˜æ‰‹ã€‚å®ƒæ˜¯ä¸€ä¸ªç´¯åŠ å˜é‡ï¼Œå¾ªç¯çš„æ¯æ¬¡è¿­ä»£éƒ½ä¼šæ›´æ–°å®ƒçš„å€¼ã€‚å› æ­¤æœ€ç®€å•çš„æ–¹å¼æ˜¯ï¼Œå°†æ•´å—é€»è¾‘æç‚¼åˆ°æ–°å‡½æ•°ä¸­ï¼Œç„¶ååœ¨æ–°å‡½æ•°ä¸­ç›´æ¥è¿”å› volumeCreditsã€‚

#### function statement

```js
function volumeCreditsFor(perf) {
  let volumeCredits = 0;
  volumeCredits += Math.max(perf.audience - 30, 0);
  if ("comedy" === playFor(perf).type)
    volumeCredits += Math.floor(perf.audience / 5);
  return volumeCredits;
}
```

#### é¡¶å±‚ä½œç”¨åŸŸ

```js
function statement (invoice, plays) {
  let totalAmount = 0;
  let volumeCredits = 0;
  let result = `Statement for ${invoice.customer}\n`;
  const format = new Intl.NumberFormat("en-US",
                        { style: "currency", currency: "USD",
                          minimumFractionDigits: 2 }).format;
  for (let perf of invoice.performances) {
    volumeCredits += volumeCreditsFor(perf);

    // print line for this order
    result += ` ${playFor(perf).name}: ${format(amountFor(perf)/100)} (${perf.audience} seats)\n`;
    totalAmount += amountFor(perf);
  }
  result += `Amount owed is ${format(totalAmount/100)}\n`;
  result += `You earned ${volumeCredits} credits\n`;
  return result;
```

æˆ‘è¿˜é¡ºä¾¿åˆ é™¤äº†å¤šä½™ï¼ˆå¹¶ä¸”ä¼šå¼•èµ·è¯¯è§£ï¼‰çš„æ³¨é‡Šã€‚

ç¼–è¯‘ã€æµ‹è¯•ã€æäº¤ï¼Œç„¶åå¯¹æ–°å‡½æ•°é‡Œçš„å˜é‡æ”¹åã€‚

#### function statement

```js
function volumeCreditsFor(aPerformance) {
  let result = 0;
  result += Math.max(aPerformance.audience - 30, 0);
  if ("comedy" === playFor(aPerformance).type)
    result += Math.floor(aPerformance.audience / 5);
  return result;
}
```

è¿™é‡Œæˆ‘åªå±•ç¤ºäº†ä¸€æ­¥åˆ°ä½çš„æ”¹åç»“æœï¼Œä¸è¿‡å®é™…æ“ä½œæ—¶ï¼Œæˆ‘è¿˜æ˜¯ä¸€æ¬¡åªå°†ä¸€ä¸ªå˜é‡æ”¹åï¼Œå¹¶åœ¨æ¯æ¬¡æ”¹ååæ‰§è¡Œç¼–è¯‘ã€æµ‹è¯•ã€æäº¤ã€‚

### ç§»é™¤ format å˜é‡

æˆ‘ä»¬å†çœ‹ä¸€ä¸‹ statement è¿™ä¸ªä¸»å‡½æ•°ã€‚

#### é¡¶å±‚ä½œç”¨åŸŸ

```js
function statement (invoice, plays) {
  let totalAmount = 0;
  let volumeCredits = 0;
  let result = `Statement for ${invoice.customer}\n`;
  const format = new Intl.NumberFormat("en-US",
                        { style: "currency", currency: "USD",
                          minimumFractionDigits: 2 }).format;
  for (let perf of invoice.performances) {
    volumeCredits += volumeCreditsFor(perf);

    // print line for this order
    result += ` ${playFor(perf).name}: ${format(amountFor(perf)/100)} (${perf.audience} seats)\n`;
    totalAmount += amountFor(perf);
  }
  result += `Amount owed is ${format(totalAmount/100)}\n`;
  result += `You earned ${volumeCredits} credits\n`;
  return result;
```

æ­£å¦‚æˆ‘ä¸Šé¢æ‰€æŒ‡å‡ºçš„ï¼Œä¸´æ—¶å˜é‡å¾€å¾€ä¼šå¸¦æ¥éº»çƒ¦ã€‚å®ƒä»¬åªåœ¨å¯¹å…¶è¿›è¡Œå¤„ç†çš„ä»£ç å—ä¸­æœ‰ç”¨ï¼Œå› æ­¤ä¸´æ—¶å˜é‡å®è´¨ä¸Šæ˜¯é¼“åŠ±ä½ å†™é•¿è€Œå¤æ‚çš„å‡½æ•°ã€‚å› æ­¤ï¼Œä¸‹ä¸€æ­¥æˆ‘è¦æ›¿æ¢æ‰ä¸€äº›ä¸´æ—¶å˜é‡ï¼Œè€Œæœ€ç®€å•çš„è«è¿‡äºä» format å˜é‡å…¥æ‰‹ã€‚è¿™æ˜¯å…¸å‹çš„â€œå°†å‡½æ•°èµ‹å€¼ç»™ä¸´æ—¶å˜é‡â€çš„åœºæ™¯ï¼Œæˆ‘æ›´æ„¿æ„å°†å…¶æ›¿æ¢ä¸ºä¸€ä¸ªæ˜ç¡®å£°æ˜çš„å‡½æ•°ã€‚

#### function statement

```js
function format(aNumber) {
  return new Intl.NumberFormat("en-US", {
    style: "currency",
    currency: "USD",
    minimumFractionDigits: 2,
  }).format(aNumber);
}
```

#### é¡¶å±‚ä½œç”¨åŸŸ

```js
function statement (invoice, plays) {
  let totalAmount = 0;
  let volumeCredits = 0;
  let result = `Statement for ${invoice.customer}\n`;
  for (let perf of invoice.performances) {
    volumeCredits += volumeCreditsFor(perf);

    // print line for this order
    result += ` ${playFor(perf).name}: ${format(amountFor(perf)/100)} (${perf.audience} seats)\n`;
    totalAmount += amountFor(perf);
  }
  result += `Amount owed is ${format(totalAmount/100)}\n`;
  result += `You earned ${volumeCredits} credits\n`;
  return result;
```

::: tip
å°½ç®¡å°†å‡½æ•°å˜é‡æ”¹å˜æˆå‡½æ•°å£°æ˜ä¹Ÿæ˜¯ä¸€ç§é‡æ„æ‰‹æ³•ï¼Œä½†æˆ‘æ—¢æœªä¸ºæ­¤æ‰‹æ³•å‘½åï¼Œä¹Ÿæœªå°†å®ƒçº³å…¥é‡æ„åå½•ã€‚è¿˜æœ‰å¾ˆå¤šçš„é‡æ„æ‰‹æ³•æˆ‘éƒ½è§‰å¾—æ²¡é‚£ä¹ˆé‡è¦ã€‚æˆ‘è§‰å¾—ä¸Šé¢è¿™ä¸ªå‡½æ•°æ”¹åçš„æ‰‹æ³•æ—¢ååˆ†ç®€å•åˆä¸å¤ªå¸¸ç”¨ï¼Œä¸å€¼å¾—åœ¨é‡æ„åå½•ä¸­å æœ‰ä¸€å¸­ä¹‹åœ°ã€‚
:::

æˆ‘å¯¹æç‚¼å¾—åˆ°çš„å‡½æ•°åç§°ä¸å¾ˆæ»¡æ„â€”â€”format æœªèƒ½æ¸…æ™°åœ°æè¿°å…¶ä½œç”¨ã€‚formatAsUSD å¾ˆè¡¨æ„ï¼Œä½†åˆå¤ªé•¿ï¼Œç‰¹åˆ«å®ƒä»…æ˜¯å°èŒƒå›´åœ°è¢«ç”¨åœ¨ä¸€ä¸ªå­—ç¬¦ä¸²æ¨¡æ¿ä¸­ã€‚æˆ‘è®¤ä¸ºè¿™é‡ŒçœŸæ­£éœ€è¦å¼ºè°ƒçš„æ˜¯ï¼Œå®ƒæ ¼å¼åŒ–çš„æ˜¯ä¸€ä¸ªè´§å¸æ•°å­—ï¼Œå› æ­¤æˆ‘é€‰å–äº†ä¸€ä¸ªèƒ½ä½“ç°æ­¤æ„å›¾çš„å‘½åï¼Œå¹¶åº”ç”¨äº†æ”¹å˜å‡½æ•°å£°æ˜ï¼ˆ124ï¼‰æ‰‹æ³•ã€‚

#### é¡¶å±‚ä½œç”¨åŸŸ

```js
function statement (invoice, plays) {
  let totalAmount = 0;
  let volumeCredits = 0;
  let result = `Statement for ${invoice.customer}\n`;
  for (let perf of invoice.performances) {
    volumeCredits += volumeCreditsFor(perf);

    // print line for this order
    result += ` ${playFor(perf).name}: ${usd(amountFor(perf))} (${perf.audience} seats)\n`;
    totalAmount += amountFor(perf);
  }
  result += `Amount owed is ${usd(totalAmount)}\n`;
  result += `You earned ${volumeCredits} credits\n`;
  return result;
```

#### function statement

```js
function usd(aNumber) {
  return new Intl.NumberFormat("en-US", {
    style: "currency",
    currency: "USD",
    minimumFractionDigits: 2,
  }).format(aNumber / 100);
}
```

å¥½çš„å‘½åååˆ†é‡è¦ï¼Œä½†å¾€å¾€å¹¶éå”¾æ‰‹å¯å¾—ã€‚åªæœ‰æ°å¦‚å…¶åˆ†åœ°å‘½åï¼Œæ‰èƒ½å½°æ˜¾å‡ºå°†å¤§å‡½æ•°åˆ†è§£æˆå°å‡½æ•°çš„ä»·å€¼ã€‚æœ‰äº†å¥½çš„åç§°ï¼Œæˆ‘å°±ä¸å¿…é€šè¿‡é˜…è¯»å‡½æ•°ä½“æ¥äº†è§£å…¶è¡Œä¸ºã€‚ä½†è¦ä¸€æ¬¡æŠŠåå–å¥½å¹¶ä¸å®¹æ˜“ï¼Œå› æ­¤æˆ‘ä¼šä½¿ç”¨å½“ä¸‹èƒ½æƒ³åˆ°æœ€å¥½çš„é‚£ä¸ªã€‚å¦‚æœç¨åæƒ³åˆ°æ›´å¥½çš„ï¼Œæˆ‘å°±ä¼šæ¯«ä¸çŠ¹è±«åœ°æ¢æ‰å®ƒã€‚é€šå¸¸ä½ éœ€è¦èŠ±å‡ ç§’é’Ÿé€šè¯»æ›´å¤šä»£ç ï¼Œæ‰èƒ½å‘ç°æœ€å¥½çš„åç§°æ˜¯ä»€ä¹ˆã€‚

é‡å‘½åçš„åŒæ—¶ï¼Œæˆ‘è¿˜å°†é‡å¤çš„é™¤ä»¥ 100 çš„è¡Œä¸ºä¹Ÿæ¬ç§»åˆ°å‡½æ•°é‡Œã€‚å°†é’±ä»¥ç¾åˆ†ä¸ºå•ä½ä½œä¸ºæ­£æ•´æ•°å­˜å‚¨æ˜¯ä¸€ç§å¸¸è§çš„åšæ³•ï¼Œå¯ä»¥é¿å…ä½¿ç”¨æµ®ç‚¹æ•°æ¥å­˜å‚¨è´§å¸çš„å°æ•°éƒ¨åˆ†ï¼ŒåŒæ—¶åˆä¸å½±å“ç”¨æ•°å­¦è¿ç®—ç¬¦æ“ä½œå®ƒã€‚ä¸è¿‡ï¼Œå¯¹äºè¿™æ ·ä¸€ä¸ªä»¥ç¾åˆ†ä¸ºå•ä½çš„æ•´æ•°ï¼Œæˆ‘åˆéœ€è¦ä»¥ç¾å…ƒä¸ºå•ä½è¿›è¡Œå±•ç¤ºï¼Œå› æ­¤è®©æ ¼å¼åŒ–å‡½æ•°æ¥å¤„ç†æ•´é™¤çš„äº‹å®œå†å¥½ä¸è¿‡ã€‚

### ç§»é™¤è§‚ä¼—é‡ç§¯åˆ†æ€»å’Œ

æˆ‘çš„ä¸‹ä¸€ä¸ªé‡æ„ç›®æ ‡æ˜¯ volumeCreditsã€‚å¤„ç†è¿™ä¸ªå˜é‡æ›´åŠ å¾®å¦™ï¼Œå› ä¸ºå®ƒæ˜¯åœ¨å¾ªç¯çš„è¿­ä»£è¿‡ç¨‹ä¸­ç´¯åŠ å¾—åˆ°çš„ã€‚ç¬¬ä¸€æ­¥ï¼Œå°±æ˜¯åº”ç”¨æ‹†åˆ†å¾ªç¯ï¼ˆ227ï¼‰å°† volumeCredits çš„ç´¯åŠ è¿‡ç¨‹åˆ†ç¦»å‡ºæ¥ã€‚

#### é¡¶å±‚ä½œç”¨åŸŸ

```js
function statement (invoice, plays) {
  let totalAmount = 0;
  let volumeCredits = 0;
  let result = `Statement for ${invoice.customer}\n`;

  for (let perf of invoice.performances) {

    // print line for this order
    result += ` ${playFor(perf).name}: ${usd(amountFor(perf))} (${perf.audience} seats)\n`;
    totalAmount += amountFor(perf);
  }
  for (let perf of invoice.performances) {
    volumeCredits += volumeCreditsFor(perf);
  }

result += `Amount owed is ${usd(totalAmount)}\n`;
result += `You earned ${volumeCredits} credits\n`;
return result;
```

å®Œæˆè¿™ä¸€æ­¥ï¼Œæˆ‘å°±å¯ä»¥ä½¿ç”¨ç§»åŠ¨è¯­å¥ï¼ˆ223ï¼‰æ‰‹æ³•å°†å˜é‡å£°æ˜æŒªåŠ¨åˆ°ç´§é‚»å¾ªç¯çš„ä½ç½®ã€‚

top levelâ€¦â€¦

```js
function statement (invoice, plays) {
  let totalAmount = 0;
  let result = `Statement for ${invoice.customer}\n`;
  for (let perf of invoice.performances) {

    // print line for this order
    result += ` ${playFor(perf).name}: ${usd(amountFor(perf))} (${perf.audience} seats)\n`;
    totalAmount += amountFor(perf);
  }
  let volumeCredits = 0;
  for (let perf of invoice.performances) {
    volumeCredits += volumeCreditsFor(perf);
  }
  result += `Amount owed is ${usd(totalAmount)}\n`;
  result += `You earned ${volumeCredits} credits\n`;
  return result;
```

æŠŠä¸æ›´æ–° volumeCredits å˜é‡ç›¸å…³çš„ä»£ç éƒ½é›†ä¸­åˆ°ä¸€èµ·ï¼Œæœ‰åˆ©äºä»¥æŸ¥è¯¢å–ä»£ä¸´æ—¶å˜é‡ï¼ˆ178ï¼‰æ‰‹æ³•çš„æ–½å±•ã€‚ç¬¬ä¸€æ­¥åŒæ ·æ˜¯å…ˆå¯¹å˜é‡çš„è®¡ç®—è¿‡ç¨‹åº”ç”¨æç‚¼å‡½æ•°ï¼ˆ106ï¼‰æ‰‹æ³•ã€‚

#### function statement

```js
function totalVolumeCredits() {
  let volumeCredits = 0;
  for (let perf of invoice.performances) {
    volumeCredits += volumeCreditsFor(perf);
  }
  return volumeCredits;
}
```

#### é¡¶å±‚ä½œç”¨åŸŸ

```js
function statement (invoice, plays) {
  let totalAmount = 0;
  let result = `Statement for ${invoice.customer}\n`;
  for (let perf of invoice.performances) {

    // print line for this order
    result += ` ${playFor(perf).name}: ${usd(amountFor(perf))} (${perf.audience} seats)\n`;
    totalAmount += amountFor(perf);
  }
  let volumeCredits = totalVolumeCredits();
  result += `Amount owed is ${usd(totalAmount)}\n`;
  result += `You earned ${volumeCredits} credits\n`;
  return result;
```

å®Œæˆå‡½æ•°æç‚¼åï¼Œæˆ‘å†åº”ç”¨å†…è”å˜é‡ï¼ˆ123ï¼‰æ‰‹æ³•å†…è” totalVolumeCredits å‡½æ•°ã€‚

#### é¡¶å±‚ä½œç”¨åŸŸ

```js
function statement (invoice, plays) {
  let totalAmount = 0;
  let result = `Statement for ${invoice.customer}\n`;
  for (let perf of invoice.performances) {

    // print line for this order
    result += ` ${playFor(perf).name}: ${usd(amountFor(perf))} (${perf.audience} seats)\n`;
    totalAmount += amountFor(perf);
  }

  result += `Amount owed is ${usd(totalAmount)}\n`;
  result += `You earned ${totalVolumeCredits()} credits\n`;
  return result;
```

é‡æ„è‡³æ­¤ï¼Œè®©æˆ‘å…ˆæš‚åœä¸€ä¸‹ï¼Œè°ˆè°ˆåˆšåˆšå®Œæˆçš„ä¿®æ”¹ã€‚é¦–å…ˆï¼Œæˆ‘çŸ¥é“æœ‰äº›è¯»è€…ä¼šå†æ¬¡å¯¹æ­¤ä¿®æ”¹å¯èƒ½å¸¦æ¥çš„æ€§èƒ½é—®é¢˜æ„Ÿåˆ°æ‹…å¿§ï¼Œæˆ‘çŸ¥é“å¾ˆå¤šäººæœ¬èƒ½åœ°è­¦æƒ•é‡å¤çš„å¾ªç¯ã€‚ä½†å¤§å¤šæ•°æ—¶å€™ï¼Œé‡å¤ä¸€æ¬¡è¿™æ ·çš„å¾ªç¯å¯¹æ€§èƒ½çš„å½±å“éƒ½å¯å¿½ç•¥ä¸è®¡ã€‚å¦‚æœä½ åœ¨é‡æ„å‰åè¿›è¡Œè®¡æ—¶ï¼Œå¾ˆå¯èƒ½ç”šè‡³éƒ½æ³¨æ„ä¸åˆ°è¿è¡Œé€Ÿåº¦çš„å˜åŒ–â€”â€”é€šå¸¸ä¹Ÿç¡®å®æ²¡ä»€ä¹ˆå˜åŒ–ã€‚è®¸å¤šç¨‹åºå‘˜å¯¹ä»£ç å®é™…çš„è¿è¡Œè·¯å¾„éƒ½æ‰€çŸ¥ä¸è¶³ï¼Œç”šè‡³ç»éªŒä¸°å¯Œçš„ç¨‹åºå‘˜æœ‰æ—¶ä¹Ÿæœªèƒ½é¿å…ã€‚åœ¨èªæ˜çš„ç¼–è¯‘å™¨ã€ç°ä»£çš„ç¼“å­˜æŠ€æœ¯é¢å‰ï¼Œæˆ‘ä»¬å¾ˆå¤šç›´è§‰éƒ½æ˜¯ä¸å‡†ç¡®çš„ã€‚è½¯ä»¶çš„æ€§èƒ½é€šå¸¸åªä¸ä»£ç çš„ä¸€å°éƒ¨åˆ†ç›¸å…³ï¼Œæ”¹å˜å…¶ä»–çš„éƒ¨åˆ†å¾€å¾€å¯¹æ€»ä½“æ€§èƒ½è´¡çŒ®ç”šå¾®ã€‚

å½“ç„¶ï¼Œâ€œå¤§å¤šæ•°æ—¶å€™â€ä¸ç­‰åŒäºâ€œæ‰€æœ‰æ—¶å€™â€ã€‚æœ‰æ—¶ï¼Œä¸€äº›é‡æ„æ‰‹æ³•ä¹Ÿä¼šæ˜¾è‘—åœ°å½±å“æ€§èƒ½ã€‚ä½†å³ä¾¿å¦‚æ­¤ï¼Œæˆ‘é€šå¸¸ä¹Ÿä¸å»ç®¡å®ƒï¼Œç»§ç»­é‡æ„ï¼Œå› ä¸ºæœ‰äº†ä¸€ä»½ç»“æ„è‰¯å¥½çš„ä»£ç ï¼Œå›å¤´è°ƒä¼˜å…¶æ€§èƒ½ä¹Ÿå®¹æ˜“å¾—å¤šã€‚å¦‚æœæˆ‘åœ¨é‡æ„æ—¶å¼•å…¥äº†æ˜æ˜¾çš„æ€§èƒ½æŸè€—ï¼Œæˆ‘åé¢ä¼šèŠ±æ—¶é—´è¿›è¡Œæ€§èƒ½è°ƒä¼˜ã€‚è¿›è¡Œè°ƒä¼˜æ—¶ï¼Œå¯èƒ½ä¼šå›é€€æˆ‘æ—©å…ˆåšçš„ä¸€äº›é‡æ„â€”â€”ä½†æ›´å¤šæ—¶å€™ï¼Œå› ä¸ºé‡æ„æˆ‘å¯ä»¥ä½¿ç”¨æ›´é«˜æ•ˆçš„è°ƒä¼˜æ–¹æ¡ˆã€‚æœ€åæˆ‘å¾—åˆ°çš„æ˜¯æ—¢æ•´æ´åˆé«˜æ•ˆçš„ä»£ç ã€‚

å› æ­¤å¯¹äºé‡æ„è¿‡ç¨‹çš„æ€§èƒ½é—®é¢˜ï¼Œæˆ‘æ€»ä½“çš„å»ºè®®æ˜¯ï¼šå¤§å¤šæ•°æƒ…å†µä¸‹å¯ä»¥å¿½ç•¥å®ƒã€‚å¦‚æœé‡æ„å¼•å…¥äº†æ€§èƒ½æŸè€—ï¼Œå…ˆå®Œæˆé‡æ„ï¼Œå†åšæ€§èƒ½ä¼˜åŒ–ã€‚

å…¶æ¬¡ï¼Œæˆ‘å¸Œæœ›ä½ èƒ½æ³¨æ„åˆ°ï¼šæˆ‘ä»¬ç§»é™¤ volumeCredits çš„è¿‡ç¨‹æ˜¯å¤šä¹ˆå°æ­¥ã€‚æ•´ä¸ªè¿‡ç¨‹ä¸€å…±æœ‰ 4 æ­¥ï¼Œæ¯ä¸€æ­¥éƒ½ä¼´éšç€ä¸€æ¬¡ç¼–è¯‘ã€æµ‹è¯•ä»¥åŠå‘æœ¬åœ°ä»£ç åº“çš„æäº¤ï¼š

- ä½¿ç”¨æ‹†åˆ†å¾ªç¯ï¼ˆ227ï¼‰åˆ†ç¦»å‡ºç´¯åŠ è¿‡ç¨‹ï¼›
- ä½¿ç”¨ç§»åŠ¨è¯­å¥ï¼ˆ223ï¼‰å°†ç´¯åŠ å˜é‡çš„å£°æ˜ä¸ç´¯åŠ è¿‡ç¨‹é›†ä¸­åˆ°ä¸€èµ·ï¼›
- ä½¿ç”¨æç‚¼å‡½æ•°ï¼ˆ106ï¼‰æç‚¼å‡ºè®¡ç®—æ€»æ•°çš„å‡½æ•°ï¼›
- ä½¿ç”¨å†…è”å˜é‡ï¼ˆ123ï¼‰å®Œå…¨ç§»é™¤ä¸­é—´å˜é‡ã€‚

æˆ‘å¾—å¦ç™½ï¼Œæˆ‘å¹¶éæ€»æ˜¯å¦‚æ­¤å°æ­¥â€”â€”ä½†åœ¨äº‹æƒ…å˜å¤æ‚æ—¶ï¼Œæˆ‘çš„ç¬¬ä¸€ååº”å°±æ˜¯é‡‡ç”¨æ›´å°çš„æ­¥å­ã€‚æ€æ ·ç®—å˜å¤æ‚å‘¢ï¼Œå°±æ˜¯å½“é‡æ„è¿‡ç¨‹æœ‰æµ‹è¯•å¤±è´¥è€Œæˆ‘åˆæ— æ³•é©¬ä¸Šçœ‹æ¸…é—®é¢˜æ‰€åœ¨å¹¶ç«‹å³ä¿®å¤æ—¶ï¼Œæˆ‘å°±ä¼šå›æ»šåˆ°æœ€åä¸€æ¬¡å¯å·¥ä½œçš„æäº¤ï¼Œç„¶åä»¥æ›´å°çš„æ­¥å­é‡åšã€‚è¿™å¾—ç›Šäºæˆ‘å¦‚æ­¤é¢‘ç¹åœ°æäº¤ã€‚ç‰¹åˆ«æ˜¯ä¸å¤æ‚ä»£ç æ‰“äº¤é“æ—¶ï¼Œç»†å°çš„æ­¥å­æ˜¯å¿«é€Ÿå‰è¿›çš„å…³é”®ã€‚

æ¥ç€æˆ‘è¦é‡å¤åŒæ ·çš„æ­¥éª¤æ¥ç§»é™¤ totalAmountã€‚æˆ‘ä»¥æ‹†è§£å¾ªç¯å¼€å§‹ï¼ˆç¼–è¯‘ã€æµ‹è¯•ã€æäº¤ï¼‰ï¼Œç„¶åä¸‹ç§»ç´¯åŠ å˜é‡çš„å£°æ˜è¯­å¥ï¼ˆç¼–è¯‘ã€æµ‹è¯•ã€æäº¤ï¼‰ï¼Œæœ€åå†æç‚¼å‡½æ•°ã€‚è¿™é‡Œä»¤æˆ‘æœ‰ç‚¹å¤´ç–¼çš„æ˜¯ï¼šæœ€å¥½çš„å‡½æ•°ååº”è¯¥æ˜¯ totalAmountï¼Œä½†å®ƒå·²ç»è¢«å˜é‡åå ç”¨ï¼Œæˆ‘æ— æ³•èµ·ä¸¤ä¸ªåŒæ ·çš„åå­—ã€‚å› æ­¤ï¼Œæˆ‘åœ¨æç‚¼å‡½æ•°æ—¶å…ˆç»™å®ƒéšä¾¿å–äº†ä¸€ä¸ªåå­—ï¼ˆç„¶åç¼–è¯‘ã€æµ‹è¯•ã€æäº¤ï¼‰ã€‚

#### function statement

```js
function appleSauce() {
  let totalAmount = 0;
  for (let perf of invoice.performances) {
    totalAmount += amountFor(perf);
  }
  return totalAmount;
}
```

#### é¡¶å±‚ä½œç”¨åŸŸ

```js
function statement (invoice, plays) {
  let result = `Statement for ${invoice.customer}\n`;
  for (let perf of invoice.performances) {
    result += ` ${playFor(perf).name}: ${usd(amountFor(perf))} (${perf.audience} seats)\n`;
  }
  let totalAmount = appleSauce();

  result += `Amount owed is ${usd(totalAmount)}\n`;
  result += `You earned ${totalVolumeCredits()} credits\n`;
  return result;
```

æ¥ç€æˆ‘å°†å˜é‡å†…è”ï¼ˆç¼–è¯‘ã€æµ‹è¯•ã€æäº¤ï¼‰ï¼Œç„¶åå°†å‡½æ•°åæ”¹å› totalAmountï¼ˆç¼–è¯‘ã€æµ‹è¯•ã€æäº¤ï¼‰ã€‚

#### é¡¶å±‚ä½œç”¨åŸŸ

```js
function statement (invoice, plays) {
  let result = `Statement for ${invoice.customer}\n`;
  for (let perf of invoice.performances) {
    result += ` ${playFor(perf).name}: ${usd(amountFor(perf))} (${perf.audience} seats)\n`;
  }
  result += `Amount owed is ${usd(totalAmount())}\n`;
  result += `You earned ${totalVolumeCredits()} credits\n`;
  return result;
```

#### function statement

```js
function totalAmount() {
  let totalAmount = 0;
  for (let perf of invoice.performances) {
    totalAmount += amountFor(perf);
  }
  return totalAmount;
}
```

è¶ç€ç»™æ–°æç‚¼çš„å‡½æ•°æ”¹åçš„æœºä¼šï¼Œæˆ‘é¡ºæ‰‹ä¸€å¹¶ä¿®æ”¹äº†å‡½æ•°å†…éƒ¨çš„å˜é‡åï¼Œä»¥ä¾¿ä¿æŒæˆ‘ä¸€è´¯çš„ç¼–ç é£æ ¼ã€‚

#### function statement

```js
function totalAmount() {
  let result = 0;
  for (let perf of invoice.performances) {
    result += amountFor(perf);
  }
  return result;
}
function totalVolumeCredits() {
  let result = 0;
  for (let perf of invoice.performances) {
    result += volumeCreditsFor(perf);
  }
  return result;
}
```

## 1.5 è¿›å±•ï¼šå¤§é‡åµŒå¥—å‡½æ•°

é‡æ„è‡³æ­¤ï¼Œæ˜¯æ—¶å€™åœä¸‹æ¥æ¬£èµä¸€ä¸‹ä»£ç çš„å…¨è²Œäº†ã€‚

```js
function statement (invoice, plays) {
  let result = `Statement for ${invoice.customer}\n`;
  for (let perf of invoice.performances) {
    result += ` ${playFor(perf).name}: ${usd(amountFor(perf))} (${perf.audience} seats)\n`;
  }
  result += `Amount owed is ${usd(totalAmount())}\n`;
  result += `You earned ${totalVolumeCredits()} credits\n`;
  return result;

  function totalAmount() {
    let result = 0;
    for (let perf of invoice.performances) {
      result += amountFor(perf);
    }
    return result;
  }
  function totalVolumeCredits() {
    let result = 0;
    for (let perf of invoice.performances) {
      result += volumeCreditsFor(perf);
    }
    return result;
  }
  function usd(aNumber) {
    return new Intl.NumberFormat("en-US",
                        { style: "currency", currency: "USD",
                          minimumFractionDigits: 2 }).format(aNumber/100);
  }
  function volumeCreditsFor(aPerformance) {
    let result = 0;
    result += Math.max(aPerformance.audience - 30, 0);
    if ("comedy" === playFor(aPerformance).type) result += Math.floor(aPerformance.audience / 5);
    return result;
  }
  function playFor(aPerformance) {
    return plays[aPerformance.playID];
  }
  function amountFor(aPerformance) {
    let result = 0;
    switch (playFor(aPerformance).type) {
    case "tragedy":
      result = 40000;
      if (aPerformance.audience &gt; 30) {
        result += 1000 * (aPerformance.audience - 30);
      }
      break;
    case "comedy":
      result = 30000;
      if (aPerformance.audience &gt; 20) {
        result += 10000 + 500 * (aPerformance.audience - 20);
      }
      result += 300 * aPerformance.audience;
      break;
    default:
      throw new Error(`unknown type: ${playFor(aPerformance).type}`);
    }
    return result;
  }
}
```

ç°åœ¨ä»£ç ç»“æ„å·²ç»å¥½å¤šäº†ã€‚é¡¶å±‚çš„ statement å‡½æ•°ç°åœ¨åªå‰© 7 è¡Œä»£ç ï¼Œè€Œä¸”å®ƒå¤„ç†çš„éƒ½æ˜¯ä¸æ‰“å°è¯¦å•ç›¸å…³çš„é€»è¾‘ã€‚ä¸è®¡ç®—ç›¸å…³çš„é€»è¾‘ä»ä¸»å‡½æ•°ä¸­è¢«ç§»èµ°ï¼Œæ”¹ç”±ä¸€ç»„å‡½æ•°æ¥æ”¯æŒã€‚æ¯ä¸ªå•ç‹¬çš„è®¡ç®—è¿‡ç¨‹å’Œè¯¦å•çš„æ•´ä½“ç»“æ„ï¼Œéƒ½å› æ­¤å˜å¾—æ›´æ˜“ç†è§£äº†ã€‚

## 1.6 æ‹†åˆ†è®¡ç®—é˜¶æ®µä¸æ ¼å¼åŒ–é˜¶æ®µ

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘çš„é‡æ„ä¸»è¦æ˜¯ä¸ºåŸå‡½æ•°æ·»åŠ è¶³å¤Ÿçš„ç»“æ„ï¼Œä»¥ä¾¿æˆ‘èƒ½æ›´å¥½åœ°ç†è§£å®ƒï¼Œçœ‹æ¸…å®ƒçš„é€»è¾‘ç»“æ„ã€‚è¿™ä¹Ÿæ˜¯é‡æ„æ—©æœŸçš„ä¸€èˆ¬æ­¥éª¤ã€‚æŠŠå¤æ‚çš„ä»£ç å—åˆ†è§£ä¸ºæ›´å°çš„å•å…ƒï¼Œä¸å¥½çš„å‘½åä¸€æ ·éƒ½å¾ˆé‡è¦ã€‚ç°åœ¨ï¼Œæˆ‘å¯ä»¥æ›´å¤šå…³æ³¨æˆ‘è¦ä¿®æ”¹çš„åŠŸèƒ½éƒ¨åˆ†äº†ï¼Œä¹Ÿå°±æ˜¯ä¸ºè¿™å¼ è¯¦å•æä¾›ä¸€ä¸ª HTML ç‰ˆæœ¬ã€‚ä¸ç®¡æ€ä¹ˆè¯´ï¼Œç°åœ¨æ”¹èµ·æ¥æ›´åŠ ç®€å•äº†ã€‚å› ä¸ºè®¡ç®—ä»£ç å·²ç»è¢«åˆ†ç¦»å‡ºæ¥ï¼Œæˆ‘åªéœ€è¦ä¸ºé¡¶éƒ¨çš„ 7 è¡Œä»£ç å®ç°ä¸€ä¸ª HTML çš„ç‰ˆæœ¬ã€‚é—®é¢˜æ˜¯ï¼Œè¿™äº›åˆ†è§£å‡ºæ¥çš„å‡½æ•°åµŒå¥—åœ¨æ‰“å°æ–‡æœ¬è¯¦å•çš„å‡½æ•°ä¸­ã€‚æ— è®ºåµŒå¥—å‡½æ•°ç»„ç»‡å¾—å¤šä¹ˆè‰¯å¥½ï¼Œæˆ‘æ€»ä¸æƒ³å°†å®ƒä»¬å…¨å¤åˆ¶ç²˜è´´åˆ°å¦ä¸€ä¸ªæ–°å‡½æ•°ä¸­ã€‚æˆ‘å¸Œæœ›åŒæ ·çš„è®¡ç®—å‡½æ•°å¯ä»¥è¢«æ–‡æœ¬ç‰ˆè¯¦å•å’Œ HTML ç‰ˆè¯¦å•å…±ç”¨ã€‚

è¦å®ç°å¤ç”¨æœ‰è®¸å¤šç§æ–¹æ³•ï¼Œè€Œæˆ‘æœ€å–œæ¬¢çš„æŠ€æœ¯æ˜¯æ‹†åˆ†é˜¶æ®µï¼ˆ154ï¼‰ã€‚è¿™é‡Œæˆ‘çš„ç›®æ ‡æ˜¯å°†é€»è¾‘åˆ†æˆä¸¤éƒ¨åˆ†ï¼šä¸€éƒ¨åˆ†è®¡ç®—è¯¦å•æ‰€éœ€çš„æ•°æ®ï¼Œå¦ä¸€éƒ¨åˆ†å°†æ•°æ®æ¸²æŸ“æˆæ–‡æœ¬æˆ– HTMLã€‚ç¬¬ä¸€é˜¶æ®µä¼šåˆ›å»ºä¸€ä¸ªä¸­è½¬æ•°æ®ç»“æ„ï¼Œå†æŠŠå®ƒä¼ é€’ç»™ç¬¬äºŒé˜¶æ®µã€‚

è¦å¼€å§‹æ‹†åˆ†é˜¶æ®µï¼ˆ154ï¼‰ï¼Œæˆ‘ä¼šå…ˆå¯¹ç»„æˆç¬¬äºŒé˜¶æ®µçš„ä»£ç åº”ç”¨æç‚¼å‡½æ•°ï¼ˆ106ï¼‰ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œè¿™éƒ¨åˆ†ä»£ç å°±æ˜¯æ‰“å°è¯¦å•çš„ä»£ç ï¼Œå…¶å®ä¹Ÿå°±æ˜¯ statement å‡½æ•°çš„å…¨éƒ¨å†…å®¹ã€‚æˆ‘è¦æŠŠå®ƒä»¬ä¸æ‰€æœ‰åµŒå¥—çš„å‡½æ•°ä¸€èµ·æŠ½å–åˆ°ä¸€ä¸ªæ–°çš„é¡¶å±‚å‡½æ•°ä¸­ï¼Œå¹¶å°†å…¶å‘½åä¸º renderPlainTextã€‚

```js
function statement (invoice, plays) {
  return renderPlainText(invoice, plays);
}

function renderPlainText(invoice, plays) {
  let result = `Statement for ${invoice.customer}\n`;
  for (let perf of invoice.performances) {
    result += ` ${playFor(perf).name}: ${usd(amountFor(perf))} (${perf.audience} seats)\n`;
  }
  result += `Amount owed is ${usd(totalAmount())}\n`;
  result += `You earned ${totalVolumeCredits()} credits\n`;
  return result;

function totalAmount() {...}
  function totalVolumeCredits() {...}
  function usd(aNumber) {...}
  function volumeCreditsFor(aPerformance) {...}
  function playFor(aPerformance) {...}
  function amountFor(aPerformance) {...}
```

ç¼–è¯‘ã€æµ‹è¯•ã€æäº¤ï¼Œæ¥ç€åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œä½œä¸ºåœ¨ä¸¤ä¸ªé˜¶æ®µé—´ä¼ é€’çš„ä¸­è½¬æ•°æ®ç»“æ„ï¼Œç„¶åå°†å®ƒä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’ç»™ renderPlainTextï¼ˆç„¶åç¼–è¯‘ã€æµ‹è¯•ã€æäº¤ï¼‰ã€‚

```js
function statement (invoice, plays) {
  const statementData = {};
  return renderPlainText(statementData, invoice, plays);
}

function renderPlainText(data, invoice, plays) {
  let result = `Statement for ${invoice.customer}\n`;
  for (let perf of invoice.performances) {
    result += ` ${playFor(perf).name}: ${usd(amountFor(perf))} (${perf.audience} seats)\n`;
  }
  result += `Amount owed is ${usd(totalAmount())}\n`;
  result += `You earned ${totalVolumeCredits()} credits\n`;
  return result;

function totalAmount() {...}
  function totalVolumeCredits() {...}
  function usd(aNumber) {...}
  function volumeCreditsFor(aPerformance) {...}
  function playFor(aPerformance) {...}
  function amountFor(aPerformance) {...}
```

ç°åœ¨æˆ‘è¦æ£€æŸ¥ä¸€ä¸‹ renderPlainText ç”¨åˆ°çš„å…¶ä»–å‚æ•°ã€‚æˆ‘å¸Œæœ›å°†å®ƒä»¬æŒªåˆ°è¿™ä¸ªä¸­è½¬æ•°æ®ç»“æ„é‡Œï¼Œè¿™æ ·æ‰€æœ‰è®¡ç®—ä»£ç éƒ½å¯ä»¥è¢«æŒªåˆ° statement å‡½æ•°ä¸­ï¼Œè®© renderPlainText åªæ“ä½œé€šè¿‡ data å‚æ•°ä¼ è¿›æ¥çš„æ•°æ®ã€‚

ç¬¬ä¸€æ­¥æ˜¯å°†é¡¾å®¢ï¼ˆcustomerï¼‰å­—æ®µæ·»åŠ åˆ°ä¸­è½¬å¯¹è±¡é‡Œï¼ˆç¼–è¯‘ã€æµ‹è¯•ã€æäº¤ï¼‰ã€‚

```js
function statement (invoice, plays) {
  const statementData = {};
  statementData.customer = invoice.customer;
  return renderPlainText(statementData, invoice, plays);
}

function renderPlainText(data, invoice, plays) {
  let result = `Statement for ${data.customer}\n`;
  for (let perf of invoice.performances) {
    result += ` ${playFor(perf).name}: ${usd(amountFor(perf))} (${perf.audience} seats)\n`;
  }
  result += `Amount owed is ${usd(totalAmount())}\n`;
  result += `You earned ${totalVolumeCredits()} credits\n`;
  return result;
```

æˆ‘å°† performances å­—æ®µä¹Ÿæ¬ç§»è¿‡å»ï¼Œè¿™æ ·æˆ‘å°±å¯ä»¥ç§»é™¤æ‰ renderPlainText çš„ invoice å‚æ•°ï¼ˆç¼–è¯‘ã€æµ‹è¯•ã€æäº¤ï¼‰ã€‚

#### é¡¶å±‚ä½œç”¨åŸŸ

```js
function statement (invoice, plays) {
  const statementData = {};
  statementData.customer = invoice.customer;
  statementData.performances = invoice.performances;
  return renderPlainText(statementData,  invoice,  plays);
}

function renderPlainText(data, plays) {
  let result = `Statement for ${data.customer}\n`;
  for (let perf of data.performances) {
    result += ` ${playFor(perf).name}: ${usd(amountFor(perf))} (${perf.audience} seats)\n`;
  }
  result += `Amount owed is ${usd(totalAmount())}\n`;
  result += `You earned ${totalVolumeCredits()} credits\n`;
  return result;
```

#### function renderPlainText

```js
function totalAmount() {
  let result = 0;
  for (let perf of data.performances) {
    result += amountFor(perf);
  }
  return result;
}
function totalVolumeCredits() {
  let result = 0;
  for (let perf of data.performances) {
    result += volumeCreditsFor(perf);
  }
  return result;
}
```

ç°åœ¨ï¼Œæˆ‘å¸Œæœ›â€œå‰§ç›®åç§°â€ä¿¡æ¯ä¹Ÿä»ä¸­è½¬æ•°æ®ä¸­è·å¾—ã€‚ä¸ºæ­¤ï¼Œéœ€è¦ä½¿ç”¨ play ä¸­çš„æ•°æ®å¡«å…… aPerformance å¯¹è±¡ï¼ˆè®°å¾—ç¼–è¯‘ã€æµ‹è¯•ã€æäº¤ï¼‰ã€‚

```js
function statement (invoice, plays) {
  const statementData = {};
  statementData.customer = invoice.customer;
  statementData.performances = invoice.performances.map(enrichPerformance);
  return renderPlainText(statementData, plays);

  function enrichPerformance(aPerformance) {
    const result = Object.assign({}, aPerformance);
    return result;
}
```

ç°åœ¨æˆ‘åªæ˜¯ç®€å•åœ°è¿”å›äº†ä¸€ä¸ª aPerformance å¯¹è±¡çš„å‰¯æœ¬ï¼Œä½†é©¬ä¸Šæˆ‘å°±ä¼šå¾€è¿™æ¡è®°å½•ä¸­æ·»åŠ æ–°çš„æ•°æ®ã€‚è¿”å›å‰¯æœ¬çš„åŸå› æ˜¯ï¼Œæˆ‘ä¸æƒ³ä¿®æ”¹ä¼ ç»™å‡½æ•°çš„å‚æ•°ï¼Œæˆ‘æ€»æ˜¯å°½é‡ä¿æŒæ•°æ®ä¸å¯å˜ï¼ˆimmutableï¼‰â€”â€”å¯å˜çš„çŠ¶æ€ä¼šå¾ˆå¿«å˜æˆçƒ«æ‰‹çš„å±±èŠ‹ã€‚

::: tip
åœ¨ä¸ç†Ÿæ‚‰ JavaScript çš„äººçœ‹æ¥ï¼Œresult = Object.assign({}, aPerformance)çš„å†™æ³•å¯èƒ½ååˆ†å¥‡æ€ªã€‚å®ƒè¿”å›çš„æ˜¯ä¸€ä¸ªæµ…å‰¯æœ¬ã€‚è™½ç„¶æˆ‘æ›´å¸Œæœ›æœ‰ä¸ªå‡½æ•°æ¥å®Œæˆæ­¤åŠŸèƒ½ï¼Œä½†è¿™ä¸ªç”¨æ³•å·²ç»çº¦å®šä¿—æˆï¼Œå¦‚æœæˆ‘è‡ªå·±å†™ä¸ªå‡½æ•°ï¼Œåœ¨ JavaScript ç¨‹åºå‘˜çœ‹æ¥åè€Œä¼šæ ¼æ ¼ä¸å…¥ã€‚
::ï¼š

ç°åœ¨æˆ‘ä»¬å·²ç»æœ‰äº†å®‰æ”¾ play å­—æ®µçš„åœ°æ–¹ï¼Œå¯ä»¥æŠŠæ•°æ®æ”¾è¿›å»ã€‚æˆ‘éœ€è¦å¯¹ playFor å’Œ statement å‡½æ•°åº”ç”¨æ¬ç§»å‡½æ•°ï¼ˆ198ï¼‰ï¼ˆç„¶åç¼–è¯‘ã€æµ‹è¯•ã€æäº¤ï¼‰ã€‚

#### function statement

```js
function enrichPerformance(aPerformance) {
  const result = Object.assign({}, aPerformance);
  result.play = playFor(result);
  return result;
}

function playFor(aPerformance) {
  return plays[aPerformance.playID];
}
```

ç„¶åæ›¿æ¢ renderPlainText ä¸­å¯¹ playFor çš„æ‰€æœ‰å¼•ç”¨ç‚¹ï¼Œè®©å®ƒä»¬ä½¿ç”¨æ–°æ•°æ®ï¼ˆç¼–è¯‘ã€æµ‹è¯•ã€æäº¤ï¼‰ã€‚

#### function renderPlainText

```js
  let result = `Statement for ${data.customer}\n`;
for (let perf of data.performances) {
  result += ` ${perf.play.name}: ${usd(amountFor(perf))} (${perf.audience} seats)\n`;
}
result += `Amount owed is ${usd(totalAmount())}\n`;
result += `You earned ${totalVolumeCredits()} credits\n`;
return result;

function volumeCreditsFor(aPerformance) {
  let result = 0;
  result += Math.max(aPerformance.audience - 30, 0);
  if ("comedy" === aPerformance.play.type) result += Math.floor(aPerformance.audience / 5);
  return result;
}

functionamountFor(aPerformance){
  let result = 0;
  switch (aPerformance.play.type) {
  case "tragedy":
    result = 40000;
    if (aPerformance.audience &gt; 30) {
      result += 1000 * (aPerformance.audience - 30);
    }
    break;
  case "comedy":
    result = 30000;
    if (aPerformance.audience &gt; 20) {
      result += 10000 + 500 * (aPerformance.audience - 20);
    }
    result += 300 * aPerformance.audience;
    break;
  default:
    throw new Error(`unknown type: ${aPerformance.play.type}`);
  }
  return result;
}
```

æ¥ç€æˆ‘ä½¿ç”¨ç±»ä¼¼çš„æ‰‹æ³•æ¬ç§» amountFor å‡½æ•°ï¼ˆç¼–è¯‘ã€æµ‹è¯•ã€æäº¤ï¼‰ã€‚

#### function statement

```js
function enrichPerformance(aPerformance) {
  const result = Object.assign({}, aPerformance);
  result.play = playFor(result);
  result.amount = amountFor(result);
  return result;
}

function amountFor(aPerformance) {...}
```

#### function renderPlainText

```js
let result = `Statement for ${data.customer}\n`;
for (let perf of data.performances) {
  result += ` ${perf.play.name}: ${usd(perf.amount)} (${
    perf.audience
  } seats)\n`;
}
result += `Amount owed is ${usd(totalAmount())}\n`;
result += `You earned ${totalVolumeCredits()} credits\n`;
return result;

function totalAmount() {
  let result = 0;
  for (let perf of data.performances) {
    result += perf.amount;
  }
  return result;
}
```

æ¥ä¸‹æ¥æ¬ç§»è§‚ä¼—é‡ç§¯åˆ†çš„è®¡ç®—ï¼ˆç¼–è¯‘ã€æµ‹è¯•ã€æäº¤ï¼‰ã€‚

#### function statement

```js
function enrichPerformance(aPerformance) {
  const result = Object.assign({}, aPerformance);
  result.play = playFor(result);
  result.amount = amountFor(result);
  result.volumeCredits = volumeCreditsFor(result);
  return result;
}

function volumeCreditsFor(aPerformance) {...}
```

#### function renderPlainText

```js
function totalVolumeCredits() {
  let result = 0;
  for (let perf of data.performances) {
    result += perf.volumeCredits;
  }
  return result;
}
```

æœ€åï¼Œæˆ‘å°†ä¸¤ä¸ªè®¡ç®—æ€»æ•°çš„å‡½æ•°æ¬ç§»åˆ° statement å‡½æ•°ä¸­ã€‚

#### function statement

```js
  const statementData = {};
statementData.customer = invoice.customer;
statementData.performances = invoice.performances.map(enrichPerformance);
statementData.totalAmount = totalAmount(statementData);
statementData.totalVolumeCredits = totalVolumeCredits(statementData);
return renderPlainText(statementData, plays);

 function totalAmount(data) {...}
   function totalVolumeCredits(data) {...}
```

#### function renderPlainText

```js
let result = `Statement for ${data.customer}\n`;
for (let perf of data.performances) {
  result += ` ${perf.play.name}: ${usd(perf.amount)} (${
    perf.audience
  } seats)\n`;
}
result += `Amount owed is ${usd(data.totalAmount)}\n`;
result += `You earned ${data.totalVolumeCredits} credits\n`;
return result;
```

å°½ç®¡æˆ‘å¯ä»¥ä¿®æ”¹å‡½æ•°ä½“ï¼Œè®©è¿™äº›è®¡ç®—æ€»æ•°çš„å‡½æ•°ç›´æ¥ä½¿ç”¨ statementData å˜é‡ï¼ˆåæ­£å®ƒåœ¨ä½œç”¨åŸŸå†…ï¼‰ï¼Œä½†æˆ‘æ›´å–œæ¬¢æ˜¾å¼åœ°ä¼ å…¥å‡½æ•°å‚æ•°ã€‚

ç­‰åˆ°æ¬ç§»å®Œæˆï¼Œç¼–è¯‘ã€æµ‹è¯•ã€æäº¤ä¹Ÿåšå®Œï¼Œæˆ‘ä¾¿å¿ä¸ä½ä»¥ç®¡é“å–ä»£å¾ªç¯ï¼ˆ231ï¼‰å¯¹å‡ ä¸ªåœ°æ–¹è¿›è¡Œé‡æ„ã€‚

#### function renderPlainText

```js
  function totalAmount(data) {
  return data.performances
    .reduce((total, p) =&gt; total + p.amount, 0);
}
function totalVolumeCredits(data) {
  return data.performances
    .reduce((total, p) =&gt; total + p.volumeCredits, 0);
}
```

ç°åœ¨æˆ‘å¯ä»¥æŠŠç¬¬ä¸€é˜¶æ®µçš„ä»£ç æç‚¼åˆ°ä¸€ä¸ªç‹¬ç«‹çš„å‡½æ•°é‡Œäº†ï¼ˆç¼–è¯‘ã€æµ‹è¯•ã€æäº¤ï¼‰ã€‚

#### é¡¶å±‚ä½œç”¨åŸŸ

```js
  function statement (invoice, plays) {
  return renderPlainText(createStatementData(invoice, plays));
}

function createStatementData(invoice, plays) {
  const statementData = {};
  statementData.customer = invoice.customer;
  statementData.performances = invoice.performances.map(enrichPerformance);
  statementData.totalAmount = totalAmount(statementData);
  statementData.totalVolumeCredits = totalVolumeCredits(statementData);
  return statementData;
```

ç”±äºä¸¤ä¸ªé˜¶æ®µå·²ç»å½»åº•åˆ†ç¦»ï¼Œæˆ‘å¹²è„†æŠŠå®ƒæ¬ç§»åˆ°å¦ä¸€ä¸ªæ–‡ä»¶é‡Œå»ï¼ˆå¹¶ä¸”ä¿®æ”¹äº†è¿”å›ç»“æœçš„å˜é‡åï¼Œä¸æˆ‘ä¸€è´¯çš„ç¼–ç é£æ ¼ä¿æŒä¸€è‡´ï¼‰ã€‚

#### statement.js

```js
import createStatementData from "./createStatementData.js";
```

#### createStatementData.js

```js
export default function createStatementData(invoice, plays) {
const result = {};
result.customer = invoice.customer;
result.performances = invoice.performances.map(enrichPerformance);
result.totalAmount = totalAmount(result);
result.totalVolumeCredits = totalVolumeCredits(result);
return result;

function enrichPerformance(aPerformance) {...}
  function playFor(aPerformance) {...}
  function amountFor(aPerformance) {...}
  function volumeCreditsFor(aPerformance) {...}
  function totalAmount(data) {...}
  function totalVolumeCredits(data) {...}
```

æœ€åå†åšä¸€æ¬¡ç¼–è¯‘ã€æµ‹è¯•ã€æäº¤ï¼Œæ¥ä¸‹æ¥ï¼Œè¦ç¼–å†™ä¸€ä¸ª HTML ç‰ˆæœ¬çš„å¯¹è´¦å•å°±å¾ˆç®€å•äº†ã€‚

#### statement.js

```js
function htmlStatement (invoice, plays) {
  return renderHtml(createStatementData(invoice, plays));
}
function renderHtml (data) {
  let result = `&lt;h1&gt;Statement for ${data.customer}&lt;/h1&gt;\n`;
  result += "&lt;table&gt;\n";
  result += "&lt;tr&gt;&lt;th&gt;play&lt;/th&gt;&lt;th&gt;seats&lt;/th&gt;&lt;th&gt;cost&lt;/th&gt;&lt;/tr&gt;";
  for (let perf of data.performances) {
    result += ` &lt;tr&gt;&lt;td&gt;${perf.play.name}&lt;/td&gt;&lt;td&gt;${perf.audience}&lt;/td&gt;`;
    result += `&lt;td&gt;${usd(perf.amount)}&lt;/td&gt;&lt;/tr&gt;\n`;
  }
  result += "&lt;/table&gt;\n";
  result += `&lt;p&gt;Amount owed is &lt;em&gt;${usd(data.totalAmount)}&lt;/em&gt;&lt;/p&gt;\n`;
  result += `&lt;p&gt;You earned &lt;em&gt;${data.totalVolumeCredits}&lt;/em&gt; credits&lt;/p&gt;\n`;
  return result;
}

function usd(aNumber) {...}
```

ï¼ˆæˆ‘æŠŠ usd å‡½æ•°ä¹Ÿæ¬ç§»åˆ°é¡¶å±‚ä½œç”¨åŸŸä¸­ï¼Œä»¥ä¾¿ renderHtml ä¹Ÿèƒ½è®¿é—®å®ƒã€‚ï¼‰

## 1.7 è¿›å±•ï¼šåˆ†ç¦»åˆ°ä¸¤ä¸ªæ–‡ä»¶ï¼ˆå’Œä¸¤ä¸ªé˜¶æ®µï¼‰

ç°åœ¨æ­£æ˜¯åœä¸‹æ¥é‡æ–°å›é¡¾ä¸€ä¸‹ä»£ç çš„å¥½æ—¶æœºï¼Œæ€è€ƒä¸€ä¸‹é‡æ„çš„è¿›å±•ã€‚ç°åœ¨æˆ‘æœ‰äº†ä¸¤ä¸ªä»£ç æ–‡ä»¶ã€‚

statement.js

```js
import createStatementData from "./createStatementData.js";
function statement(invoice, plays) {
  return renderPlainText(createStatementData(invoice, plays));
}
function renderPlainText(data, plays) {
  let result = `Statement for ${data.customer}\n`;
  for (let perf of data.performances) {
    result += ` ${perf.play.name}: ${usd(perf.amount)} (${
      perf.audience
    } seats)\n`;
  }
  result += `Amount owed is ${usd(data.totalAmount)}\n`;
  result += `You earned ${data.totalVolumeCredits} credits\n`;
  return result;
}
function htmlStatement(invoice, plays) {
  return renderHtml(createStatementData(invoice, plays));
}
function renderHtml(data) {
  let result = `&lt;h1&gt;Statement for ${data.customer}&lt;/h1&gt;\n`;
  result += "&lt;table&gt;\n";
  result +=
    "&lt;tr&gt;&lt;th&gt;play&lt;/th&gt;&lt;th&gt;seats&lt;/th&gt;&lt;th&gt;cost&lt;/th&gt;&lt;/tr&gt;";
  for (let perf of data.performances) {
    result += ` &lt;tr&gt;&lt;td&gt;${perf.play.name}&lt;/td&gt;&lt;td&gt;${perf.audience}&lt;/td&gt;`;
    result += `&lt;td&gt;${usd(perf.amount)}&lt;/td&gt;&lt;/tr&gt;\n`;
  }
  result += "&lt;/table&gt;\n";
  result += `&lt;p&gt;Amount owed is &lt;em&gt;${usd(
    data.totalAmount
  )}&lt;/em&gt;&lt;/p&gt;\n`;
  result += `&lt;p&gt;You earned &lt;em&gt;${data.totalVolumeCredits}&lt;/em&gt; credits&lt;/p&gt;\n`;
  return result;
}
function usd(aNumber) {
  return new Intl.NumberFormat("en-US", {
    style: "currency",
    currency: "USD",
    minimumFractionDigits: 2,
  }).format(aNumber / 100);
}
```

createStatementData.js

```js
  export default function createStatementData(invoice, plays) {
  const result = {};
  result.customer = invoice.customer;
  result.performances = invoice.performances.map(enrichPerformance);
  result.totalAmount = totalAmount(result);
  result.totalVolumeCredits = totalVolumeCredits(result);
  return result;

  function enrichPerformance(aPerformance) {
    const result = Object.assign({}, aPerformance);
    result.play = playFor(result);
    result.amount = amountFor(result);
    result.volumeCredits = volumeCreditsFor(result);
    return result;
  }
  function playFor(aPerformance) {
    return plays[aPerformance.playID]
  }
  function amountFor(aPerformance) {
    let result = 0;
    switch (aPerformance.play.type) {
    case "tragedy":
      result = 40000;
      if (aPerformance.audience &gt; 30) {
        result += 1000 * (aPerformance.audience - 30);
      }
      break;
    case "comedy":
      result = 30000;
      if (aPerformance.audience &gt; 20) {
        result += 10000 + 500 * (aPerformance.audience - 20);
      }
      result += 300 * aPerformance.audience;
      break;
    default:
        throw new Error(`unknown type: ${aPerformance.play.type}`);
    }
    return result;
  }
  function volumeCreditsFor(aPerformance) {
    let result = 0;
    result += Math.max(aPerformance.audience - 30, 0);
    if ("comedy" === aPerformance.play.type) result += Math.floor(aPerformance.audience / 5);
    return result;
  }
  function totalAmount(data) {
    return data.performances
      .reduce((total, p) =&gt; total + p.amount, 0);
  }
  function totalVolumeCredits(data) {
    return data.performances
      .reduce((total, p) =&gt; total + p.volumeCredits, 0);
  }
```

ä»£ç è¡Œæ•°ç”±æˆ‘å¼€å§‹é‡æ„æ—¶çš„ 44 è¡Œå¢åŠ åˆ°äº† 70 è¡Œï¼ˆä¸ç®— htmlStatementï¼‰ï¼Œè¿™ä¸»è¦æ˜¯å°†ä»£ç æŠ½å–åˆ°å‡½æ•°é‡Œå¸¦æ¥çš„é¢å¤–åŒ…è£…æˆæœ¬ã€‚è™½ç„¶ä»£ç çš„è¡Œæ•°å¢åŠ äº†ï¼Œä½†é‡æ„ä¹Ÿå¸¦æ¥äº†ä»£ç å¯è¯»æ€§çš„æé«˜ã€‚é¢å¤–çš„åŒ…è£…å°†æ··æ‚çš„é€»è¾‘åˆ†è§£æˆå¯è¾¨åˆ«çš„éƒ¨åˆ†ï¼Œåˆ†ç¦»äº†è¯¦å•çš„è®¡ç®—é€»è¾‘ä¸æ ·å¼ã€‚è¿™ç§æ¨¡å—åŒ–ä½¿æˆ‘æ›´å®¹æ˜“è¾¨åˆ«ä»£ç çš„ä¸åŒéƒ¨åˆ†ï¼Œäº†è§£å®ƒä»¬çš„åä½œå…³ç³»ã€‚è™½è¯´è¨€ä»¥ç®€ä¸ºè´µï¼Œä½†å¯æ¼”åŒ–çš„è½¯ä»¶å´ä»¥æ˜ç¡®ä¸ºè´µã€‚é€šè¿‡å¢å¼ºä»£ç çš„æ¨¡å—åŒ–ï¼Œæˆ‘å¯ä»¥è½»æ˜“åœ°æ·»åŠ  HTML ç‰ˆæœ¬çš„ä»£ç ï¼Œè€Œæ— é¡»é‡å¤è®¡ç®—éƒ¨åˆ†çš„é€»è¾‘ã€‚

::: tip
ç¼–ç¨‹æ—¶ï¼Œéœ€è¦éµå¾ªè¥åœ°æ³•åˆ™ï¼šä¿è¯ä½ ç¦»å¼€æ—¶çš„ä»£ç åº“ä¸€å®šæ¯”æ¥æ—¶æ›´å¥åº·ã€‚
:::

å…¶å®æ‰“å°é€»è¾‘è¿˜å¯ä»¥è¿›ä¸€æ­¥ç®€åŒ–ï¼Œä½†å½“å‰çš„ä»£ç ä¹Ÿå¤Ÿç”¨äº†ã€‚æˆ‘ç»å¸¸éœ€è¦åœ¨æ‰€æœ‰å¯åšçš„é‡æ„ä¸æ·»åŠ æ–°ç‰¹æ€§ä¹‹é—´å¯»æ‰¾å¹³è¡¡ã€‚åœ¨å½“ä»Šä¸šç•Œï¼Œå¤§å¤šæ•°äººé¢ä¸´åŒæ ·çš„é€‰æ‹©æ—¶ï¼Œä¼¼ä¹å¤šä»¥å»¶ç¼“é‡æ„è€Œå‘Šç»ˆâ€”â€”å½“ç„¶è¿™ä¹Ÿæ˜¯ä¸€ç§é€‰æ‹©ã€‚æˆ‘çš„è§‚ç‚¹åˆ™ä¸è¥åœ°æ³•åˆ™æ— å¼‚ï¼šä¿è¯ç¦»å¼€æ—¶çš„ä»£ç åº“ä¸€å®šæ¯”ä½ æ¥æ—¶æ›´åŠ å¥åº·ã€‚å®Œç¾çš„å¢ƒç•Œå¾ˆéš¾è¾¾åˆ°ï¼Œä½†åº”è¯¥æ—¶æ—¶éƒ½å‹¤åŠ æ‹‚æ‹­ã€‚

## 1.8 æŒ‰ç±»å‹é‡ç»„è®¡ç®—è¿‡ç¨‹

æ¥ä¸‹æ¥æˆ‘å°†æ³¨æ„åŠ›é›†ä¸­åˆ°ä¸‹ä¸€ä¸ªç‰¹æ€§æ”¹åŠ¨ï¼šæ”¯æŒæ›´å¤šç±»å‹çš„æˆå‰§ï¼Œä»¥åŠæ”¯æŒå®ƒä»¬å„è‡ªçš„ä»·æ ¼è®¡ç®—å’Œè§‚ä¼—é‡ç§¯åˆ†è®¡ç®—ã€‚å¯¹äºç°åœ¨çš„ç»“æ„ï¼Œæˆ‘åªéœ€è¦åœ¨è®¡ç®—å‡½æ•°é‡Œæ·»åŠ åˆ†æ”¯é€»è¾‘å³å¯ã€‚amountFor å‡½æ•°æ¸…æ¥šåœ°ä½“ç°äº†ï¼Œæˆå‰§ç±»å‹åœ¨è®¡ç®—åˆ†æ”¯çš„é€‰æ‹©ä¸Šèµ·ç€å…³é”®çš„ä½œç”¨â€”â€”ä½†è¿™æ ·çš„åˆ†æ”¯é€»è¾‘å¾ˆå®¹æ˜“éšä»£ç å †ç§¯è€Œè…åï¼Œé™¤éç¼–ç¨‹è¯­è¨€æä¾›äº†æ›´åŸºç¡€çš„ç¼–ç¨‹è¯­è¨€å…ƒç´ æ¥é˜²æ­¢ä»£ç å †ç§¯ã€‚

è¦ä¸ºç¨‹åºå¼•å…¥ç»“æ„ã€æ˜¾å¼åœ°è¡¨è¾¾å‡ºâ€œè®¡ç®—é€»è¾‘çš„å·®å¼‚æ˜¯ç”±ç±»å‹ä»£ç ç¡®å®šâ€æœ‰è®¸å¤šé€”å¾„ï¼Œä¸è¿‡æœ€è‡ªç„¶çš„è§£å†³åŠæ³•è¿˜æ˜¯ä½¿ç”¨é¢å‘å¯¹è±¡ä¸–ç•Œé‡Œçš„ä¸€ä¸ªç»å…¸ç‰¹æ€§â€”â€”ç±»å‹å¤šæ€ã€‚ä¼ ç»Ÿçš„é¢å‘å¯¹è±¡ç‰¹æ€§åœ¨ JavaScript ä¸–ç•Œä¸€ç›´å¤‡å—äº‰è®®ï¼Œä½†æ–°çš„ ECMAScript 2015 è§„èŒƒæœ‰æ„ä¸ºç±»å’Œå¤šæ€å¼•å…¥äº†ä¸€ä¸ªç›¸å½“å®ç”¨çš„è¯­æ³•ç³–ã€‚è¿™è¯´æ˜ï¼Œåœ¨åˆé€‚çš„åœºæ™¯ä¸‹ä½¿ç”¨é¢å‘å¯¹è±¡æ˜¯åˆç†çš„â€”â€”æ˜¾ç„¶æˆ‘ä»¬è¿™ä¸ªå°±æ˜¯ä¸€ä¸ªåˆé€‚çš„ä½¿ç”¨åœºæ™¯ã€‚

æˆ‘çš„è®¾æƒ³æ˜¯å…ˆå»ºç«‹ä¸€ä¸ªç»§æ‰¿ä½“ç³»ï¼Œå®ƒæœ‰â€œå–œå‰§â€ï¼ˆcomedyï¼‰å’Œâ€œæ‚²å‰§â€ï¼ˆtragedyï¼‰ä¸¤ä¸ªå­ç±»ï¼Œå­ç±»å„è‡ªåŒ…å«ç‹¬ç«‹çš„è®¡ç®—é€»è¾‘ã€‚è°ƒç”¨è€…é€šè¿‡è°ƒç”¨ä¸€ä¸ªå¤šæ€çš„ amount å‡½æ•°ï¼Œè®©è¯­è¨€å¸®ä½ åˆ†å‘åˆ°ä¸åŒçš„å­ç±»çš„è®¡ç®—è¿‡ç¨‹ä¸­ã€‚volumeCredits å‡½æ•°çš„å¤„ç†ä¹Ÿæ˜¯å¦‚æ³•ç‚®åˆ¶ã€‚ä¸ºæ­¤æˆ‘éœ€è¦ç”¨åˆ°å¤šç§é‡æ„æ–¹æ³•ï¼Œå…¶ä¸­æœ€æ ¸å¿ƒçš„ä¸€æ‹›æ˜¯ä»¥å¤šæ€å–ä»£æ¡ä»¶è¡¨è¾¾å¼ï¼ˆ272ï¼‰ï¼Œå°†å¤šä¸ªåŒæ ·çš„ç±»å‹ç åˆ†æ”¯ç”¨å¤šæ€å–ä»£ã€‚ä½†åœ¨æ–½å±•ä»¥å¤šæ€å–ä»£æ¡ä»¶è¡¨è¾¾å¼ï¼ˆ272ï¼‰ä¹‹å‰ï¼Œæˆ‘å¾—å…ˆåˆ›å»ºä¸€ä¸ªåŸºæœ¬çš„ç»§æ‰¿ç»“æ„ã€‚æˆ‘éœ€è¦å…ˆåˆ›å»ºä¸€ä¸ªç±»ï¼Œå¹¶å°†ä»·æ ¼è®¡ç®—å‡½æ•°å’Œè§‚ä¼—é‡ç§¯åˆ†è®¡ç®—å‡½æ•°æ”¾è¿›å»ã€‚

æˆ‘å…ˆä»æ£€æŸ¥è®¡ç®—ä»£ç å¼€å§‹ã€‚ï¼ˆä¹‹å‰çš„é‡æ„å¸¦æ¥çš„ä¸€å¤§å¥½å¤„æ˜¯ï¼Œç°åœ¨æˆ‘å¤§å¯ä»¥å¿½ç•¥é‚£äº›æ ¼å¼åŒ–ä»£ç ï¼Œåªè¦ä¸æ”¹å˜ä¸­è½¬æ•°æ®ç»“æ„å°±è¡Œã€‚æˆ‘å¯ä»¥è¿›ä¸€æ­¥æ·»åŠ æµ‹è¯•æ¥ä¿è¯ä¸­è½¬æ•°æ®ç»“æ„ä¸ä¼šè¢«æ„å¤–ä¿®æ”¹ã€‚ï¼‰

#### createStatementData.js

```js
export default function createStatementData(invoice, plays) {
const result = {};
result.customer = invoice.customer;
result.performances = invoice.performances.map(enrichPerformance);
result.totalAmount = totalAmount(result);
result.totalVolumeCredits = totalVolumeCredits(result);
return result;

function enrichPerformance(aPerformance) {
const result = Object.assign({}, aPerformance);
result.play = playFor(result);
result.amount = amountFor(result);
result.volumeCredits = volumeCreditsFor(result);
return result;
}
function playFor(aPerformance) {
return plays[aPerformance.playID]
}
function amountFor(aPerformance) {
let result = 0;
switch (aPerformance.play.type) {
case "tragedy":
    result = 40000;
    if (aPerformance.audience &gt; 30) {
    result += 1000 * (aPerformance.audience - 30);
    }
    break;
case "comedy":
    result = 30000;
    if (aPerformance.audience &gt; 20) {
    result += 10000 + 500 * (aPerformance.audience - 20);
    }
    result += 300 * aPerformance.audience;
    break;
default:
    throw new Error(`unknown type: ${aPerformance.play.type}`);
}
return result;
}
function volumeCreditsFor(aPerformance) {
let result = 0;
result += Math.max(aPerformance.audience - 30, 0);
if ("comedy" === aPerformance.play.type) result += Math.floor(aPerformance.audience / 5);
return result;
}
function totalAmount(data) {
return data.performances
    .reduce((total, p) =&gt; total + p.amount, 0);
}
function totalVolumeCredits(data) {
return data.performances
    .reduce((total, p) =&gt; total + p.volumeCredits, 0);
}
```

åˆ›å»ºæ¼”å‡ºè®¡ç®—å™¨

enrichPerformance å‡½æ•°æ˜¯å…³é”®æ‰€åœ¨ï¼Œå› ä¸ºæ­£æ˜¯å®ƒç”¨æ¯åœºæ¼”å‡ºçš„æ•°æ®æ¥å¡«å……ä¸­è½¬æ•°æ®ç»“æ„ã€‚ç›®å‰å®ƒç›´æ¥è°ƒç”¨äº†è®¡ç®—ä»·æ ¼å’Œè§‚ä¼—é‡ç§¯åˆ†çš„å‡½æ•°ï¼Œæˆ‘éœ€è¦åˆ›å»ºä¸€ä¸ªç±»ï¼Œé€šè¿‡è¿™ä¸ªç±»æ¥è°ƒç”¨è¿™äº›å‡½æ•°ã€‚ç”±äºè¿™ä¸ªç±»å­˜æ”¾äº†ä¸æ¯åœºæ¼”å‡ºç›¸å…³æ•°æ®çš„è®¡ç®—å‡½æ•°ï¼Œäºæ˜¯æˆ‘æŠŠå®ƒç§°ä¸ºæ¼”å‡ºè®¡ç®—å™¨ï¼ˆperformance calculatorï¼‰ã€‚

#### function createStatementData

```js
function enrichPerformance(aPerformance) {
  const calculator = new PerformanceCalculator(aPerformance);
  const result = Object.assign({}, aPerformance);
  result.play = playFor(result);
  result.amount = amountFor(result);
  result.volumeCredits = volumeCreditsFor(result);
  return result;
}
```

#### é¡¶å±‚ä½œç”¨åŸŸ

```js
class PerformanceCalculator {
  constructor(aPerformance) {
    this.performance = aPerformance;
  }
}
```

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œè¿™ä¸ªæ–°å¯¹è±¡è¿˜æ²¡åšä»€ä¹ˆäº‹ã€‚æˆ‘å¸Œæœ›å°†å‡½æ•°è¡Œä¸ºæ¬ç§»è¿›æ¥ï¼Œè¿™å¯ä»¥ä»æœ€å®¹æ˜“æ¬ç§»çš„ä¸œè¥¿â€”â€”play å­—æ®µå¼€å§‹ã€‚ä¸¥æ ¼æ¥è®²ï¼Œæˆ‘ä¸éœ€è¦æ¬ç§»è¿™ä¸ªå­—æ®µï¼Œå› ä¸ºå®ƒå¹¶æœªä½“ç°å‡ºå¤šæ€æ€§ï¼Œä½†è¿™æ ·å¯ä»¥æŠŠæ‰€æœ‰æ•°æ®è½¬æ¢é›†ä¸­åˆ°ä¸€å¤„åœ°æ–¹ï¼Œä¿è¯äº†ä»£ç çš„ä¸€è‡´æ€§å’Œæ¸…æ™°åº¦ã€‚

ä¸ºæ­¤ï¼Œæˆ‘å°†ä½¿ç”¨æ”¹å˜å‡½æ•°å£°æ˜ï¼ˆ124ï¼‰æ‰‹æ³•å°† performance çš„ play å­—æ®µä¼ ç»™è®¡ç®—å™¨ã€‚

#### function createStatementData

```js
function enrichPerformance(aPerformance) {
  const calculator = new PerformanceCalculator(
    aPerformance,
    playFor(aPerformance)
  );
  const result = Object.assign({}, aPerformance);
  result.play = calculator.play;
  result.amount = amountFor(result);
  result.volumeCredits = volumeCreditsFor(result);
  return result;
}
```

#### class PerformanceCalculator

```js
class PerformanceCalculator {
  constructor(aPerformance, aPlay) {
    this.performance = aPerformance;
    this.play = aPlay;
  }
}
```

ï¼ˆä»¥ä¸‹è¡Œæ–‡ä¸­æˆ‘å°†ä¸å†ç‰¹åˆ«æåŠâ€œç¼–è¯‘ã€æµ‹è¯•ã€æäº¤â€å¾ªç¯ï¼Œæˆ‘çŒœä½ ä¹Ÿå·²ç»è¯»å¾—æœ‰äº›åŒçƒ¦äº†ã€‚ä½†æˆ‘ä»ä¼šä¸æ–­é‡å¤è¿™ä¸ªå¾ªç¯ã€‚çš„ç¡®ï¼Œæœ‰æ—¶æˆ‘ä¹Ÿä¼šåŒçƒ¦ï¼Œç›´åˆ°é”™è¯¯åˆè·³å‡ºæ¥å’¬æˆ‘ä¸€ä¸‹ï¼Œæˆ‘æ‰åˆå­¦ä¼šè¿›å…¥å°æ­¥çš„èŠ‚å¥ã€‚ï¼‰

### å°†å‡½æ•°æ¬ç§»è¿›è®¡ç®—å™¨

æˆ‘è¦æ¬ç§»çš„ä¸‹ä¸€å—é€»è¾‘ï¼Œå¯¹è®¡ç®—ä¸€åœºæ¼”å‡ºçš„ä»·æ ¼ï¼ˆamountï¼‰æ¥è¯´å°±å°¤ä¸ºé‡è¦äº†ã€‚åœ¨è°ƒæ•´åµŒå¥—å‡½æ•°çš„å±‚çº§æ—¶ï¼Œæˆ‘ç»å¸¸å°†å‡½æ•°æŒªæ¥æŒªå»ï¼Œä½†æ¥ä¸‹æ¥éœ€è¦æ”¹åŠ¨åˆ°æ›´æ·±å…¥çš„å‡½æ•°ä¸Šä¸‹æ–‡ï¼Œå› æ­¤æˆ‘å°†å°å¿ƒä½¿ç”¨æ¬ç§»å‡½æ•°ï¼ˆ198ï¼‰æ¥é‡æ„å®ƒã€‚é¦–å…ˆï¼Œå°† amount å‡½æ•°çš„é€»è¾‘å¤åˆ¶ä¸€ä»½åˆ°æ–°çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œä¹Ÿå°±æ˜¯ PerformanceCalculator ç±»ä¸­ã€‚ç„¶åå¾®è°ƒä¸€ä¸‹ä»£ç ï¼Œå°† aPerformance æ”¹ä¸º this.performanceï¼Œå°† playFor(aPerformance)æ”¹ä¸º this.playï¼Œä½¿ä»£ç é€‚åº”è¿™ä¸ªæ–°å®¶ã€‚

#### class PerformanceCalculator

```js
  get amount() {
  let result = 0;
  switch (this.play.type) {
    case "tragedy":
      result = 40000;
      if (this.performance.audience &gt; 30) {
        result += 1000 * (this.performance.audience - 30);
      }
      break;
    case "comedy":
      result = 30000;
      if (this.performance.audience &gt; 20) {
        result += 10000 + 500 * (this.performance.audience - 20);
      }
      result += 300 * this.performance.audience;
      break;
    default:
      throw new Error(`unknown type: ${this.play.type}`);
  }
  return result;
}
```

æ¬ç§»å®Œæˆåå¯ä»¥ç¼–è¯‘ä¸€ä¸‹ï¼Œçœ‹çœ‹æ˜¯å¦æœ‰ç¼–è¯‘é”™è¯¯ã€‚æˆ‘åœ¨æœ¬åœ°å¼€å‘ç¯å¢ƒè¿è¡Œä»£ç æ—¶ï¼Œç¼–è¯‘ä¼šè‡ªåŠ¨å‘ç”Ÿï¼Œæˆ‘å®é™…éœ€è¦åšçš„åªæ˜¯è¿è¡Œä¸€ä¸‹ Babelã€‚ç¼–è¯‘èƒ½å¸®æˆ‘å‘ç°æ–°å‡½æ•°ä¸­æ½œåœ¨çš„è¯­æ³•é”™è¯¯ï¼Œè¯­æ³•ä¹‹å¤–çš„å°±å¸®ä¸ä¸Šä»€ä¹ˆå¿™äº†ã€‚å°½ç®¡å¦‚æ­¤ï¼Œè¿™ä¸€æ­¥è¿˜æ˜¯å¾ˆæœ‰ç”¨ã€‚

ä½¿æ–°å‡½æ•°é€‚åº”æ–°å®¶åï¼Œæˆ‘ä¼šå°†åŸæ¥çš„å‡½æ•°æ”¹é€ æˆä¸€ä¸ªå§”æ‰˜å‡½æ•°ï¼Œè®©å®ƒç›´æ¥è°ƒç”¨æ–°å‡½æ•°ã€‚

#### function createStatementData

```js
function amountFor(aPerformance) {
  return new PerformanceCalculator(aPerformance, playFor(aPerformance)).amount;
}
```

ç°åœ¨ï¼Œæˆ‘å¯ä»¥æ‰§è¡Œä¸€æ¬¡ç¼–è¯‘ã€æµ‹è¯•ã€æäº¤ï¼Œç¡®ä¿ä»£ç æ¬åˆ°æ–°å®¶åä¹Ÿèƒ½å¦‚å¸¸å·¥ä½œã€‚ä¹‹åï¼Œæˆ‘åº”ç”¨å†…è”å‡½æ•°ï¼ˆ115ï¼‰ï¼Œè®©å¼•ç”¨ç‚¹ç›´æ¥è°ƒç”¨æ–°å‡½æ•°ï¼ˆç„¶åç¼–è¯‘ã€æµ‹è¯•ã€æäº¤ï¼‰ã€‚

#### function createStatementData

```js
function enrichPerformance(aPerformance) {
  const calculator = new PerformanceCalculator(
    aPerformance,
    playFor(aPerformance)
  );
  const result = Object.assign({}, aPerformance);
  result.play = calculator.play;
  result.amount = calculator.amount;
  result.volumeCredits = volumeCreditsFor(result);
  return result;
}
```

æ¬ç§»è§‚ä¼—é‡ç§¯åˆ†è®¡ç®—ä¹Ÿéµå¾ªåŒæ ·çš„æµç¨‹ã€‚

#### function createStatementData

```js
function enrichPerformance(aPerformance) {
  const calculator = new PerformanceCalculator(
    aPerformance,
    playFor(aPerformance)
  );
  const result = Object.assign({}, aPerformance);
  result.play = calculator.play;
  result.amount = calculator.amount;
  result.volumeCredits = calculator.volumeCredits;
  return result;
}
```

#### class PerformanceCalculator

```js
  get volumeCredits() {
  let result = 0;
  result += Math.max(this.performance.audience - 30, 0);
  if ("comedy" === this.play.type) result += Math.floor(this.performance.audience / 5);
  return result;
}
```

### ä½¿æ¼”å‡ºè®¡ç®—å™¨è¡¨ç°å‡ºå¤šæ€æ€§

æˆ‘å·²å°†å…¨éƒ¨è®¡ç®—é€»è¾‘æ¬ç§»åˆ°ä¸€ä¸ªç±»ä¸­ï¼Œæ˜¯æ—¶å€™å°†å®ƒå¤šæ€åŒ–äº†ã€‚ç¬¬ä¸€æ­¥æ˜¯åº”ç”¨ä»¥å­ç±»å–ä»£ç±»å‹ç ï¼ˆ362ï¼‰å¼•å…¥å­ç±»ï¼Œå¼ƒç”¨ç±»å‹ä»£ç ã€‚ä¸ºæ­¤ï¼Œæˆ‘éœ€è¦ä¸ºæ¼”å‡ºè®¡ç®—å™¨åˆ›å»ºå­ç±»ï¼Œå¹¶åœ¨ createStatementData ä¸­è·å–å¯¹åº”çš„å­ç±»ã€‚è¦å¾—åˆ°æ­£ç¡®çš„å­ç±»ï¼Œæˆ‘éœ€è¦å°†æ„é€ å‡½æ•°è°ƒç”¨æ›¿æ¢ä¸ºä¸€ä¸ªæ™®é€šçš„å‡½æ•°è°ƒç”¨ï¼Œå› ä¸º JavaScript çš„æ„é€ å‡½æ•°é‡Œæ— æ³•è¿”å›å­ç±»ã€‚äºæ˜¯æˆ‘ä½¿ç”¨ä»¥å·¥å‚å‡½æ•°å–ä»£æ„é€ å‡½æ•°ï¼ˆ334ï¼‰ã€‚

#### function createStatementData

```js
function enrichPerformance(aPerformance) {
  const calculator = createPerformanceCalculator(
    aPerformance,
    playFor(aPerformance)
  );
  const result = Object.assign({}, aPerformance);
  result.play = calculator.play;
  result.amount = calculator.amount;
  result.volumeCredits = calculator.volumeCredits;
  return result;
}
```

#### é¡¶å±‚ä½œç”¨åŸŸ

```js
function createPerformanceCalculator(aPerformance, aPlay) {
  return new PerformanceCalculator(aPerformance, aPlay);
}
```

æ”¹é€ æˆæ™®é€šå‡½æ•°åï¼Œæˆ‘å°±å¯ä»¥åœ¨é‡Œé¢åˆ›å»ºæ¼”å‡ºè®¡ç®—å™¨çš„å­ç±»ï¼Œç„¶åç”±åˆ›å»ºå‡½æ•°å†³å®šè¿”å›å“ªä¸€ä¸ªå­ç±»çš„å®ä¾‹ã€‚

#### é¡¶å±‚ä½œç”¨åŸŸ

```js
function createPerformanceCalculator(aPerformance, aPlay) {
  switch (aPlay.type) {
    case "tragedy":
      return new TragedyCalculator(aPerformance, aPlay);
    case "comedy":
      return new ComedyCalculator(aPerformance, aPlay);
    default:
      throw new Error(`unknown type: ${aPlay.type}`);
  }
}

class TragedyCalculator extends PerformanceCalculator {}
class ComedyCalculator extends PerformanceCalculator {}
```

å‡†å¤‡å¥½å®ç°å¤šæ€çš„ç±»ç»“æ„åï¼Œæˆ‘å°±å¯ä»¥ç»§ç»­ä½¿ç”¨ä»¥å¤šæ€å–ä»£æ¡ä»¶è¡¨è¾¾å¼ï¼ˆ272ï¼‰æ‰‹æ³•äº†ã€‚

æˆ‘å…ˆä»æ‚²å‰§çš„ä»·æ ¼è®¡ç®—é€»è¾‘å¼€å§‹æ¬ç§»ã€‚

#### class TragedyCalculator

```js
  get amount() {
  let result = 40000;
  if (this.performance.audience &gt; 30) {
    result += 1000 * (this.performance.audience - 30);
  }
  return result;
}
```

è™½è¯´å­ç±»æœ‰äº†è¿™ä¸ªæ–¹æ³•å·²è¶³ä»¥è¦†ç›–è¶…ç±»å¯¹åº”çš„æ¡ä»¶åˆ†æ”¯ï¼Œä½†è¦æ˜¯ä½ ä¹Ÿå’Œæˆ‘ä¸€æ ·åæ‰§ï¼Œä½ ä¹Ÿè®¸è¿˜æƒ³åœ¨è¶…ç±»çš„åˆ†æ”¯ä¸ŠæŠ›ä¸€ä¸ªå¼‚å¸¸ã€‚

#### class PerformanceCalculator

```js
  get amount() {
  let result = 0;
  switch (this.play.type) {
    case "tragedy":
      throw 'bad thing';
    case "comedy":
      result = 30000;
      if (this.performance.audience &gt; 20) {
        result += 10000 + 500 * (this.performance.audience - 20);
      }
      result += 300 * this.performance.audience;
      break;
    default:
      throw new Error(`unknown type: ${this.play.type}`);
  }
  return result;
}
```

è™½ç„¶æˆ‘ä¹Ÿå¯ä»¥ç›´æ¥åˆ æ‰å¤„ç†æ‚²å‰§çš„åˆ†æ”¯ï¼Œå°†é”™è¯¯ç•™ç»™é»˜è®¤åˆ†æ”¯å»æŠ›å‡ºï¼Œä½†æˆ‘æ›´å–œæ¬¢æ˜¾å¼åœ°æŠ›å‡ºå¼‚å¸¸â€”â€”ä½•å†µè¿™è¡Œä»£ç åªèƒ½å†æ´»ä¸ªå‡ åˆ†é’Ÿäº†ï¼ˆè¿™ä¹Ÿæ˜¯æˆ‘ç›´æ¥æŠ›å‡ºä¸€ä¸ªå­—ç¬¦ä¸²è€Œä¸ç”¨æ›´å¥½çš„é”™è¯¯å¯¹è±¡çš„åŸå› ï¼‰ã€‚

å†æ¬¡è¿›è¡Œç¼–è¯‘ã€æµ‹è¯•ã€æäº¤ã€‚ä¹‹åï¼Œå°†å¤„ç†å–œå‰§ç±»å‹çš„åˆ†æ”¯ä¹Ÿä¸‹ç§»åˆ°å­ç±»ä¸­å»ã€‚

#### class ComedyCalculator

```js
  get amount() {
  let result = 30000;
  if (this.performance.audience &gt; 20) {
    result += 10000 + 500 * (this.performance.audience - 20);
  }
  result += 300 * this.performance.audience;
  return result;
}
```

ç†è®ºä¸Šè®²ï¼Œæˆ‘å¯ä»¥å°†è¶…ç±»çš„ amount æ–¹æ³•ä¸€å¹¶ç§»é™¤äº†ï¼Œåæ­£å®ƒä¹Ÿä¸åº”å†è¢«è°ƒç”¨åˆ°ã€‚ä½†ä¸åˆ å®ƒï¼Œç»™æœªæ¥çš„è‡ªå·±ç•™ç‚¹çºªå¿µå“ä¹Ÿæ˜¯æå¥½çš„ï¼Œé¡ºä¾¿å¯ä»¥æé†’åæ¥è€…è®°å¾—å®ç°è¿™ä¸ªå‡½æ•°ã€‚

#### class PerformanceCalculator

```js
  get amount() {
  throw new Error('subclass responsibility');
}
```

ä¸‹ä¸€ä¸ªè¦æ›¿æ¢çš„æ¡ä»¶è¡¨è¾¾å¼æ˜¯è§‚ä¼—é‡ç§¯åˆ†çš„è®¡ç®—ã€‚æˆ‘å›é¡¾äº†ä¸€ä¸‹å‰é¢å…³äºæœªæ¥æˆå‰§ç±»å‹çš„è®¨è®ºï¼Œå‘ç°å¤§å¤šæ•°å‰§ç±»åœ¨è®¡ç®—ç§¯åˆ†æ—¶éƒ½ä¼šæ£€æŸ¥è§‚ä¼—æ•°æ˜¯å¦è¾¾åˆ° 30ï¼Œä»…ä¸€å°éƒ¨åˆ†å“ç±»æœ‰æ‰€ä¸åŒã€‚å› æ­¤ï¼Œå°†æ›´ä¸ºé€šç”¨çš„é€»è¾‘æ”¾åˆ°è¶…ç±»ä½œä¸ºé»˜è®¤æ¡ä»¶ï¼Œå‡ºç°ç‰¹æ®Šåœºæ™¯æ—¶æŒ‰éœ€è¦†ç›–å®ƒï¼Œå¬èµ·æ¥ååˆ†åˆç†ã€‚äºæ˜¯æˆ‘å°†ä¸€éƒ¨åˆ†å–œå‰§çš„é€»è¾‘ä¸‹ç§»åˆ°å­ç±»ã€‚

#### class PerformanceCalculator

```js
get volumeCredits() {
  return Math.max(this.performance.audience - 30, 0);
}
```

#### class ComedyCalculator

```js
get volumeCredits() {
  return super.volumeCredits + Math.floor(this.performance.audience / 5);
}
```

## 1.9 è¿›å±•ï¼šä½¿ç”¨å¤šæ€è®¡ç®—å™¨æ¥æä¾›æ•°æ®

åˆåˆ°äº†è§‚æ‘©ä»£ç çš„æ—¶åˆ»ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹ï¼Œä¸ºè®¡ç®—å™¨å¼•å…¥å¤šæ€ä¼šå¯¹ä»£ç åº“æœ‰ä»€ä¹ˆå½±å“ã€‚

createStatementData.js

```js
  export default function createStatementData(invoice, plays) {
  const result = {};
  result.customer = invoice.customer;
  result.performances = invoice.performances.map(enrichPerformance);
  result.totalAmount = totalAmount(result);
  result.totalVolumeCredits = totalVolumeCredits(result);
  return result;

  function enrichPerformance(aPerformance) {
    const calculator = createPerformanceCalculator(aPerformance, playFor(aPerformance));
    const result = Object.assign({}, aPerformance);
    result.play = calculator.play;
    result.amount = calculator.amount;
    result.volumeCredits = calculator.volumeCredits;
    return result;
  }
  function playFor(aPerformance) {
    return plays[aPerformance.playID]
  }
  function totalAmount(data) {
    return data.performances
      .reduce((total, p) =&gt; total + p.amount, 0);
  }
  function totalVolumeCredits(data) {
    return data.performances
      .reduce((total, p) =&gt; total + p.volumeCredits, 0);
  }
}
function createPerformanceCalculator(aPerformance, aPlay) {
    switch(aPlay.type) {
    case "tragedy": return new TragedyCalculator(aPerformance, aPlay);
    case "comedy" : return new ComedyCalculator(aPerformance, aPlay);
    default:
        throw new Error(`unknown type: ${aPlay.type}`);
    }
}
class PerformanceCalculator {
  constructor(aPerformance, aPlay) {
    this.performance = aPerformance;
    this.play = aPlay;
  }
  get amount() {
    throw new Error('subclass responsibility');
  }
  get volumeCredits() {
    return Math.max(this.performance.audience - 30, 0);
  }
}
class TragedyCalculator extends PerformanceCalculator {
  get amount() {
    let result = 40000;
    if (this.performance.audience &gt; 30) {
      result += 1000 * (this.performance.audience - 30);
    }
    return result;
  }
}
class ComedyCalculator extends PerformanceCalculator {
  get amount() {
    let result = 30000;
    if (this.performance.audience &gt; 20) {
      result += 10000 + 500 * (this.performance.audience - 20);
    }
    result += 300 * this.performance.audience;
    return result;
  }
  get volumeCredits() {
    return super.volumeCredits + Math.floor(this.performance.audience / 5);
  }
}
```

ä»£ç é‡ä»ç„¶æœ‰æ‰€å¢åŠ ï¼Œå› ä¸ºæˆ‘å†æ¬¡æ•´ç†äº†ä»£ç ç»“æ„ã€‚æ–°ç»“æ„å¸¦æ¥çš„å¥½å¤„æ˜¯ï¼Œä¸åŒæˆå‰§ç§ç±»çš„è®¡ç®—å„è‡ªé›†ä¸­åˆ°äº†ä¸€å¤„åœ°æ–¹ã€‚å¦‚æœå¤§å¤šæ•°ä¿®æ”¹éƒ½æ¶‰åŠç‰¹å®šç±»å‹çš„è®¡ç®—ï¼Œåƒè¿™æ ·æŒ‰ç±»å‹è¿›è¡Œåˆ†ç¦»å°±å¾ˆæœ‰æ„ä¹‰ã€‚å½“æ·»åŠ æ–°å‰§ç§æ—¶ï¼Œåªéœ€è¦æ·»åŠ ä¸€ä¸ªå­ç±»ï¼Œå¹¶åœ¨åˆ›å»ºå‡½æ•°ä¸­è¿”å›å®ƒã€‚

è¿™ä¸ªç¤ºä¾‹è¿˜æ­ç¤ºäº†ä¸€äº›å…³äºæ­¤ç±»ç»§æ‰¿æ–¹æ¡ˆä½•æ—¶é€‚ç”¨çš„æ´è§ã€‚ä¸Šé¢æˆ‘å°†æ¡ä»¶åˆ†æ”¯çš„æŸ¥æ‰¾ä»ä¸¤ä¸ªä¸åŒçš„å‡½æ•°ï¼ˆamountFor å’Œ volumeCreditsForï¼‰æ¬ç§»åˆ°ä¸€ä¸ªé›†ä¸­çš„æ„é€ å‡½æ•° createPerformanceCalculator ä¸­ã€‚æœ‰è¶Šå¤šçš„å‡½æ•°ä¾èµ–äºåŒä¸€å¥—ç±»å‹è¿›è¡Œå¤šæ€ï¼Œè¿™ç§ç»§æ‰¿æ–¹æ¡ˆå°±è¶Šæœ‰ç›Šå¤„ã€‚

é™¤äº†è¿™æ ·è®¾è®¡ï¼Œè¿˜æœ‰å¦ä¸€ç§å¯èƒ½çš„æ–¹æ¡ˆï¼Œé‚£å°±æ˜¯è®© createStatementData è¿”å›è®¡ç®—å™¨å®ä¾‹æœ¬èº«ï¼Œè€Œéè‡ªå·±æ‹¿åˆ°è®¡ç®—å™¨æ¥å¡«å……ä¸­è½¬æ•°æ®ç»“æ„ã€‚JavaScript çš„ç±»è®¾è®¡æœ‰ä¸å°‘å¥½ç‰¹æ€§ï¼Œä¾‹å¦‚ï¼Œå–å€¼å‡½æ•°ç”¨èµ·æ¥å°±åƒæ™®é€šçš„æ•°æ®å­˜å–ã€‚æˆ‘åœ¨è€ƒé‡æ˜¯â€œç›´æ¥è¿”å›å®ä¾‹æœ¬èº«â€è¿˜æ˜¯â€œè¿”å›è®¡ç®—å¥½çš„ä¸­è½¬æ•°æ®â€æ—¶ï¼Œä¸»è¦çœ‹æ•°æ®çš„ä½¿ç”¨è€…æ˜¯è°ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘æ›´æƒ³é€šè¿‡ä¸­è½¬æ•°æ®ç»“æ„æ¥å±•ç¤ºå¦‚ä½•ä»¥æ­¤éšè—è®¡ç®—å™¨èƒŒåçš„å¤šæ€è®¾è®¡ã€‚

## 1.10 ç»“è¯­

è¿™æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œä½†æˆ‘å¸Œæœ›å®ƒèƒ½è®©ä½ å¯¹â€œé‡æ„æ€ä¹ˆåšâ€æœ‰ä¸€ç‚¹æ„Ÿè§‰ã€‚ä¾‹ä¸­æˆ‘å·²ç»ç¤ºèŒƒäº†æ•°ç§é‡æ„æ‰‹æ³•ï¼ŒåŒ…æ‹¬æç‚¼å‡½æ•°ï¼ˆ106ï¼‰ã€å†…è”å˜é‡ï¼ˆ123ï¼‰ã€æ¬ç§»å‡½æ•°ï¼ˆ198ï¼‰å’Œä»¥å¤šæ€å–ä»£æ¡ä»¶è¡¨è¾¾å¼ï¼ˆ272ï¼‰ç­‰ã€‚

æœ¬ç« çš„é‡æ„æœ‰ 3 ä¸ªè¾ƒä¸ºé‡è¦çš„èŠ‚ç‚¹ï¼Œåˆ†åˆ«æ˜¯ï¼šå°†åŸå‡½æ•°åˆ†è§£æˆä¸€ç»„åµŒå¥—çš„å‡½æ•°ã€åº”ç”¨æ‹†åˆ†é˜¶æ®µï¼ˆ154ï¼‰åˆ†ç¦»è®¡ç®—é€»è¾‘ä¸è¾“å‡ºæ ¼å¼åŒ–é€»è¾‘ï¼Œä»¥åŠä¸ºè®¡ç®—å™¨å¼•å…¥å¤šæ€æ€§æ¥å¤„ç†è®¡ç®—é€»è¾‘ã€‚æ¯ä¸€æ­¥éƒ½ç»™ä»£ç æ·»åŠ äº†æ›´å¤šçš„ç»“æ„ï¼Œä»¥ä¾¿æˆ‘èƒ½æ›´å¥½åœ°è¡¨è¾¾ä»£ç çš„æ„å›¾ã€‚

ä¸€èˆ¬æ¥è¯´ï¼Œé‡æ„æ—©æœŸçš„ä¸»è¦åŠ¨åŠ›æ˜¯å°è¯•ç†è§£ä»£ç å¦‚ä½•å·¥ä½œã€‚é€šå¸¸ä½ éœ€è¦å…ˆé€šè¯»ä»£ç ï¼Œæ‰¾åˆ°ä¸€äº›æ„Ÿè§‰ï¼Œç„¶åå†é€šè¿‡é‡æ„å°†è¿™äº›æ„Ÿè§‰ä»è„‘æµ·é‡Œæ¬å›åˆ°ä»£ç ä¸­ã€‚æ¸…æ™°çš„ä»£ç æ›´å®¹æ˜“ç†è§£ï¼Œä½¿ä½ èƒ½å¤Ÿå‘ç°æ›´æ·±å±‚æ¬¡çš„è®¾è®¡é—®é¢˜ï¼Œä»è€Œå½¢æˆç§¯ææ­£å‘çš„åé¦ˆç¯ã€‚å½“ç„¶ï¼Œè¿™ä¸ªç¤ºä¾‹ä»æœ‰å€¼å¾—æ”¹è¿›çš„åœ°æ–¹ï¼Œä½†ç°åœ¨æµ‹è¯•ä»èƒ½å…¨éƒ¨é€šè¿‡ï¼Œä»£ç ç›¸æ¯”åˆè§æ—¶å·²ç»æœ‰äº†å·¨å¤§çš„æ”¹å–„ï¼Œæ‰€ä»¥æˆ‘å·²ç»å¯ä»¥æ»¡è¶³äº†ã€‚

æˆ‘è°ˆè®ºçš„æ˜¯å¦‚ä½•æ”¹å–„ä»£ç ï¼Œä½†ä»€ä¹ˆæ ·çš„ä»£ç æ‰ç®—å¥½ä»£ç ï¼Œç¨‹åºå‘˜ä»¬æœ‰å¾ˆå¤šäº‰è®ºã€‚æˆ‘åçˆ±å°çš„ã€å‘½åè‰¯å¥½çš„å‡½æ•°ï¼Œä¹ŸçŸ¥é“æœ‰äº›äººåå¯¹è¿™ä¸ªè§‚ç‚¹ã€‚å¦‚æœæˆ‘ä»¬è¯´è¿™åªå…³ä¹ç¾å­¦ï¼Œåªæ˜¯å„èŠ±å…¥å„çœ¼ï¼Œæ²¡æœ‰å¥½åé«˜ä½ä¹‹åˆ†ï¼Œé‚£é™¤äº†è¯‰è¯¸ä¸ªäººå“å‘³ï¼Œå°±æ²¡æœ‰ä»»ä½•å®¢è§‚äº‹å®ä¾æ®äº†ã€‚ä½†æˆ‘åšä¿¡ï¼Œè¿™ä¸ä»…å…³ä¹ä¸ªäººå“å‘³ï¼Œè€Œä¸”æ˜¯æœ‰å®¢è§‚æ ‡å‡†çš„ã€‚æˆ‘è®¤ä¸ºï¼Œå¥½ä»£ç çš„æ£€éªŒæ ‡å‡†å°±æ˜¯äººä»¬æ˜¯å¦èƒ½è½»è€Œæ˜“ä¸¾åœ°ä¿®æ”¹å®ƒã€‚å¥½ä»£ç åº”è¯¥ç›´æˆªäº†å½“ï¼šæœ‰äººéœ€è¦ä¿®æ”¹ä»£ç æ—¶ï¼Œä»–ä»¬åº”èƒ½è½»æ˜“æ‰¾åˆ°ä¿®æ”¹ç‚¹ï¼Œåº”è¯¥èƒ½å¿«é€Ÿåšå‡ºæ›´æ”¹ï¼Œè€Œä¸æ˜“å¼•å…¥å…¶ä»–é”™è¯¯ã€‚ä¸€ä¸ªå¥åº·çš„ä»£ç åº“èƒ½å¤Ÿæœ€å¤§é™åº¦åœ°æå‡æˆ‘ä»¬çš„ç”Ÿäº§åŠ›ï¼Œæ”¯æŒæˆ‘ä»¬æ›´å¿«ã€æ›´ä½æˆæœ¬åœ°ä¸ºç”¨æˆ·æ·»åŠ æ–°ç‰¹æ€§ã€‚ä¸ºäº†ä¿æŒä»£ç åº“çš„å¥åº·ï¼Œå°±éœ€è¦æ—¶åˆ»ç•™æ„ç°çŠ¶ä¸ç†æƒ³ä¹‹é—´çš„å·®è·ï¼Œç„¶åé€šè¿‡é‡æ„ä¸æ–­æ¥è¿‘è¿™ä¸ªç†æƒ³ã€‚

::: tip
å¥½ä»£ç çš„æ£€éªŒæ ‡å‡†å°±æ˜¯äººä»¬æ˜¯å¦èƒ½è½»è€Œæ˜“ä¸¾åœ°ä¿®æ”¹å®ƒã€‚
:::

è¿™ä¸ªç¤ºä¾‹å‘Šè¯‰æˆ‘ä»¬æœ€é‡è¦çš„ä¸€ç‚¹å°±æ˜¯é‡æ„çš„èŠ‚å¥æ„Ÿã€‚æ— è®ºä½•æ—¶ï¼Œå½“æˆ‘å‘äººä»¬å±•ç¤ºæˆ‘å¦‚ä½•é‡æ„æ—¶ï¼Œæ— äººä¸è®¶å¼‚äºæˆ‘çš„æ­¥å­ä¹‹å°ï¼Œå¹¶ä¸”æ¯ä¸€æ­¥éƒ½ä¿è¯ä»£ç å¤„äºç¼–è¯‘é€šè¿‡å’Œæµ‹è¯•é€šè¿‡çš„å¯å·¥ä½œçŠ¶æ€ã€‚20 å¹´å‰ï¼Œå½“ Kent Beck åœ¨åº•ç‰¹å¾‹çš„ä¸€å®¶å®¾é¦†é‡Œå‘æˆ‘å±•ç¤ºåŒæ ·çš„æ‰‹æ³•æ—¶ï¼Œæˆ‘ä¹ŸæŠ¥ä»¥åŒæ ·çš„éœ‡æ’¼ã€‚å¼€å±•é«˜æ•ˆæœ‰åºçš„é‡æ„ï¼Œå…³é”®çš„å¿ƒå¾—æ˜¯ï¼šå°çš„æ­¥å­å¯ä»¥æ›´å¿«å‰è¿›ï¼Œè¯·ä¿æŒä»£ç æ°¸è¿œå¤„äºå¯å·¥ä½œçŠ¶æ€ï¼Œå°æ­¥ä¿®æ”¹ç´¯ç§¯èµ·æ¥ä¹Ÿèƒ½å¤§å¤§æ”¹å–„ç³»ç»Ÿçš„è®¾è®¡ã€‚è¿™å‡ ç‚¹è¯·å›ç‰¢è®°ï¼Œå…¶ä½™çš„æˆ‘å·²æ— éœ€å¤šè¨€ã€‚
