---
title: è£…é¥°å™¨æ¨¡å¼
tags: 
  - è£…é¥°å™¨
  - è®¾è®¡æ¨¡å¼
categories: 
  - ğŸ’»å·¥ä½œ
  - ğŸPython
  - å…¨æ ˆä¹‹è·¯
  - è®¾è®¡æ¨¡å¼
date: 2020-06-08 21:41:49
permalink: /python/patterns/decorator/
---
## æ³¨æ„
**è£…é¥°å™¨æ¨¡å¼ä¸ç­‰äºè£…é¥°å™¨**ã€‚

ä»¥æ”¯æŒåŠ¨æ€åœ°ï¼ˆè¿è¡Œæ—¶ï¼‰æ‰©å±•ä¸€ä¸ªå¯¹è±¡çš„åŠŸèƒ½ï¼Œè¿™ç§æ–¹æ³•å°±æ˜¯è£…é¥°å™¨ã€‚è£…é¥°å™¨ï¼ˆDecoratorï¼‰æ¨¡å¼èƒ½å¤Ÿä»¥é€æ˜çš„æ–¹å¼ï¼ˆä¸ä¼šå½±å“å…¶ä»–å¯¹è±¡ï¼‰åŠ¨æ€åœ°å°†åŠŸèƒ½æ·»åŠ åˆ°ä¸€ä¸ªå¯¹è±¡ä¸­ï¼ˆè¯·å‚è€ƒï¼»GOF95ï¼Œç¬¬196é¡µï¼½ï¼‰ã€‚
åœ¨è®¸å¤šç¼–ç¨‹è¯­è¨€ä¸­ï¼Œä½¿ç”¨å­ç±»åŒ–ï¼ˆç»§æ‰¿ï¼‰æ¥å®ç°è£…é¥°å™¨æ¨¡å¼ï¼ˆè¯·å‚è€ƒï¼»GOF95ï¼Œç¬¬198é¡µï¼½ï¼‰ã€‚
åœ¨Pythonä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ï¼ˆå¹¶ä¸”åº”è¯¥ï¼‰ä½¿ç”¨å†…ç½®çš„è£…é¥°å™¨ç‰¹æ€§ã€‚ä¸€ä¸ªPythonè£…é¥°å™¨å°±æ˜¯å¯¹Pythonè¯­æ³•çš„ä¸€ä¸ªç‰¹å®šæ”¹å˜ï¼Œç”¨äºæ‰©å±•ä¸€ä¸ªç±»ã€æ–¹æ³•æˆ–å‡½æ•°çš„è¡Œä¸ºï¼Œè€Œæ— éœ€ä½¿ç”¨ç»§æ‰¿ã€‚ä»å®ç°çš„è§’åº¦æ¥è¯´ï¼ŒPythonè£…é¥°å™¨æ˜¯ä¸€ä¸ªå¯è°ƒç”¨å¯¹è±¡ï¼ˆå‡½æ•°ã€æ–¹æ³•ã€ç±»ï¼‰ï¼Œæ¥å—ä¸€ä¸ªå‡½æ•°å¯¹è±¡finä½œä¸ºè¾“å…¥ï¼Œå¹¶è¿”å›å¦ä¸€ä¸ªå‡½æ•°å¯¹è±¡ ã€‚è¿™æ„å‘³ç€å¯ä»¥å°†ä»»ä½•å…·æœ‰è¿™äº›å±æ€§çš„å¯è°ƒç”¨å¯¹è±¡å½“ä½œä¸€ä¸ªè£…é¥°å™¨ã€‚
è£…é¥°å™¨æ¨¡å¼å’ŒPythonè£…é¥°å™¨ä¹‹é—´å¹¶ä¸æ˜¯ä¸€å¯¹ä¸€çš„ç­‰ä»·å…³ç³»ã€‚Pythonè£…é¥°å™¨èƒ½åšçš„å®é™…ä¸Šæ¯”è£…é¥°å™¨æ¨¡å¼å¤šå¾—å¤šï¼Œå…¶ä¸­ä¹‹ä¸€å°±æ˜¯å®ç°è£…é¥°å™¨æ¨¡å¼ã€‚

## ä½œç”¨
> Adds behaviour to object without affecting its class.

Decorator æ¨¡å¼ç”¨äºåŠ¨æ€åœ°å‘å¯¹è±¡æ·»åŠ æ–°ç‰¹æ€§ï¼Œè€Œä¸æ›´æ”¹å…¶åŸæ¥çš„ä»£ç å®ç°ã€‚å®ƒä¸ç»§æ‰¿ä¸åŒï¼Œæ–°ç‰¹æ€§åªç»‘å®šåˆ°ç‰¹å®šå¯¹è±¡ï¼Œè€Œä¸ä¼šæ·»åŠ åˆ°æ•´ä¸ªå­ç±»ã€‚

## ä¼˜ç¼ºç‚¹
### ä¼˜ç‚¹
1. ä½ æ— éœ€åˆ›å»ºæ–°å­ç±»å³å¯æ‰©å±•å¯¹è±¡çš„è¡Œä¸ºã€‚
2. ä½ å¯ä»¥åœ¨è¿è¡Œæ—¶æ·»åŠ æˆ–åˆ é™¤å¯¹è±¡çš„åŠŸèƒ½ã€‚
3. ä½ å¯ä»¥ç”¨å¤šä¸ªè£…é¥°å°è£…å¯¹è±¡æ¥ç»„åˆå‡ ç§è¡Œä¸ºã€‚
4. å•ä¸€èŒè´£åŸåˆ™ã€‚ ä½ å¯ä»¥å°†å®ç°äº†è®¸å¤šä¸åŒè¡Œä¸ºçš„ä¸€ä¸ªå¤§ç±»æ‹†åˆ†ä¸ºå¤šä¸ªè¾ƒå°çš„ç±»ã€‚
### ç¼ºç‚¹
1. åœ¨å°è£…å™¨æ ˆä¸­åˆ é™¤ç‰¹å®šå°è£…å™¨æ¯”è¾ƒå›°éš¾ã€‚
2. å®ç°è¡Œä¸ºä¸å—è£…é¥°æ ˆé¡ºåºå½±å“çš„è£…é¥°æ¯”è¾ƒå›°éš¾ã€‚
3. å„å±‚çš„åˆå§‹åŒ–é…ç½®ä»£ç çœ‹ä¸Šå»å¯èƒ½ä¼šå¾ˆç³Ÿç³•ã€‚

## ä»£ç 

```python
"""
*What is this pattern about?
The Decorator pattern is used to dynamically add a new feature to an
object without changing its implementation. It differs from
inheritance because the new feature is added only to that particular
object, not to the entire subclass.

*What does this example do?
This example shows a way to add formatting options (boldface and
italic) to a text by appending the corresponding tags (<b> and
<i>). Also, we can see that decorators can be applied one after the other,
since the original text is passed to the bold wrapper, which in turn
is passed to the italic wrapper.

*Where is the pattern used practically?
The Grok framework uses decorators to add functionalities to methods,
like permissions or subscription to an event:
http://grok.zope.org/doc/current/reference/decorators.html

*References:
https://sourcemaking.com/design_patterns/decorator

*TL;DR
Adds behaviour to object without affecting its class.
"""


class TextTag:
    """Represents a base text tag"""

    def __init__(self, text: str) -> None:
        self._text = text

    def render(self) -> str:
        return self._text


class BoldWrapper(TextTag):
    """Wraps a tag in <b>"""

    def __init__(self, wrapped: TextTag) -> None:
        self._wrapped = wrapped

    def render(self) -> str:
        return f"<b>{self._wrapped.render()}</b>"


class ItalicWrapper(TextTag):
    """Wraps a tag in <i>"""

    def __init__(self, wrapped: TextTag) -> None:
        self._wrapped = wrapped

    def render(self) -> str:
        return f"<i>{self._wrapped.render()}</i>"


def main():
    """
    >>> simple_hello = TextTag("hello, world!")
    >>> special_hello = ItalicWrapper(BoldWrapper(simple_hello))

    >>> print("before:", simple_hello.render())
    before: hello, world!

    >>> print("after:", special_hello.render())
    after: <i><b>hello, world!</b></i>
    """


if __name__ == "__main__":
    import doctest

    doctest.testmod()

```
ref: [patterns/structural/decorator.py Â· imoyao/python-patterns - Gitee.com](https://gitee.com/imoyao/python-patterns/blob/master/patterns/structural/decorator.py#)