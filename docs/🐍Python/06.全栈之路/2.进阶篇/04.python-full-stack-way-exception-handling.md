---
title: Python å…¨æ ˆä¹‹è·¯ç³»åˆ—ä¹‹å¼‚å¸¸å¤„ç†

tags: 
  - ç¼–ç 
  - å¼‚å¸¸å¤„ç†
  - Exception
  - except
top: 8
categories: 
  - ðŸ’»å·¥ä½œ
  - ðŸPython
  - å…¨æ ˆä¹‹è·¯
  - è¿›é˜¶ç¯‡
date: 2020-05-23 18:21:46
permalink: /pages/51552e/
---

å½“ç¨‹åºå‡ºçŽ°é”™è¯¯çš„æ—¶å€™ï¼Œè¿›è¡Œæ•æ‰ï¼Œç„¶åŽæ ¹æ®æ•æ‰åˆ°çš„é”™è¯¯ä¿¡æ¯è¿›è¡Œå¯¹åº”çš„å¤„ç†ã€‚

Even if a statement or expression is syntactically correct, it may cause an error when an attempt is made to execute it. Errors detected during execution are called exceptions and are not unconditionally fatal: you will soon learn how to handle them in Python programs.

## åˆè¯†å¼‚å¸¸å¤„ç†

å¦‚ä¸‹é¢çš„ä¾‹å­ï¼š

è®©ç”¨æˆ·è¿›è¡Œè¾“å…¥ï¼Œæç¤ºç”¨æˆ·è¾“å…¥ä¸€ä¸ªæ•°å­—ï¼Œå¦‚æžœè¾“å…¥çš„äº‹ä¸€ä¸ªæ•°å­—é‚£ä¸ªå°±æŠŠè¾“å…¥çš„æ•°å­—è½¬æ¢ä¸º`int`ç±»åž‹ï¼Œç„¶åŽè¾“å‡ºç”¨æˆ·è¾“å…¥çš„è€Œæ•°å­—ï¼Œå¦‚æžœç”¨æˆ·è¾“å…¥çš„ä¸æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œé‚£ä¹ˆç±»åž‹è½¬æ¢å°±ä¼šå‡ºé”™ï¼Œå¦‚æžœå‡ºé”™ï¼Œå°±æç¤ºç”¨æˆ·"è¾“å…¥ç±»åž‹é”™è¯¯ï¼Œä½ å› è¯¥è¾“å…¥çš„æ˜¯ä¸€ä¸ªæ•°å­—ã€‚"

```Python
#!/usr/bin/env python
# _*_coding:utf-8 _*_

try:
    n = int(input("è¯·è¾“å‡ºä¸€ä¸ªæ•°å­—>>> "))
    print("ä½ è¾“å…¥çš„æ•°å­—æ˜¯",n)
# eæ˜¯Exceptionçš„å¯¹è±¡ï¼ŒExceptionæ˜¯ä¸€ä¸ªç±»
except Exception as e:
    print("è¾“å…¥ç±»åž‹é”™è¯¯ï¼Œä½ å› è¯¥è¾“å…¥çš„æ˜¯ä¸€ä¸ªæ•°å­—ã€‚")
```
è¾“å‡º
```bash
ansheng@Darker:~$ python3 /home/ansheng/æ–‡æ¡£/Python_code/sublime/Week06/Day04/s2.py
è¯·è¾“å‡ºä¸€ä¸ªæ•°å­—>>> 123
ä½ è¾“å…¥çš„æ•°å­—æ˜¯ 123
ansheng@Darker:~$ python3 /home/ansheng/æ–‡æ¡£/Python_code/sublime/Week06/Day04/s2.py
è¯·è¾“å‡ºä¸€ä¸ªæ•°å­—>>> abc
è¾“å…¥ç±»åž‹é”™è¯¯ï¼Œä½ å› è¯¥è¾“å…¥çš„æ˜¯ä¸€ä¸ªæ•°å­—ã€‚
```
## å¼‚å¸¸åˆ†ç±»

å¸¸ç”¨å¼‚å¸¸

|å¼‚å¸¸å|è¯´æ˜Ž|
|:--:|:--|
|AttributeError|è¯•å›¾è®¿é—®ä¸€ä¸ªå¯¹è±¡æ²¡æœ‰çš„æ ‘å½¢ï¼Œæ¯”å¦‚ foo.xï¼Œä½†æ˜¯ foo æ²¡æœ‰å±žæ€§ x|
|IOError|è¾“å…¥/è¾“å‡ºå¼‚å¸¸ï¼›åŸºæœ¬ä¸Šæ˜¯æ— æ³•æ‰“å¼€æ–‡ä»¶|
|ImportError|æ— æ³•å¼•å…¥æ¨¡å—æˆ–åŒ…ï¼›åŸºæœ¬ä¸Šæ˜¯è·¯å¾„é—®é¢˜æˆ–åç§°é”™è¯¯|
|IndentationError|è¯­æ³•é”™è¯¯ï¼ˆçš„å­ç±»ï¼‰ ï¼›ä»£ç æ²¡æœ‰æ­£ç¡®å¯¹é½|
|IndexError|ä¸‹æ ‡ç´¢å¼•è¶…å‡ºåºåˆ—è¾¹ç•Œï¼Œæ¯”å¦‚å½“ x åªæœ‰ä¸‰ä¸ªå…ƒç´ ï¼Œå´è¯•å›¾è®¿é—® x[5]|
|KeyError|è¯•å›¾è®¿é—®å­—å…¸é‡Œä¸å­˜åœ¨çš„é”®|
|KeyboardInterrupt|Ctrl+C è¢«æŒ‰ä¸‹|
|NameError|ä½¿ç”¨ä¸€ä¸ªè¿˜æœªè¢«èµ‹äºˆå¯¹è±¡çš„å˜é‡|
|SyntaxError|Python ä»£ç éžæ³•ï¼Œä»£ç ä¸èƒ½ç¼–è¯‘(ä¸ªäººè®¤ä¸ºè¿™æ˜¯è¯­æ³•é”™è¯¯ï¼Œå†™é”™äº†ï¼‰|
|TypeError|ä¼ å…¥å¯¹è±¡ç±»åž‹ä¸Žè¦æ±‚çš„ä¸ç¬¦åˆ|
|UnboundLocalError|è¯•å›¾è®¿é—®ä¸€ä¸ªè¿˜æœªè¢«è®¾ç½®çš„å±€éƒ¨å˜é‡ï¼ŒåŸºæœ¬ä¸Šæ˜¯ç”±äºŽå¦æœ‰ä¸€ä¸ªåŒåçš„å…¨å±€å˜é‡ï¼Œå¯¼è‡´ä½ ä»¥ä¸ºæ­£åœ¨è®¿é—®å®ƒ|
|ValueError|ä¼ å…¥ä¸€ä¸ªè°ƒç”¨è€…ä¸æœŸæœ›çš„å€¼ï¼Œå³ä½¿å€¼çš„ç±»åž‹æ˜¯æ­£ç¡®çš„|

å¯¹ä¸åŒçš„å¼‚å¸¸è¿›è¡Œä¸åŒçš„å¤„ç†

```Python
try:
    n = int(input("è¯·è¾“å‡ºä¸€ä¸ªæ•°å­—>>> "))
except ValueError as e:
    print("ValueErroré”™è¯¯")
except Exception as e:
    print("å‡ºçŽ°å¼‚å¸¸")
```
è¾“å‡º
```bash
ansheng@Darker:~$ python3 /home/ansheng/æ–‡æ¡£/Python_code/sublime/Week06/Day04/s2.py
è¯·è¾“å‡ºä¸€ä¸ªæ•°å­—>>> 123
ansheng@Darker:~$ python3 /home/ansheng/æ–‡æ¡£/Python_code/sublime/Week06/Day04/s2.py
è¯·è¾“å‡ºä¸€ä¸ªæ•°å­—>>> asd
ValueErroré”™è¯¯
```

åœ¨å¤„ç†å¼‚å¸¸æ—¶ï¼Œå¦‚æžœå‡ºçŽ°é”™è¯¯ï¼Œé‚£ä¹ˆä¼šé¦–å…ˆåŒ¹é…`ValueError`ï¼Œç„¶åŽåœ¨åŒ¹é…`Exception`ã€‚

æ•èŽ·å¤šä¸ªé”™è¯¯

```python
try:
    raise IndexError('å‡ºé”™äº†')
except (IndexError, NameError) as e:  # æ•èŽ·æ‹¬å·å†…çš„é”™è¯¯ï¼Œå¹¶æŠŠé”™è¯¯ä¿¡æ¯èµ‹å€¼ç»™e
    print(e)
```

## é”™è¯¯å¼‚å¸¸çš„åŸºæœ¬ç»“æž„

```Python
try:
    # ä¸»ä»£ç å—
    pass
except KeyError as e:
    # å¼‚å¸¸æ—¶ï¼Œæ‰§è¡Œè¯¥å—
    pass
else:
    # ä¸»ä»£ç å—æ‰§è¡Œå®Œï¼Œæ‰§è¡Œè¯¥å—
    pass
finally:
    # æ— è®ºå¼‚å¸¸ä¸Žå¦ï¼Œæœ€ç»ˆæ‰§è¡Œè¯¥å—
    pass
```

**æ‰§è¡Œæµç¨‹ï¼š**

1. å¦‚æžœå‡ºçŽ°é”™è¯¯ï¼Œé‚£ä¹ˆå°±æ‰§è¡Œ`except`ä»£ç å—ï¼Œç„¶åŽåœ¨æ‰§è¡Œ`finally`
2. å¦‚æžœæ²¡æœ‰å‡ºçŽ°é”™è¯¯ï¼Œé‚£ä¹ˆå°±æ‰§è¡Œ`else`ä»£ç å—ï¼Œç„¶åŽå†æ‰§è¡Œ`finally`
3. ä¸ç®¡æœ‰æ²¡æœ‰å‡ºçŽ°å¼‚å¸¸éƒ½ä¼šæ‰§è¡Œ`finally`

## ä¸»åŠ¨å‡ºå‘å¼‚å¸¸

```Python
#!/usr/bin/env python
# _*_coding:utf-8 _*_

try:
    # raiseè¡¨ç¤ºä¸»åŠ¨å‡ºå‘å¼‚å¸¸ï¼Œç„¶åŽåˆ›å»ºä¸€ä¸ªExceptionå¯¹è±¡ï¼ŒExceptionæ‹¬å·å†…çš„å€¼å°±æ˜¯Exceptionå¯¹è±¡çš„å€¼
    raise Exception("ä¸»åŠ¨å‡ºå‘çš„å¼‚å¸¸")
except Exception as e:
    # è¾“å‡ºExceptionå¯¹è±¡çš„å€¼
    print(e)
```
è¾“å‡º
```bash
ansheng@Darker:~$ python3 /home/ansheng/æ–‡æ¡£/Python_code/sublime/Week06/Day04/s2.py
ä¸»åŠ¨å‡ºå‘çš„å¼‚å¸¸
```

å¦‚æžœéœ€è¦æ•èŽ·å’Œå¤„ç†ä¸€ä¸ªå¼‚å¸¸ï¼Œåˆä¸å¸Œæœ›å¼‚å¸¸åœ¨ç¨‹åºä¸­æ­»æŽ‰ï¼Œä¸€èˆ¬éƒ½ä¼šåˆ©ç”¨ raise ä¼ é€’å¼‚å¸¸

```python
>>> try:
...     raise IndexError('Index')
... except IndexError:
...     print('error')
...     raise
... 
error
Traceback (most recent call last):
  File "<stdin>", line 2, in <module>
IndexError: Index
```

## æ–­è¨€

å¦‚æžœæ¡ä»¶æˆç«‹åˆ™æˆç«‹ï¼Œå¦‚æžœæ¡ä»¶ä¸æˆç«‹åˆ™æŠ¥é”™ã€‚

```Python
# assertå…³é”®å­—ï¼ŒåŽé¢çš„æ˜¯æ¡ä»¶
>>> assert 1 == 1
>>> assert 1 == 2
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AssertionError
```

## è‡ªå®šä¹‰å¼‚å¸¸

ç”¨æˆ·è‡ªå®šä¹‰çš„å¼‚å¸¸é€šè¿‡ç±»ç¼–å†™ï¼Œä¸”é€šå¸¸éœ€è¦ç»§æ‰¿`Exception`å†…ç½®çš„å¼‚å¸¸ç±»ï¼ŒåŸºäºŽç±»çš„å¼‚å¸¸å…è®¸è„šæœ¬å»ºç«‹å¼‚å¸¸ç±»åž‹ã€ç»§æ‰¿è¡Œä¸ºä»¥åŠé™„åŠ çŠ¶æ€ä¿¡æ¯ã€‚

```python
>>> class Bar(Exception):
...     pass
... 
>>> 
>>> def doomed():
...     raise Bar()
... 
>>> 
>>> try:
...     doomed()
... except Bar as e:
...     print('error')
... 
error
```

å¦‚æžœè¦è‡ªå®šä¹‰é”™è¯¯æ˜¾ç¤ºä¿¡æ¯ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨ç±»ä¸­å®šä¹‰å­—ç¬¦ä¸²é‡è½½(`__str__`ï¼Œ`__repr__`)æ–¹æ³•ä¸­çš„å…¶ä¸­ä¸€ä¸ªå³å¯ï¼š

```python
>>> class MyError(Exception):
...     def __str__(self):
...         return 'å‡ºé”™å•¦.'
... 
>>> try:
...     raise MyError()
... except MyError as e:
...     print(e)
... 
å‡ºé”™å•¦.
```