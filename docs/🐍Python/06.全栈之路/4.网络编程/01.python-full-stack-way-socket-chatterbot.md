---
title: Python å…¨æ ˆä¹‹è·¯ç³»åˆ—ä¹‹åŸºäº socket å®ç°èŠå¤©æœºå™¨äºº

tags: 
  - ç¼–ç 
  - socket
top: 2
categories: 
  - ğŸ’»å·¥ä½œ
  - ğŸPython
  - å…¨æ ˆä¹‹è·¯
  - ç½‘ç»œç¼–ç¨‹
date: 2020-05-23 18:21:46
permalink: /pages/814166/
---

é€šè¿‡ socket å®ç°å±€åŸŸç½‘å†…çš„èŠå¤©å·¥å…·ã€‚

service.py æ–‡ä»¶å¦‚ä¸‹ï¼š

```Python
#!/usr/bin/env python
# _*_ coding:utf-8 _*_

import socket

# åˆ›å»ºä¸€ä¸ªsocketå¯¹è±¡
sk = socket.socket()

# ç»‘å®šå…è®¸è¿æ¥çš„IPåœ°å€å’Œç«¯å£
sk.bind(('127.0.0.1', 6053, ))

# æœåŠ¡ç«¯å…è®¸èµ·æ¥ä¹‹åï¼Œé™åˆ¶å®¢æˆ·ç«¯è¿æ¥çš„æ•°é‡ï¼Œå¦‚æœè¶…è¿‡äº”ä¸ªè¿æ¥ï¼Œç¬¬å…­ä¸ªè¿æ¥æ¥çš„æ—¶å€™ç›´æ¥æ–­å¼€ç¬¬å…­ä¸ªã€‚
sk.listen(5)

while True:
    # ä¼šä¸€ç›´é˜»å¡ï¼Œç­‰å¾…æ¥æ”¶å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œå¦‚æœæœ‰å®¢æˆ·ç«¯è¿æ¥ä¼šè·å–ä¸¤ä¸ªå€¼ï¼Œconn=åˆ›å»ºçš„è¿æ¥ï¼Œaddress=å®¢æˆ·ç«¯çš„IPå’Œç«¯å£
    conn, address = sk.accept()

    # å½“ç”¨æˆ·è¿æ¥è¿‡æ¥çš„æ—¶å€™å°±ç»™ç”¨æˆ·å‘é€ä¸€æ¡ä¿¡æ¯ï¼Œåœ¨Python3é‡Œé¢éœ€è¦æŠŠå‘é€çš„å†…å®¹è½¬æ¢ä¸ºå­—èŠ‚
    conn.sendall(bytes("ä½ å¥½ï¼Œæ¬¢è¿ç™»é™†ï¼", encoding="utf-8"))

    while True:
        # è¾“å‡ºç­‰å¾…å®¢æˆ·ç«¯å‘é€å†…å®¹
        print("æ­£åœ¨ç­‰å¾…Clientè¾“å…¥å†…å®¹......")
        # æ¥æ”¶å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„å†…å®¹
        ret_bytes = conn.recv(1024)
        # è½¬æ¢æˆå­—ç¬¦ä¸²ç±»å‹
        ret_str = str(ret_bytes, encoding="utf-8")
        # è¾“å‡ºç”¨æˆ·å‘é€è¿‡æ¥çš„å†…å®¹
        print(ret_str)

        # å¦‚æœç”¨æˆ·è¾“å…¥çš„æ˜¯q
        if ret_str == "q":
            # åˆ™é€€å‡ºå¾ªç¯ï¼Œç­‰å¾…ä¸‹ä¸ªç”¨æˆ·è¾“å…¥
            break
        # ç»™å®¢æˆ·ç«¯å‘é€å†…å®¹
        inp = input("Serviceè¯·è¾“å…¥è¦å‘é€çš„å†…å®¹>>> ")
        conn.sendall(bytes(inp, encoding="utf-8"))
```

---

client.py æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š

```Python
#!/usr/bin/env python
# _*_ coding:utf-8 _*_

import socket

# åˆ›å»ºä¸€ä¸ªsocketå¯¹è±¡
obj = socket.socket()

# åˆ¶å®šæœåŠ¡ç«¯çš„IPåœ°å€å’Œç«¯å£
obj.connect(('127.0.0.1', 6053, ))

# é˜»å¡ï¼Œç­‰å¾…æœåŠ¡ç«¯å‘é€å†…å®¹ï¼Œæ¥å—æœåŠ¡ç«¯å‘é€è¿‡æ¥çš„å†…å®¹ï¼Œæœ€å¤§æ¥å—1024å­—èŠ‚
ret_bytes = obj.recv(1024)

# å› ä¸ºæœåŠ¡ç«¯å‘é€è¿‡æ¥çš„æ˜¯å­—èŠ‚ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æŠŠå­—èŠ‚è½¬æ¢ä¸ºå­—ç¬¦ä¸²è¿›è¡Œè¾“å‡º
ret_str = str(ret_bytes, encoding="utf-8")

# è¾“å‡ºå†…å®¹
print(ret_str)

while True:
    # å½“è¿›å…¥è¿æ¥çš„æ—¶å€™ï¼Œæç¤ºè®©ç”¨æˆ·è¾“å…¥å†…å®¹
    inp = input("Clientè¯·è¾“å…¥è¦å‘é€çš„å†…å®¹>>> ")
    # å¦‚æœè¾“å‡ºqåˆ™é€€å‡º
    if inp == "q":
        # æŠŠqå‘é€ç»™æœåŠ¡ç«¯
        obj.sendall(bytes(inp, encoding="utf-8"))
        # é€€å‡ºå½“å‰while
        break
    else:
        # å¦åˆ™å°±æŠŠç”¨æˆ·è¾“å…¥çš„å†…å®¹å‘é€ç»™ç”¨æˆ·
        obj.sendall(bytes(inp, encoding="utf-8"))
        # ç­‰å¾…æœåŠ¡ç«¯å›ç­”
        print("æ­£åœ¨ç­‰å¾…Serverè¾“å…¥å†…å®¹......")
        # è·å–æœåŠ¡ç«¯å‘é€è¿‡æ¥çš„ç»“æœ
        ret = str(obj.recv(1024), encoding="utf-8")
        # è¾“å‡ºç»“æœ
        print(ret)

# è¿æ¥å®Œæˆä¹‹åå…³é—­é“¾æ¥
obj.close()
```

æ‰§è¡Œç»“æœ

![socket-02](https://ansheng.me/wp-content/uploads/2016/12/1483021707.png)