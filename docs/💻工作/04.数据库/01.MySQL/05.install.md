---
title: ä½¿ç”¨æ¸…åæºå®‰è£… MySQL
date: 2020-12-25 12:55:13
permalink: /mysql/install/
categories:
  - ğŸ’»å·¥ä½œ
  - æ•°æ®åº“
  - MySQL
tags:
  - MySQL
---

## Yum å®‰è£…
1.  å¸è½½ä¹‹å‰çš„ MySQLï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰
```bash    
pkill -9 mysqld  # åœæ­¢MySQL
rpm -qa | grep -i mysql # åˆ—å‡ºç°æœ‰çš„MySQLå®‰è£…åŒ…
yum -y remove åŒ…å # ä½¿ç”¨è¿™ä¸ªå‘½ä»¤åˆ é™¤åˆ—å‡ºæ¥çš„åŒ…å
rpm -ev  åŒ…å # å¦‚æœyumåˆ é™¤ä¸äº†,å°±ç”¨è¿™ä¸ªå‘½ä»¤åˆ 
```
2.  ä¸‹è½½ MySQL æº
```bash  
wget http://repo.mysql.com/mysql57-community-release-el7-8.noarch.rpm 
rpm -ivh mysql57-community-release-el7-8.noarch.rpm 
```
3.  æ›¿æ¢æ¸…åæº
æ ¹æ®è¿™ä¸ªåœ°å€ `https://mirror.tuna.tsinghua.edu.cn/help/centos/` è®¾ç½®æ¸…åå¤§å­¦çš„æºï¼Œæ³¨æ„æŠŠ `gpgcheck=1` æ”¹ä¸º `gpgcheck=0` ï¼Œ å¦åˆ™å®‰è£…ä¼šå¤±è´¥
```plain
# CentOS-Base.repo
#
# The mirror system uses the connecting IP address of the client and the
# update status of each mirror to pick mirrors that are updated to and
# geographically close to the client.  You should use this for CentOS updates
# unless you are manually picking other mirrors.
#
# If the mirrorlist= does not work for you, as a fall back you can try the
# remarked out baseurl= line instead.
#
#


[base]
name=CentOS-$releasever - Base
baseurl=https://mirrors.tuna.tsinghua.edu.cn/centos/$releasever/os/$basearch/
#mirrorlist=http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo=os
enabled=1
gpgcheck=0
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-7

#released updates
[updates]
name=CentOS-$releasever - Updates
baseurl=https://mirrors.tuna.tsinghua.edu.cn/centos/$releasever/updates/$basearch/
#mirrorlist=http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo=updates
enabled=1
gpgcheck=0
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-7



#additional packages that may be useful
[extras]
name=CentOS-$releasever - Extras
baseurl=https://mirrors.tuna.tsinghua.edu.cn/centos/$releasever/extras/$basearch/
#mirrorlist=http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo=extras
enabled=1
gpgcheck=0
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-7


#additional packages that extend functionality of existing packages
[centosplus]
name=CentOS-$releasever - Plus
baseurl=https://mirrors.tuna.tsinghua.edu.cn/centos/$releasever/centosplus/$basearch/
#mirrorlist=http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo=centosplus
gpgcheck=0
enabled=0
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-7

```
4. æ‰§è¡Œå®‰è£…
```bash
yum -y install mysql-server 
```
5. å¯åŠ¨æœåŠ¡
```bash
systemctl enable mysqld
systemctl start mysqld
```
::: error
å¦‚æœå¯åŠ¨æœåŠ¡æŠ¥é”™ï¼Œ
1. å¦‚æœæ˜¯ SELinux é—®é¢˜ï¼Œè¯·å‚é˜…[è§£å†³ Linux-Centos7 å¯åŠ¨ Mysql æœåŠ¡å¤±è´¥_ç¼–ç¨‹æ¸£-ç‹çˆ½-CSDN åšå®¢](https://blog.csdn.net/wsh_0703/article/details/80278370)
2. `datadir`ä¸å¯¹
```plain
2020-12-25T05:54:16.053547Z 0 [Warning] Failed to open optimizer cost constant tables

2020-12-25T05:54:16.053696Z 0 [ERROR] Fatal error: Can't open and lock privilege tables: Table 'mysql.user' doesn't exist
2020-12-25T05:54:16.053715Z 0 [ERROR] Fatal error: Failed to initialize ACL/grant/time zones structures or failed to remove temporary table files.
2020-12-25T05:54:16.053760Z 0 [ERROR] Aborting

```
ä¿®æ”¹`/etc/my.conf`ä¸­çš„`datadir=/var/lib/mysql/mysql`ï¼Œæ ¹æ®å®é™…ä¿®æ”¹
å‚é˜…ï¼š[Can't open and lock privilege tables: Table 'mysql.user' doesn't exist - Stack Overflow](https://stackoverflow.com/questions/34516664/cant-open-and-lock-privilege-tables-table-mysql-user-doesnt-exist)
:::
6. ä»¥åŸå§‹å¯†ç ç™»å½•
```bash
grep 'password' /var/log/mysqld.log # ä»è¿™é‡Œæ‹¿åˆ°åˆå§‹åŒ–çš„å¯†ç 
mysql -uroot -p # ç™»å½•
```
7. ä¿®æ”¹å¯†ç å®‰å…¨ç­–ç•¥
åœ¨æµ‹è¯•ç¯å¢ƒä½¿ç”¨ï¼Œå¯†ç å¯ä»¥å¼„ç®€å•ç‚¹ï¼Œç”Ÿäº§å»ºè®®éœ€è¦è®¾ç½®å¤æ‚
```bash
set global validate_password_length=0; # å¯†ç æœ€å°é•¿åº¦ç­–ç•¥
set global validate_password_policy=0; # å¯†ç å¼ºåº¦æ£€æŸ¥ç­‰çº§ç­–ç•¥ï¼Œ0/LOWã€1/MEDIUMã€2/STRONG
set password for 'root'@'localhost' = password('123456');   # å¯†ç ä¿®æ”¹ä¸ºçœŸå®å®é™…å¯†ç 
```
å‚è€ƒé…ç½®ï¼š
```plain
[mysqld]
#
# Remove leading # and set to the amount of RAM for the most important data
# cache in MySQL. Start at 70% of total RAM for dedicated server, else 10%.
# innodb_buffer_pool_size = 128M
#
# Remove leading # to turn on a very important data integrity option: logging
# changes to the binary log between backups.
# log_bin
#
# Remove leading # to set options mainly useful for reporting servers.
# The server defaults are faster for transactions and fast SELECTs.
# Adjust sizes as needed, experiment to find the optimal values.
# join_buffer_size = 128M
# sort_buffer_size = 2M
# read_rnd_buffer_size = 2M
datadir=/var/lib/mysql/mysql
socket=/var/lib/mysql/mysql.sock

# Disabling symbolic-links is recommended to prevent assorted security risks
symbolic-links=0

log-error=/var/log/mysqld.log
pid-file=/var/run/mysqld/mysqld.pid
# ç¼–ç 
character_set_server=utf8 
init_connect='SET NAMES utf8'
```
8. å¼€å¯ mysql è¿œç¨‹è¿æ¥ï¼ˆå¯é€‰ï¼‰
```bash
GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' IDENTIFIED BY '123456' WITH GRANT OPTION;
flush privileges;
```
9. æ”¾å¼€æœåŠ¡å™¨ç«¯å£æƒé™ï¼ˆå¦‚æœé€‰æ‹©ä¸Šæ­¥ï¼‰
```bash
firewall-cmd --zone=public --add-port=3306/tcp --permanent
firewall-cmd --reload
```
## å‚è€ƒé“¾æ¥
- [CentOS å®‰è£… MySQL è¯¦è§£](https://juejin.cn/post/6844903870053761037)
- [CentOS7 ä¸‹å®‰è£… mysql5.7_ä¸ç”˜äºå¹³å‡¡çš„æºƒè´¥çš„åšå®¢-CSDN åšå®¢_centos7 å®‰è£… mysql5.7](https://blog.csdn.net/wohiusdashi/article/details/89358071)