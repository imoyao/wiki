---
title: ä½¿ç”¨ SSH è¿æ¥åˆ° GitHub
date: 2020-12-06 10:16:16
tags: 
  - GitHub
  - Git
  - SSH
  - ssh_agent
  - ssh_key
categories: 
  - ğŸ’»å·¥ä½œ
  - Git
permalink: /pages/db03c4/
---
## å‰è¨€
ç»ˆäºåŒçƒ¦äº†æ¯ä¸€æ¬¡å¾€è¿œç¨‹ä»“åº“æ¨é€ä»£ç æ—¶éƒ½è¦æ‰‹åŠ¨è¾“å…¥ç”¨æˆ·åå’Œå¯†ç éªŒè¯ä¸ªäººä¿¡æ¯ï¼Œæ‰€ä»¥é…ç½®äº†ä¸€ä¸‹ SSH è®¤è¯ã€‚

## [å…³äº SSH](https://docs.github.com/cn/free-pro-team@latest/github/authenticating-to-github/about-ssh)

::: tip INFO

SSH ä¸º Secure Shell çš„ç¼©å†™ï¼Œç”± IETF çš„ç½‘ç»œå°ç»„ï¼ˆNetwork Working Groupï¼‰æ‰€åˆ¶å®šï¼›SSH ä¸ºå»ºç«‹åœ¨åº”ç”¨å±‚åŸºç¡€ä¸Šçš„å®‰å…¨åè®®ã€‚

:::

ä½¿ç”¨ SSH åè®®å¯ä»¥è¿æ¥è¿œç¨‹æœåŠ¡å™¨å’ŒæœåŠ¡å¹¶å‘å®ƒä»¬éªŒè¯ã€‚ åˆ©ç”¨ SSH å¯†é’¥å¯ä»¥è¿æ¥ GitHubï¼Œè€Œæ— éœ€åœ¨æ¯æ¬¡è®¿é—®æ—¶éƒ½æä¾›ç”¨æˆ·åå’Œä¸ªäººè®¿é—®ä»¤ç‰Œã€‚


## [æ£€æŸ¥ç°æœ‰ SSH å¯†é’¥â†’](https://docs.github.com/cn/free-pro-team@latest/github/authenticating-to-github/checking-for-existing-ssh-keys)

åœ¨ç”Ÿæˆ SSH å¯†é’¥ä¹‹å‰ï¼Œæ‚¨å¯ä»¥æ£€æŸ¥æ˜¯å¦æœ‰ä»»ä½•ç°æœ‰çš„ SSH å¯†é’¥ã€‚

## [ç”Ÿæˆæ–° SSH å¯†é’¥å¹¶æ·»åŠ åˆ° ssh-agentâ†’](https://docs.github.com/cn/free-pro-team@latest/github/authenticating-to-github/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent)

æ£€æŸ¥ç°æœ‰ SSH å¯†é’¥åï¼Œæ‚¨å¯ä»¥ç”Ÿæˆæ–° SSH å¯†é’¥ä»¥ç”¨äºèº«ä»½éªŒè¯ï¼Œç„¶åå°†å…¶æ·»åŠ åˆ° ssh-agentã€‚

## [æ–°å¢ SSH å¯†é’¥åˆ° GitHub å¸æˆ·â†’](https://docs.github.com/cn/free-pro-team@latest/github/authenticating-to-github/adding-a-new-ssh-key-to-your-github-account)

è¦é…ç½® GitHub å¸æˆ·ä½¿ç”¨æ–°çš„ï¼ˆæˆ–ç°æœ‰ï¼‰SSH å¯†é’¥ï¼Œæ‚¨è¿˜éœ€è¦å°†å…¶æ·»åŠ åˆ° GitHub å¸æˆ·ã€‚

## [æµ‹è¯• SSH è¿æ¥â†’](https://docs.github.com/cn/free-pro-team@latest/github/authenticating-to-github/testing-your-ssh-connection)

è®¾ç½® SSH å¯†é’¥å¹¶å°†å…¶æ·»åŠ åˆ°æ‚¨çš„ GitHub å¸æˆ·åï¼Œæ‚¨å¯ä»¥æµ‹è¯•è¿æ¥ã€‚

## [ä½¿ç”¨ SSH å¯†é’¥å¯†ç â†’](https://docs.github.com/cn/free-pro-team@latest/github/authenticating-to-github/working-with-ssh-key-passphrases)

æ‚¨å¯ä»¥ä¿æŠ¤ SSH å¯†é’¥å¹¶é…ç½®èº«ä»½éªŒè¯ä»£ç†ï¼Œè¿™æ ·æ‚¨å°±ä¸å¿…åœ¨æ¯æ¬¡ä½¿ç”¨ SSH å¯†é’¥æ—¶é‡æ–°è¾“å…¥å¯†ç ã€‚

## å…¶ä»–

### ä¹‹å‰ä½¿ç”¨ https å…‹éš†

å¯¹äºå·²ç»å…‹éš†åˆ°æœ¬åœ°çš„ https ç±»å‹ä»“åº“ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹ git é…ç½®çš„æ–¹å¼å®ç° SSH è¿æ¥åˆ°è¿œç¨‹ä»“åº“ã€‚
```plain
vim .git/config
```
åƒä¸‹é¢æ”¹ url
```plain
[remote "origin"]
url = git@github.com:hpcpp/hello-world.git
```

### Permission denied
```bash
ssh -T git@github.com
git@github.com: Permission denied (publickey).
```
ç›´æ¥æ·»åŠ åˆšæ‰æ–°å¢çš„ key
```bash
ssh-add ~/.ssh/id_imoyao  # æ›¿æ¢æˆä½ è‡ªå·±çš„ key
```

### Could not open a connection to your authentication agent
```bash
ssh-agent bash
```
### æ¯æ¬¡å¼€æœºè‡ªå¯åŠ¨ ssh_agent

**Windows** ä¸Š **è‡ªåŠ¨å¯åŠ¨ git-agent** ä»¥åŠ **è‡ªåŠ¨åŠ è½½ SSH Key** çš„æ–¹æ³•

è¿™é‡Œçš„ **è‡ªåŠ¨** æŒ‡çš„æ˜¯ï¼Œæ¯æ¬¡å¯åŠ¨ **Git Bash** è¿™ä¸ªå®¢æˆ·ç«¯æ—¶

1. æ–°å»ºæ–‡ä»¶ `~/.profile` ï¼Œå³ `/c/Users/XXX/profile` ï¼Œç„¶åå†™å…¥å¦‚ä¸‹å†…å®¹

```bash
env=~/.ssh/agent.env  
  
agent_load_env () { test -f "$env" && . "$env" >| /dev/null ; }  
  
agent_start () {  
 (umask 077; ssh-agent >| "$env")  
 . "$env" >| /dev/null ; }  
  
agent_load_env  
  
# agent_run_state: 0=agent running w/ key; 1=agent w/o key; 2= agent not running  
agent_run_state=$(ssh-add -l >| /dev/null 2>&1; echo $?)  
  
if [ ! "$SSH_AUTH_SOCK" ] || [ $agent_run_state = 2 ]; then  
 agent_start  
 ssh-add  
 ssh-add ~/.ssh/github  # å¦‚æœè‡ªå®šä¹‰äº† key çš„åå­—æˆ–è€…è·¯å¾„ï¼Œåˆ™éœ€è¦å†™åœ¨è¿™é‡Œ  
 ssh-add ~/.ssh/coding  
elif [ "$SSH_AUTH_SOCK" ] && [ $agent_run_state = 1 ]; then  
 ssh-add  
 ssh-add ~/.ssh/github  # å¦‚æœè‡ªå®šä¹‰äº† key çš„åå­—æˆ–è€…è·¯å¾„ï¼Œåˆ™éœ€è¦å†™åœ¨è¿™é‡Œ  
 ssh-add ~/.ssh/coding  
fi  
  
unset env  
```
2. åœ¨æ–°å¼€ **Git Bash** æ—¶ï¼Œå¦‚æœçœ‹åˆ°å¦‚ä¸‹ä¿¡æ¯ï¼Œè¡¨ç¤º **ssh-agent** æ‰“å¼€æˆåŠŸï¼Œ**SSH Key** åŠ è½½æˆåŠŸã€‚

```plain
Identity added: /c/Users/XXX/.ssh/id_rsa (/c/Users/XXX/.ssh/id_rsa)  
Identity added: /c/Users/XXX/.ssh/github (/c/Users/XXX/.ssh/github)  
Identity added: /c/Users/XXX/.ssh/coding (/c/Users/XXX/.ssh/coding)  
```
3. ç„¶åï¼Œå¯ä»¥é€šè¿‡ `ssh -T` å‘½ä»¤æ‰æµ‹è¯•ä¸€ä¸‹ï¼Œçœ‹åˆ°å¦‚ä¸‹ä¿¡æ¯è¡¨ç¤ºæ·»åŠ æµ‹è¯•é€šè¿‡ã€‚

```bash
$ ssh -T git@github.com  
Hi XXX! You've successfully authenticated, but GitHub does not provide shell access.  

$ ssh -T git@git.coding.net  
Warning: Permanently added the RSA host key for IP address '123.XX.XX.XX' to the list of known hosts.  
Coding æç¤º: Hello XXX, You've connected to Coding.net via SSH. This is a personal key.  
```
XXXï¼Œä½ å¥½ï¼Œä½ å·²ç»é€šè¿‡ SSH åè®®è®¤è¯ Coding.net æœåŠ¡ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸ªäººå…¬é’¥

## å¯†ç æ”¹ token è®¤è¯

- å·²å­˜åœ¨é¡¹ç›®
  ```bash
  git remote remove origin
  git remote add origin https://<USERNAME>:<TOKEN>@<GIT_URL>.git
  git pull # verify
  ```
- å…‹éš†æ–°é¡¹ç›®
  ```bash
  git clone https://<USERNAME>:<TOKEN>@<GIT_URL>.git
  ```

## å‚è€ƒé“¾æ¥
- [ä½¿ç”¨ SSH è¿æ¥åˆ° GitHub - GitHub Docs](https://docs.github.com/cn/free-pro-team@latest/github/authenticating-to-github/connecting-to-github-with-ssh) 
- [GitHub æ•™ç¨‹ SSH keys é…ç½®_LolitaSian-CSDN åšå®¢](https://blog.csdn.net/qq_36667170/article/details/79094257)  
- [é€šè¿‡ SSH æ“ä½œ Git ç»ˆææ•™ç¨‹ | zcdll's Blog](https://zcdll.github.io/2018/01/10/git-ssh/)  
