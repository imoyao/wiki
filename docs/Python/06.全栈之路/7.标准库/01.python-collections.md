---
title: Python æ ‡å‡†åº“ç³»åˆ—ä¹‹ collections æ¨¡å—

tags: 
  - ç¼–ç 
  - é¢å‘å¯¹è±¡
top: 16
categories: 
  - ğŸ’» å·¥ä½œ
  - ğŸPython
  - å…¨æ ˆä¹‹è·¯
  - æ ‡å‡†åº“
date: 2020-05-23 18:21:46
permalink: /pages/b904d0/
---
## å¼•è¨€

Python ä½œä¸ºä¸€ä¸ªâ€œå†…ç½®ç”µæ± â€çš„ç¼–ç¨‹è¯­è¨€ï¼Œæ ‡å‡†åº“é‡Œé¢æ‹¥æœ‰éå¸¸å¤šå¥½ç”¨çš„æ¨¡å—ã€‚æ¯”å¦‚ä»Šå¤©æƒ³ç»™å¤§å®¶ä»‹ç»çš„ collections å°±æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„ä¾‹å­ã€‚

> å®˜æ–¹æ–‡æ¡£ï¼šhttps://docs.python.org/3/library/collections.html

This module implements specialized container datatypes providing alternatives to Pythonâ€™s general purpose built-in containers, dict, list, set, and tuple.
## åŸºæœ¬ä»‹ç»
æˆ‘ä»¬éƒ½çŸ¥é“ï¼ŒPython æ‹¥æœ‰ä¸€äº›å†…ç½®çš„æ•°æ®ç±»å‹ï¼Œæ¯”å¦‚ str, int, list, tuple, dict ç­‰ï¼Œ collections æ¨¡å—åœ¨è¿™äº›å†…ç½®æ•°æ®ç±»å‹çš„åŸºç¡€ä¸Šï¼Œæä¾›äº†å‡ ä¸ªé¢å¤–çš„æ•°æ®ç±»å‹ï¼š
- namedtuple(): ç”Ÿæˆå¯ä»¥ä½¿ç”¨åå­—æ¥è®¿é—®å…ƒç´ å†…å®¹çš„ tuple å­ç±»
- deque: åŒç«¯é˜Ÿåˆ—ï¼Œå¯ä»¥å¿«é€Ÿçš„ä»å¦å¤–ä¸€ä¾§è¿½åŠ å’Œæ¨å‡ºå¯¹è±¡
- Counter: è®¡æ•°å™¨ï¼Œä¸»è¦ç”¨æ¥è®¡æ•°
- OrderedDict: æœ‰åºå­—å…¸
- defaultdict: å¸¦æœ‰é»˜è®¤å€¼çš„å­—å…¸
## namedtuple

å·¥å‚å‡½æ•°ï¼Œç”¨äºåˆ›å»ºå…·æœ‰å‘½åå­—æ®µçš„å…ƒç»„å­ç±»ï¼Œé€šå¸¸ç”¨æ¥å¢å¼ºä»£ç çš„å¯è¯»æ€§ï¼Œ åœ¨è®¿é—®ä¸€äº› tuple ç±»å‹çš„æ•°æ®æ—¶å°¤å…¶å¥½ç”¨ã€‚

- è¯­æ³•

```python
namedtuple(typename, field_names, *, verbose=False, rename=False, module=None)
```

- Example

```python
# å¯¼å…¥namedtuple
>>> from collections import namedtuple
# åˆ›å»ºä¸€ä¸ªç”¨æˆ·ç±»ï¼Œæ‹¥æœ‰name,age,sexå±æ€§
>>> User = namedtuple("User", ["name","age","sex"])
>>> user1 = User("as","22","ç”·")
>>> user1
User(name='as', age='22', sex='ç”·')
# é€šè¿‡å±æ€§è¿›è¡Œè®¿é—®
>>> user1.name
'as'
>>> user1.age
'22'
>>> user1.sex
'ç”·'
# æ‹†åŒ…
>>> name, age, sex = user1
>>> name, age, sex
('as', '22', 'ç”·')
# namedtupleè½¬æ¢ä¸ºå­—å…¸
>>> user1._asdict()
OrderedDict([('name', 'as'), ('age', '22'), ('sex', 'ç”·')])
# åˆå§‹åŒ–æ—¶ä¹Ÿå¯ä»¥ä¼ å…¥ä¸€ä¸ªå­—å…¸
>>> user_info_dict = {"name":"ansheng","age":"20","sex":"ç”·"}
>>> User(**user_info_dict)
User(name='ansheng', age='20', sex='ç”·')
# ä¼ å…¥ä¸€ä¸ªå¯è¿­ä»£çš„
>>> user_info_list = ["ansheng","20","å¥³"]
>>> User(*user_info_list)
User(name='ansheng', age='20', sex='å¥³')
>>> user_info_list = ["ansheng","20"]
>>> User(*user_info_list,"ç”·")
User(name='ansheng', age='20', sex='ç”·')
# _makeæ–¹æ³•
>>> User._make(["as", 20, "ç”·"])
User(name='as', age=20, sex='ç”·')
```

## deque
### deque

deque å…¶å®æ˜¯ double-ended queue çš„ç¼©å†™ï¼Œç¿»è¯‘è¿‡æ¥å°±æ˜¯åŒç«¯é˜Ÿåˆ—ï¼Œå®ƒæœ€å¤§çš„å¥½å¤„å°±æ˜¯å®ç°äº†ä»é˜Ÿåˆ— å¤´éƒ¨å¿«é€Ÿå¢åŠ å’Œå–å‡ºå¯¹è±¡: .popleft(), .appendleft() ã€‚

ä½ å¯èƒ½ä¼šè¯´ï¼ŒåŸç”Ÿçš„ list ä¹Ÿå¯ä»¥ä»å¤´éƒ¨æ·»åŠ å’Œå–å‡ºå¯¹è±¡å•Šï¼Ÿåƒè¿™æ ·ï¼š
```python
l.insert(0, v)
l.pop(0) 
```
ä½†æ˜¯å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œlist çš„è¿™ä¸¤ç§ç”¨æ³•çš„**æ—¶é—´å¤æ‚åº¦*æ˜¯ O(n) ï¼Œä¹Ÿå°±æ˜¯è¯´éšç€å…ƒç´ æ•°é‡çš„å¢åŠ è€—æ—¶å‘ˆ çº¿æ€§ä¸Šå‡ã€‚è€Œä½¿ç”¨ deque å¯¹è±¡åˆ™æ˜¯ O(1) çš„å¤æ‚åº¦ï¼Œæ‰€ä»¥å½“ä½ çš„ä»£ç æœ‰è¿™æ ·çš„éœ€æ±‚çš„æ—¶å€™ï¼Œ ä¸€å®šè¦è®°å¾—ä½¿ç”¨ dequeã€‚

ä½œä¸ºä¸€ä¸ªåŒç«¯é˜Ÿåˆ—ï¼Œdeque è¿˜æä¾›äº†ä¸€äº›å…¶ä»–çš„å¥½ç”¨æ–¹æ³•ï¼Œæ¯”å¦‚ rotate ç­‰ã€‚

- Example1
```python
# -*- coding: utf-8 -*-
"""
ä¸‹é¢è¿™ä¸ªæ˜¯ä¸€ä¸ªæœ‰è¶£çš„ä¾‹å­ï¼Œä¸»è¦ä½¿ç”¨äº†dequeçš„rotateæ–¹æ³•æ¥å®ç°äº†ä¸€ä¸ªæ— é™å¾ªç¯
çš„åŠ è½½åŠ¨ç”»
"""
import sys
import time
from collections import deque

fancy_loading = deque('>--------------------')

while True:
    print 'r%s' % ''.join(fancy_loading),
    fancy_loading.rotate(1)
    sys.stdout.flush()
    time.sleep(0.08)

# Result:

# ä¸€ä¸ªæ— å°½å¾ªç¯çš„è·‘é©¬ç¯
------------->-------
```
- Example2

```python
>>> from collections import deque
>>> users_deque = deque(["user1", "user2", "user3"], maxlen=10)
>>> users_deque.appendleft("user4")
>>> users_deque.append("user4")
>>> users_deque
deque(['user4', 'user1', 'user2', 'user3', 'user4'], maxlen=10)
```

## ChainMap

dict-like class for creating a single view of multiple mappings

- Example

```python
>>> from collections import ChainMap
>>> dict1 = {"a": "a", "b": "b"}
>>> dict2 = {"c": "c", "d": "d"}
>>> new_dict = ChainMap(dict1, dict2)
>>> new_dict.maps
[{'a': 'a', 'b': 'b'}, {'c': 'c', 'd': 'd'}]
>>> for key, value in new_dict.items():
...     print(key, value)
...
a a
b b
d d
c c
```


## Counter

ç»Ÿè®¡å…ƒç´ å‡ºç°çš„æ¬¡æ•°

- Example

```python
>>> from collections import Counter
# æ‹¥æŒ¤è‹±æ–‡å­—æ¯å‡ºç°çš„æ¬¡æ•°
>>> letters = ["A", "A", "B", "C", "A", "H", "D", "B"]
>>> letters_counter = Counter(letters)
>>> letters_counter.update(["A", "A"])
>>> letters_counter
Counter({'A': 5, 'B': 2, 'C': 1, 'H': 1, 'D': 1})
# å‡ºç°æœ€å¤šçš„å‰2ä¸ªå…ƒç´ 
>>> letters_counter.most_common(2)
[('A', 5), ('B', 2)]
# ç»Ÿè®¡å­—ç¬¦ä¸²
>>> Counter("asdasdsczasdasdasdasd")
Counter({'s': 7, 'a': 6, 'd': 6, 'c': 1, 'z': 1})
```


## OrderedDict

dict subclass that remembers the order entries were added
åœ¨ Python ä¸­ï¼Œdict è¿™ä¸ªæ•°æ®ç»“æ„ç”±äº hash çš„ç‰¹æ€§ï¼Œæ˜¯æ— åºçš„ï¼Œè¿™åœ¨æœ‰çš„æ—¶å€™ä¼šç»™æˆ‘ä»¬å¸¦æ¥ä¸€äº›éº»çƒ¦ï¼Œ å¹¸è¿çš„æ˜¯ï¼Œcollections æ¨¡å—ä¸ºæˆ‘ä»¬æä¾›äº† OrderedDictï¼Œå½“ä½ è¦è·å¾—ä¸€ä¸ªæœ‰åºçš„å­—å…¸å¯¹è±¡æ—¶ï¼Œç”¨å®ƒå°±å¯¹äº†ã€‚
::: warning
åœ¨ python3.6 ä¸­å­—å…¸å·²ç»æœ‰åºäº†ï¼Œå‚è§ï¼š[[Python-Dev] Python 3.6 dict becomes compact and gets a private version; and keywords become ordered](https://mail.python.org/pipermail/python-dev/2016-September/146327.html)
:::

- Example

```python
>>> from collections import OrderedDict
>>> user_dict = OrderedDict()
>>> user_dict["name"] = "As"
>>> user_dict["age"] = 18
>>> user_dict["sex"] = "ç”·"
>>> user_dict
OrderedDict([('name', 'As'), ('age', 18), ('sex', 'ç”·')])
# æŠŠnameç§»åŠ¨åˆ°æœ€å
>>> user_dict.move_to_end("name")
>>> user_dict
OrderedDict([('age', 18), ('sex', 'ç”·'), ('name', 'As')])
# ç§»é™¤æœ€åä¸€ä¸ªå…ƒç´ 
>>> user_dict.popitem()
('name', 'As')
>>> user_dict
OrderedDict([('age', 18), ('sex', 'ç”·')])
```

## defaultdict

å½“å­—å…¸ä¸­ Key ä¸å­˜åœ¨æ—¶ï¼Œè®¾ç½®é»˜è®¤å€¼

- è¯­æ³•

```python
defaultdict(FUNC_NAME)
```

æ¥å—ä¸€ä¸ªå‡½æ•°åç§°

- Code

ç»Ÿè®¡åˆ—è¡¨ä¸­å­—æ¯å‡ºç°çš„æ¬¡æ•°

```python
from collections import defaultdict

letters = ["A", "A", "B", "C", "A", "H", "D", "B"]

data_dict = defaultdict(int)

for letter in letters:
    data_dict[letter] += 1
print(data_dict)
```

- Output

```plain
defaultdict(<class 'int'>, {'A': 3, 'B': 2, 'C': 1, 'H': 1, 'D': 1})
```

## UserDict

wrapper around dictionary objects for easier dict subclassing


## UserList

wrapper around list objects for easier list subclassing


## UserString

wrapper around string objects for easier string subclassing
