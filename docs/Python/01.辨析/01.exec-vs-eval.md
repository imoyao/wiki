---
title: Python ä¸­ exec()å’Œ eval()çš„åŒºåˆ«
tags: 
  - Python
  - åŠ¨æ€æ‰§è¡Œ
  - exec
  - TODO
categories: 
  - ğŸ’» å·¥ä½œ
  - ğŸPython
  - è¾¨æ
date: 2017-11-17 15:23:17
permalink: /pages/612d9e/
---

Python åŠ¨æ€æ‰§è¡Œå­—ç¬¦ä¸²ä»£ç ç‰‡æ®µï¼ˆä¹Ÿå¯ä»¥æ˜¯æ–‡ä»¶ï¼‰ï¼Œ ä¸€èˆ¬ä¼šç”¨åˆ° execï¼Œevalã€‚é‚£ä¹ˆè¿™ä¸¤ä¸ªæ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ

<!-- more -->

## exec æ–¹æ³•

æ³¨æ„ï¼š`exec` æ˜¯ä¸€ä¸ªè¯­æ³•å£°æ˜ï¼Œä¸æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚ä¹Ÿå°±æ˜¯è¯´å’Œ`if`ã€`for`ä¸€æ ·ã€‚å®ƒçš„ä½œç”¨æ˜¯å¯ä»¥æ”¯æŒ Python ä»£ç çš„åŠ¨æ€æ‰§è¡Œã€‚

å®˜æ–¹æ–‡æ¡£å¯¹äº exec çš„è§£é‡Š
> This statement supports dynamic execution of Python code.

exec åé¢è·Ÿçš„ç¬¬ä¸€ä¸ªè¡¨è¾¾å¼å¯ä»¥æ˜¯ï¼š

1. ä»£ç å­—ç¬¦ä¸²
2. æ–‡ä»¶å¯¹è±¡
3. ä»£ç å¯¹è±¡
4. tuple

å‰é¢ä¸‰ç§æƒ…å†µå·®ä¸å¤šï¼Œç¬¬å››ç§æ¯”è¾ƒç‰¹æ®Šæœ€åè®²ã€‚

å¦‚æœå¿½ç•¥åé¢çš„å¯é€‰è¡¨è¾¾å¼ï¼Œexec åé¢ä»£ç å°†åœ¨å½“å‰åŸŸæ‰§è¡Œ
```plain
>>> a=2
>>> exec "a=1"
>>> a
1

```
å¦‚æœåœ¨è¡¨è¾¾å¼ä¹‹åä½¿ç”¨ in é€‰é¡¹æŒ‡å®šä¸€ä¸ª`dict`ï¼Œå®ƒå°†ä½œä¸º`global`å’Œ`local`å˜é‡ä½œç”¨åŸŸ
```plain
>>> a=10 
>>> b=20 
>>> g={'a':6,'b':8} 
>>> exec "global a;print a,b" in g 
6 8 
```
å¦‚æœ`in`åè¯¦æŒ‡å®šä¸¤ä¸ªè¡¨è¾¾å¼ï¼Œå®ƒä»¬å°†åˆ†åˆ«ç”¨ä½œ`global`å’Œ`local`å˜é‡ä½œç”¨åŸŸ
```plain
>>> a=10 
>>> b=20 
>>> c=20 
>>> g={'a':6,'b':8} 
>>> l={'b':9,'c':10} 
>>> exec "global a;print a,b,c" in g,l 
6 9 10
```
ç°åœ¨è¯´ä¸‹`tuple`çš„æƒ…å†µï¼Œè¿™ä¹Ÿæ˜¯å¯¼è‡´å¾ˆå¤šäººè¯¯ä»¥ä¸º`exec`æ˜¯ä¸€ä¸ªå‡½æ•°çš„åŸå› ã€‚

å¦‚æœç¬¬ä¸€ä¸ªè¡¨è¾¾å¼æ˜¯`tuple`

```plain
exec(expr, globals) #å®ƒç­‰æ•ˆäº `exec expr in globals`

exec(expr, globals, locals) #å®ƒç­‰æ•ˆäº  `exec expr in globals,locals`
```
## eval()æ–¹æ³•

`eval`é€šå¸¸ç”¨æ¥æ‰§è¡Œä¸€ä¸ªå­—ç¬¦ä¸²è¡¨è¾¾å¼ï¼Œå¹¶è¿”å›è¡¨è¾¾å¼çš„å€¼ã€‚

```python
eval(expression[, globals[, locals]])
```

æœ‰ä¸‰ä¸ªå‚æ•°ï¼Œè¡¨è¾¾å¼å­—ç¬¦ä¸²ï¼Œglobals å˜é‡ä½œç”¨åŸŸï¼Œlocals å˜é‡ä½œç”¨åŸŸã€‚ å…¶ä¸­ç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯å¯é€‰çš„ã€‚

å¦‚æœå¿½ç•¥åé¢ä¸¤ä¸ªå‚æ•°ï¼Œåˆ™`eval`åœ¨å½“å‰ä½œç”¨åŸŸæ‰§è¡Œã€‚

```plain
>>> a=1 
>>> eval("a+1") 
2
```
å¦‚æœæŒ‡å®š globals å‚æ•°
```plain
>>> a=1 
>>> g={'a':10} 
>>> eval("a+1",g) 
11
```
å¦‚æœæŒ‡å®š`locals`å‚æ•°
```plain
>>> a=10 
>>> b=20 
>>> c=20 
>>> g={'a':6,'b':8} 
>>> l={'b':9,'c':10} 
>>> eval("a+b+c",g,l) 
25
```
å¦‚æœè¦ä¸¥æ ¼é™åˆ¶`eval`æ‰§è¡Œï¼Œå¯ä»¥è®¾ç½®`globals`ä¸º`__builtins__`,è¿™æ · è¿™ä¸ªè¡¨è¾¾å¼åªå¯ä»¥è®¿é—®`__builtin__` moduleã€‚

```python
# coding=utf-8
exec 'print("hello")'   #æ”¯æŒstrçš„è¡¨è¾¾å¼åŠ¨æ€ä»£ç æ‰§è¡Œ    >>hello
exec ('a = 3*4')
print a     # >>12
b = eval('3*4')     #ä¸æ”¯æŒè¡¨è¾¾å¼ æœ‰è¿”å›å€¼
print b     # >>12
```
## [Using python's eval() vs. ast.literal_eval()? - Stack Overflow](https://stackoverflow.com/questions/15197673/using-pythons-eval-vs-ast-literal-eval)

å¦‚æœæˆ‘ä»¬ä¸ä¿¡ä»»ç”¨æˆ·è¾“å…¥ï¼Œå¤§å¤šæ•°æ—¶å€™å¯ä»¥ä½¿ç”¨`ast.literal_eval()`æ›¿ä»£`eval`ã€‚

## å‚è€ƒæ¥æº

[python çš„ execã€eval è¯¦è§£ - ç–¯ç‹‚å¥”è·‘çš„çŒª](http://www.coolpython.com/index.php?aid=12)

## TODO

[Python ä¸­çš„ eval()ã€exec()åŠå…¶ç›¸å…³å‡½æ•° - äº‘æ¸¸é“å£« - åšå®¢å›­](https://www.cnblogs.com/yyds/p/6276746.html)
[æ·±åº¦è¾¨æ Python çš„ eval() ä¸ exec()](https://juejin.im/post/6844903805931225095)
[python - What's the difference between eval, exec, and compile? - StackOverflow](https://stackoverflow.com/questions/2220699/whats-the-difference-between-eval-exec-and-compile)