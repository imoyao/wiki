---
title: SAN 和 NAS 的对比

tags: 
  - 存储
  - 协议
  - Linux
categories: 
  - 💻 工作
  - 存储
date: 2018-09-07 12:27:56
permalink: /pages/a00203/
---
![SAN vs NAS](http://blog.netapp.com/wp-content/uploads/2018/12/T25994-SANvNAS-BlogBanner-1024x512-1024x512.jpg)

这是最好的存储协议，它是最差的存储协议。那是 SAN 的时代，是 NAS 的时代。好吧，我不背《双城记》了。本文将介绍 SAN 和 NAS，这些存储协议的特性，以及为什么有人可能会选择一个协议而不是另一个协议。
## SAN
存储区域网络[SAN(Storage Area Network)](https://www.netapp.com/us/products/storage-systems/storage-area-network.aspx)是一个块级存储协议，这意味着数据以块存储和访问。所有这些数据块都存储在逻辑单元编号或者说 LUN 中。然后，将 LUN 从目标（target）（存储系统）呈现给启动器（initiator）（主机）。 对于像服务器这样的终端设备，这些 LUN 看起来像直接连接存储 （DAS） 或本地驱动器。但与 DAS 不同，我们可以通过集中化管理中获得可移植性和许多其他好处。

阻止存储的注意事项是，您需要使用特定于操作系统的文件系统格式化驱动器。对于 Windows 服务器，您可能会使用 NTFS。另一个注意事项是，根据文件系统的不同，您可能只能使用单个主机读取和写入数据。但是，VMFS （vSphere 数据存储） 等群集文件系统可处理从多个主机进行写入的锁定，以防止数据损坏。

如果使用 SAN 协议提供数据，则可能有用于传输存储区域网络流量的专用硬件。例如，如果您使用光纤通道协议提供 SAN 数据，则您有专用于此流量的光纤通道交换机和 HBA（基于主机的适配器）。如果您使用 iSCSI 传输此流量，则可以使用用于网络流量的相同交换机和网卡。但是，您可能在主机上具有专用的聚合网络适配器 （CNAs），以减轻主机 CPU 的处理负担。 这些 CNA 提供了改进的性能。

单独的硬件实际上是使用 SAN 作为存储协议的一个优势。通常，存储流量与通用网络流量隔离。由于 SAN 提供快速、弹性的存储，因此它经常是数据库和其他高性能应用程序的首选存储协议。随着 NVMe 协议的出现和 基于 Fabric 的 NVMe 的发展，SAN 存储协议的性能优势正在发生改变。
### 优势总结
1. 极快的数据访问
2. 专用存储网络可缓解 LAN 压力
3. 高度可扩展
4. 操作系统级别（块级）对文件的访问
5. 高服务质量，适用于视频编辑等要求苛刻的应用

## NAS
网络附加存储[NAS（Network Attached Storage ）](https://www.netapp.com/us/products/protocols/nas/index.aspx)比 SAN 存储更抽象。这种抽象带来了 NAS 最大的优势之一：简单性。 数据不由块组成，。数据存储在由文件和文件夹组成的卷中，而不是块。这是典型的 CS(client-server)架构。客户端从 NAS 服务器共享的 UNC 路径访问文件夹和文件。由于 NAS 服务器处理文件系统，因此数据完全独立于它们连接到的设备。多个客户端或设备可以同时连接到相同的文件。
NFS、SMB 和 CIFS（旧版 SMB 1）都属于 NAS 协议类别。NAS 是非结构化数据的存储协议。文件共享和主目录包含大量非结构化数据。NFS 数据存储包含 NAS 数据的另一部分。
使用 NAS 协议的优势包括更易于管理和利用现有网络基础设施的能力。另一个好处是，由于数据存储在文件级别，因此您可以轻松缩小和自动增长卷。 缩小卷以回收过度分配的空间的功能是一个很大的好处。 当使用 SAN 作为存储协议时，您实际上只能增长这些 LUN。 要获得较小的 LUN，您将需要重新创建该 LUN 并将所有存储移至新的较小的 LUN。
### 优势总结
1. 相对便宜
3. 24/7 和远程数据可用性
3. 良好的可扩展性
4. 冗余存储体系结构
5. 自动备份到其他设备和云
6. 灵活性 

### 劣势
以太网通过数据包将数据从一个位置传输到另一个地方，将源划分为多个段，然后将它们发送到目的地。这些数据包中的任何一个可能会延迟或按顺序发送，并且可能直到所有数据包到达并按顺序放回状态才对用户可用。
## 总结

|        | NAS                                                                | SAN                                                            |
|--------|--------------------------------------|-------------------------------|
| 适用对象       | 通常用于家庭和中小型企业。                                                       | 通常用于专业人员和企业环境。                                                    |
| 价格       | 更便宜                                                                 | 更贵                                                              |
| 管理难易程度       | 易于管理                                                               | 需要更多的管理                                                         |
| 数据类型       | 访问的是数据，就像它是网络连接的驱动器（文件）                                              | 服务器访问数据就像访问本地硬盘驱动器（块）一样                                         |
| 性能       | 速度取决于本地 TCP/IP 通常为以太网网络，通常为 100 Mb 到 1000Mb/s。通常由于文件系统层较慢，吞吐量降低，延迟更高。 | 高速使用光纤通道，2000Mb/s 到 128000Mb/s。某些 SAN 使用 iSCSI 作为光纤通道的较便宜但速度较慢的替代方案。 |
| 协议      | I/O 协议：NFS、SMB/CIFS、HTTP                                            | SCSI, iSCSI, FCoE                                               |
| 伸缩性       | 有限的可扩展性;使用群集或横向扩展节点将高端 NAS 扩展到 PB                                  | 网络架构使管理员能够根据需要扩展性能和容量                                           |
| 虚拟化        | 不可用于虚拟化                                                              | 适用于虚拟化                                                          |
| 迁移性      | 无需更改体系结构                                                            | 需要更改体系结构                                                        |
| 冗余性       | 入门级系统通常具有单点故障，例如电源                                                  | 具有冗余功能的容错网络                                                     |
| 性能影响       | 易受网络瓶颈影响                                                            | 不受网络流量瓶颈的影响。同时访问缓存，使视频编辑等应用程序受益。                                |
| 数据备份       | 文件备份和快照经济且可存储                                                      | 块备份和镜像需要更多的存储                                                  |


SAN 和 NAS 都有自己的优势和取舍。与大多数 IT 问题一样，在选择要使用的存储协议时，应采用哪种方法，答案是"视情况而定"。幸运的是，这不是一个非此即彼的问题。

## 参考来源
[SAN vs. NAS: A Tale of Two Storage Protocols | NetApp Blog](https://blog.netapp.com/san-vs-nas/)
[NAS vs. SAN - What Are the Differences Between Them](https://www.backblaze.com/blog/whats-the-diff-nas-vs-san/)
[NAS vs. SAN: Data Storage Comparison](https://www.enterprisestorageforum.com/storage-networking/nas-vs.-san-differences-and-use-cases.html)
